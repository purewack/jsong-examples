(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{6840:function(i,s,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return r(8192)}])},2422:function(i,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"createAsyncLocalStorage",{enumerable:!0,get:function(){return l}});let r=Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available");class o{disable(){throw r}getStore(){}run(){throw r}exit(){throw r}enterWith(){throw r}}let a=globalThis.AsyncLocalStorage;function l(){return a?new a:new o}("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),i.exports=s.default)},8427:function(i,s,r){"use strict";function o(i){}Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"clientHookInServerComponentError",{enumerable:!0,get:function(){return o}}),r(8754),r(7294),("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),i.exports=s.default)},636:function(i,s,r){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),function(i,s){for(var r in s)Object.defineProperty(i,r,{enumerable:!0,get:s[r]})}(s,{ReadonlyURLSearchParams:function(){return g},useSearchParams:function(){return _},usePathname:function(){return v},ServerInsertedHTMLContext:function(){return c.ServerInsertedHTMLContext},useServerInsertedHTML:function(){return c.useServerInsertedHTML},useRouter:function(){return y},useParams:function(){return b},useSelectedLayoutSegments:function(){return x},useSelectedLayoutSegment:function(){return w},redirect:function(){return d.redirect},permanentRedirect:function(){return d.permanentRedirect},RedirectType:function(){return d.RedirectType},notFound:function(){return p.notFound}});let o=r(7294),a=r(9031),l=r(1593),u=r(8427),h=r(6160),c=r(252),d=r(7866),p=r(9363),f=Symbol("internal for urlsearchparams readonly");function m(){return Error("ReadonlyURLSearchParams cannot be modified")}class g{[Symbol.iterator](){return this[f][Symbol.iterator]()}append(){throw m()}delete(){throw m()}set(){throw m()}sort(){throw m()}constructor(i){this[f]=i,this.entries=i.entries.bind(i),this.forEach=i.forEach.bind(i),this.get=i.get.bind(i),this.getAll=i.getAll.bind(i),this.has=i.has.bind(i),this.keys=i.keys.bind(i),this.values=i.values.bind(i),this.toString=i.toString.bind(i),this.size=i.size}}function _(){(0,u.clientHookInServerComponentError)("useSearchParams");let i=(0,o.useContext)(l.SearchParamsContext),s=(0,o.useMemo)(()=>i?new g(i):null,[i]);return s}function v(){return(0,u.clientHookInServerComponentError)("usePathname"),(0,o.useContext)(l.PathnameContext)}function y(){(0,u.clientHookInServerComponentError)("useRouter");let i=(0,o.useContext)(a.AppRouterContext);if(null===i)throw Error("invariant expected app router to be mounted");return i}function b(){(0,u.clientHookInServerComponentError)("useParams");let i=(0,o.useContext)(a.GlobalLayoutRouterContext),s=(0,o.useContext)(l.PathParamsContext);return(0,o.useMemo)(()=>(null==i?void 0:i.tree)?function i(s,r){void 0===r&&(r={});let o=s[1];for(let s of Object.values(o)){let o=s[0],a=Array.isArray(o),l=a?o[1]:o;if(!l||l.startsWith("__PAGE__"))continue;let u=a&&("c"===o[2]||"oc"===o[2]);u?r[o[0]]=o[1].split("/"):a&&(r[o[0]]=o[1]),r=i(s,r)}return r}(i.tree):s,[null==i?void 0:i.tree,s])}function x(i){void 0===i&&(i="children"),(0,u.clientHookInServerComponentError)("useSelectedLayoutSegments");let{tree:s}=(0,o.useContext)(a.LayoutRouterContext);return function i(s,r,o,a){let l;if(void 0===o&&(o=!0),void 0===a&&(a=[]),o)l=s[1][r];else{var u;let i=s[1];l=null!=(u=i.children)?u:Object.values(i)[0]}if(!l)return a;let c=l[0],d=(0,h.getSegmentValue)(c);return!d||d.startsWith("__PAGE__")?a:(a.push(d),i(l,r,!1,a))}(s,i)}function w(i){void 0===i&&(i="children"),(0,u.clientHookInServerComponentError)("useSelectedLayoutSegment");let s=x(i);return 0===s.length?null:s[0]}("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),i.exports=s.default)},9363:function(i,s){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),function(i,s){for(var r in s)Object.defineProperty(i,r,{enumerable:!0,get:s[r]})}(s,{notFound:function(){return o},isNotFoundError:function(){return a}});let r="NEXT_NOT_FOUND";function o(){let i=Error(r);throw i.digest=r,i}function a(i){return(null==i?void 0:i.digest)===r}("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),i.exports=s.default)},7866:function(i,s,r){"use strict";var o,a;Object.defineProperty(s,"__esModule",{value:!0}),function(i,s){for(var r in s)Object.defineProperty(i,r,{enumerable:!0,get:s[r]})}(s,{RedirectType:function(){return o},getRedirectError:function(){return h},redirect:function(){return c},permanentRedirect:function(){return d},isRedirectError:function(){return p},getURLFromRedirectError:function(){return f},getRedirectTypeFromError:function(){return m}});let l=r(3743),u="NEXT_REDIRECT";function h(i,s,r){void 0===r&&(r=!1);let o=Error(u);o.digest=u+";"+s+";"+i+";"+r;let a=l.requestAsyncStorage.getStore();return a&&(o.mutableCookies=a.mutableCookies),o}function c(i,s){throw void 0===s&&(s="replace"),h(i,s,!1)}function d(i,s){throw void 0===s&&(s="replace"),h(i,s,!0)}function p(i){if("string"!=typeof(null==i?void 0:i.digest))return!1;let[s,r,o,a]=i.digest.split(";",4);return s===u&&("replace"===r||"push"===r)&&"string"==typeof o&&("true"===a||"false"===a)}function f(i){return p(i)?i.digest.split(";",3)[2]:null}function m(i){if(!p(i))throw Error("Not a redirect error");return i.digest.split(";",2)[1]}(a=o||(o={})).push="push",a.replace="replace",("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),i.exports=s.default)},3743:function(i,s,r){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"requestAsyncStorage",{enumerable:!0,get:function(){return a}});let o=r(2422),a=(0,o.createAsyncLocalStorage)();("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),i.exports=s.default)},6160:function(i,s){"use strict";function r(i){return Array.isArray(i)?i[1]:i}Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"getSegmentValue",{enumerable:!0,get:function(){return r}}),("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),i.exports=s.default)},252:function(i,s,r){"use strict";Object.defineProperty(s,"__esModule",{value:!0}),function(i,s){for(var r in s)Object.defineProperty(i,r,{enumerable:!0,get:s[r]})}(s,{ServerInsertedHTMLContext:function(){return l},useServerInsertedHTML:function(){return u}});let o=r(1757),a=o._(r(7294)),l=a.default.createContext(null);function u(i){let s=(0,a.useContext)(l);s&&s(i)}},8192:function(i,s,r){"use strict";let o,a;r.r(s),r.d(s,{PlayerContext:function(){return rQ},default:function(){return r$}});var l,u,h,c,d,p,f,m,g,_,v,y,b,x,w,T,C,S,A,k,O,E,M,I,D,R,P,N,V,j,q,L,F,B,W,U,z,G,X=r(5893),Z=r(7294),H=r(333),Y=r.n(H),J=r(512);function Q(i){let{show:s=!0,pending:r=!1}=i,o=(0,Z.useContext)(rQ),[a,l]=(0,Z.useState)(""),[u,h]=(0,Z.useState)([0,0]),c="playing"===a,[d,p]=(0,Z.useState)(!1),[f,m]=(0,Z.useState)("");(0,Z.useEffect)(()=>{let i=i=>{l(i.stateNow||"")},s=i=>{o.audioSafeCallback(()=>{h(i.progress)})},r=i=>{var s;m((null===(s=i.to)||void 0===s?void 0:s.name)||"")};return o.addEventListener("transport",s),o.addEventListener("state",i),o.addEventListener("change",r),()=>{o.removeEventListener("transport",s),o.removeEventListener("state",i),o.removeEventListener("change",r)}},[]);let g=(0,Z.useRef)(null);return(0,X.jsxs)("nav",{ref:g,className:(0,J.Z)("capitalize select-none",Y().nav,Y().show,r&&Y().pending),children:[(0,X.jsx)("h2",{className:(0,J.Z)(Y().title),children:"JSONg"}),(0,X.jsxs)("div",{children:[(0,X.jsx)("span",{className:(0,J.Z)(Y().progress,"after:bg-green-300 opacity-40"),style:{"--progress":c?u[0]/u[1]:0},children:c?(0,X.jsxs)(X.Fragment,{children:[f," : ",u[0]," / ",u[1]]}):a}),(0,X.jsx)("span",{className:(0,J.Z)("material-symbols-outlined w-16 text-right",Y().vol),onClick:()=>{p(i=>(i?o.unmute():o.mute(),!i))},children:d?"volume_off":"volume_up"})]})]})}function $(i,s,r,o){var a,l=arguments.length,u=l<3?s:null===o?o=Object.getOwnPropertyDescriptor(s,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(i,s,r,o);else for(var h=i.length-1;h>=0;h--)(a=i[h])&&(u=(l<3?a(u):l>3?a(s,r,u):a(s,r))||u);return l>3&&u&&Object.defineProperty(s,r,u),u}function K(i,s,r,o){return new(r||(r=Promise))(function(a,l){function u(i){try{c(o.next(i))}catch(i){l(i)}}function h(i){try{c(o.throw(i))}catch(i){l(i)}}function c(i){var s;i.done?a(i.value):((s=i.value)instanceof r?s:new r(function(i){i(s)})).then(u,h)}c((o=o.apply(i,s||[])).next())})}function tt(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[4,4],o=arguments.length>3?arguments[3]:void 0,a=i=>i.split(":").map(i=>parseInt(i)),l=(i,s)=>Math.trunc((i+s)/s)*s,u=r[0]/(r[1]/4),[h,c]=a(i);if((s/=r[1]/4)<u){let i=l(c,s);return"".concat(h+Math.trunc(i/u),":").concat(i%u,":0")}{let i=s/u;if(null!=o){if("string"==typeof o){let s=a(o)[0];for(;s<=h;)s+=i;return"".concat(s,":0:0")}return"".concat(l(h,i)+o,":0:0")}return"".concat(h+i,":0:0")}}function te(i,s,r){let o=r[1]/4,a=r[0]/o,[l,u,h]=i.split(":").map(Number),[c,d,p]=s.split(":").map(Number);return Math.round((c*a+d+p/(16/o)-(l*a+u+h/(16/o)))*o)}function tn(i,s){return function i(r,o,a){let l=s[o];return a[o]=l,a+""==s+""?r[l]:r[l]?i(r[l],o+1,a):void 0}(i,0,[...Array(s.length)])}function ti(i,s){if(void 0===tn(i,s))return;let r=[],o=[],a=s=>{let r=tn(i,s);return(null==r?void 0:r.name)?s:a([...s,0])},l=function(s){let u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,h=[...s.slice(0,-1)],c=ts(i,0===u&&s.length>1?s:h),d=s.at(-1)+1>=c.sectionCount,p=c.loopCurrent+1>=c.loopLimit;if(d&&r.push(h),!d||!p)return d?void(o=a([...h,0])):void(o=a([...h,s.at(-1)+1]));l(h,u+1)};return l(s),{next:o,increments:r}}function ts(i,s){let r=tn(i,s);return s.length&&r?(null==r?void 0:r.name)?Object.assign({},tn(i,s.slice(0,-1))):Object.assign({},r):Object.assign({},i)}function tr(i){let s=i.split("-"),r=s.length>1,o=r?s.includes("X")||s.includes("x"):void 0;return{name:s[0],fade:o,once:r?s.includes(">"):void 0,legato:r?s.includes("|")&&!o:void 0,sync:r?s.includes("@"):void 0}}function to(i){try{return new URL(i)}catch(s){return new URL(window.location.origin+(i?"/"+i:""))}}function ta(i){return"jsong"===(null==i?void 0:i.type)}r(2352),r(3483),"function"==typeof SuppressedError&&SuppressedError;class tl extends Event{constructor(i){super("click"),this.current=i}}class tu extends Event{constructor(i,s,r){super("transport"),this.progress=i,this.countdown=r,this.beat=s}}class th extends Event{constructor(i,s,r,o,a){super("queue"),this.to=i,this.from=s,this.breakout=r,this.countdown=o,this.timeUntil=a}}class tc extends Event{constructor(i,s){super("cancel"),this.to=i,this.from=s}}class td extends Event{constructor(i,s,r,o){super("change"),this.from=s,this.to=i,this.breakout=r,this.automatic=o}}class tp extends Event{constructor(i,s){super("repeat"),this.group=s,this.counter=i}}class tf extends Event{constructor(i){super("loop"),this.group=i}}class tm extends Event{constructor(i){super("state"),this.stateOld=i.prev,this.stateNow=i.now}}class tg extends Event{constructor(i){super("parse"),this.phasePrev=i.prev,this.phase=i.now}}let t_="14.9.17",tv=(i,s)=>({startTime:s,type:"setValue",value:i}),ty=(i,s,r)=>({duration:r,startTime:s,type:"setValueCurve",values:i}),tb=new WeakSet,tx=new WeakMap,tw=new WeakMap,tT=new WeakMap,tC=new WeakMap,tS=new WeakMap,tA=new WeakMap,tk=new WeakMap,tO=new WeakMap,tE=new WeakMap,tM={construct:()=>tM},tI=i=>{try{new new Proxy(i,tM)}catch(i){return!1}return!0},tD=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,tR=(i,s)=>{let r=[],o=i.replace(/^[\s]+/,""),a=o.match(tD);for(;null!==a;){let i=a[1].slice(1,-1),l=a[0].replace(/([\s]+)?;?$/,"").replace(i,new URL(i,s).toString());r.push(l),a=(o=o.slice(a[0].length).replace(/^[\s]+/,"")).match(tD)}return[r.join(";"),o]},tP=i=>{if(void 0!==i&&!Array.isArray(i))throw TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},tN=i=>{if(!tI(i))throw TypeError("The given value for processorCtor should be a constructor.");if(null===i.prototype||"object"!=typeof i.prototype)throw TypeError("The given value for processorCtor should have a prototype.")},tV=(i,s)=>{let r=i.get(s);if(void 0===r)throw Error("A value with the given key could not be found.");return r},tj=(i,s)=>{let r=Array.from(i).filter(s);if(r.length>1)throw Error("More than one element was found.");if(0===r.length)throw Error("No element was found.");let[o]=r;return i.delete(o),o},tq=(i,s,r,o)=>{let a=tV(i,s),l=tj(a,i=>i[0]===r&&i[1]===o);return 0===a.size&&i.delete(s),l},tL=i=>tV(tA,i),tF=i=>{if(tb.has(i))throw Error("The AudioNode is already stored.");tb.add(i),tL(i).forEach(i=>i(!0))},tB=i=>"port"in i,tW=i=>{if(!tb.has(i))throw Error("The AudioNode is not stored.");tb.delete(i),tL(i).forEach(i=>i(!1))},tU=(i,s)=>{!tB(i)&&s.every(i=>0===i.size)&&tW(i)},tz={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},tG=(i,s)=>i.context===s,tX=i=>{try{i.copyToChannel(new Float32Array(1),0,-1)}catch(i){return!1}return!0},tZ=()=>new DOMException("","IndexSizeError"),tH=i=>{var s;i.getChannelData=(s=i.getChannelData,r=>{try{return s.call(i,r)}catch(i){if(12===i.code)throw tZ();throw i}})},tY={numberOfChannels:1},tJ=i=>tb.has(i),tQ={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},t$=i=>"playbackRate"in i,tK=i=>"frequency"in i&&"gain"in i,t0=i=>"offset"in i,t1=i=>!("frequency"in i)&&"gain"in i,t2=i=>"detune"in i&&"frequency"in i&&!("gain"in i),t3=i=>"pan"in i,t4=i=>tV(tx,i),t8=i=>tV(tT,i),t6=(i,s)=>{let{activeInputs:r}=t4(i);r.forEach(r=>r.forEach(r=>{let[o]=r;s.includes(i)||t6(o,[...s,i])}));let o=t$(i)?[i.playbackRate]:tB(i)?Array.from(i.parameters.values()):tK(i)?[i.Q,i.detune,i.frequency,i.gain]:t0(i)?[i.offset]:t1(i)?[i.gain]:t2(i)?[i.detune,i.frequency]:t3(i)?[i.pan]:[];for(let i of o){let r=t8(i);void 0!==r&&r.activeInputs.forEach(i=>{let[r]=i;return t6(r,s)})}tJ(i)&&tW(i)},t5=i=>{t6(i.destination,[])},t7=i=>void 0===i||"number"==typeof i||"string"==typeof i&&("balanced"===i||"interactive"===i||"playback"===i),t9=i=>"context"in i,et=i=>t9(i[0]),ee=(i,s,r,o)=>{for(let s of i)if(r(s)){if(o)return!1;throw Error("The set contains at least one similar element.")}return i.add(s),!0},en=(i,s,r,o)=>{let[a,l]=r;ee(i,[s,a,l],i=>i[0]===s&&i[1]===a,o)},ei=(i,s,r)=>{let[o,a,l]=s,u=i.get(o);void 0===u?i.set(o,new Set([[a,l]])):ee(u,[a,l],i=>i[0]===a,r)},es=i=>"inputs"in i,er=(i,s,r,o)=>{if(es(s)){let a=s.inputs[o];return i.connect(a,r,0),[a,r,0]}return i.connect(s,r,o),[s,r,o]},eo=(i,s,r)=>{for(let o of i)if(o[0]===s&&o[1]===r)return i.delete(o),o;return null},ea=(i,s,r)=>tj(i,i=>i[0]===s&&i[1]===r),el=(i,s)=>{if(!tL(i).delete(s))throw Error("Missing the expected event listener.")},eu=(i,s,r)=>{let o=tV(i,s),a=tj(o,i=>i[0]===r);return 0===o.size&&i.delete(s),a},eh=(i,s,r,o)=>{es(s)?i.disconnect(s.inputs[o],r,0):i.disconnect(s,r,o)},ec=i=>tV(tw,i),ed=i=>tV(tC,i),ep=i=>tk.has(i),ef=i=>!tb.has(i),em=(i,s)=>new Promise(r=>{if(null!==s)r(!0);else{let s=i.createScriptProcessor(256,1,1),o=i.createGain(),a=i.createBuffer(1,2,44100),l=a.getChannelData(0);l[0]=1,l[1]=1;let u=i.createBufferSource();u.buffer=a,u.loop=!0,u.connect(s).connect(i.destination),u.connect(o),u.disconnect(o),s.onaudioprocess=o=>{let a=o.inputBuffer.getChannelData(0);Array.prototype.some.call(a,i=>1===i)?r(!0):r(!1),u.stop(),s.onaudioprocess=null,u.disconnect(s),s.disconnect(i.destination)},u.start()}}),eg=(i,s)=>{let r=new Map;for(let s of i)for(let i of s){let s=r.get(i);r.set(i,void 0===s?1:s+1)}r.forEach((i,r)=>s(r,i))},e_=i=>"context"in i,ev=i=>{var s,r;let o=new Map;i.connect=(s=i.connect.bind(i),function(i){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=e_(i)?s(i,r,a):s(i,r),u=o.get(i);return void 0===u?o.set(i,[{input:a,output:r}]):u.every(i=>i.input!==a||i.output!==r)&&u.push({input:a,output:r}),l}),i.disconnect=(r=i.disconnect,(s,a,l)=>{if(r.apply(i),void 0===s)o.clear();else if("number"==typeof s)for(let[i,r]of o){let a=r.filter(i=>i.output!==s);0===a.length?o.delete(i):o.set(i,a)}else if(o.has(s)){if(void 0===a)o.delete(s);else{let i=o.get(s);if(void 0!==i){let r=i.filter(i=>i.output!==a&&(i.input!==l||void 0===l));0===r.length?o.delete(s):o.set(s,r)}}}for(let[s,r]of o)r.forEach(r=>{e_(s)?i.connect(s,r.output,r.input):i.connect(s,r.output)})})},ey=(i,s,r,o,a)=>{let[l,u]=((i,s,r,o)=>{let{activeInputs:a,passiveInputs:l}=t4(s),u=eo(a[o],i,r);return null===u?[tq(l,i,r,o)[2],!1]:[u[2],!0]})(i,r,o,a);if(null!==l&&(el(i,l),!u||s||ep(i)||eh(ec(i),ec(r),o,a)),tJ(r)){let{activeInputs:i}=t4(r);tU(r,i)}},eb=(i,s,r,o)=>{let[a,l]=((i,s,r)=>{let{activeInputs:o,passiveInputs:a}=t8(s),l=eo(o,i,r);return null===l?[eu(a,i,r)[1],!1]:[l[2],!0]})(i,r,o);null!==a&&(el(i,a),!l||s||ep(i)||ec(i).disconnect(ed(r),o))},ex=(i,s,r)=>({endTime:s,insertTime:r,type:"exponentialRampToValue",value:i}),ew=(i,s,r)=>({endTime:s,insertTime:r,type:"linearRampToValue",value:i}),eT=(i,s,r)=>{let{startTime:o,target:a,timeConstant:l}=r;return a+(s-a)*Math.exp((o-i)/l)},eC=i=>"exponentialRampToValue"===i.type,eS=i=>"linearRampToValue"===i.type,eA=i=>eC(i)||eS(i),ek=i=>"setValue"===i.type,eO=i=>"setValueCurve"===i.type,eE=(i,s,r,o)=>{let a=i[s];return void 0===a?o:eA(a)||ek(a)?a.value:eO(a)?a.values[a.values.length-1]:eT(r,eE(i,s-1,a.startTime,o),a)},eM=(i,s,r,o,a)=>void 0===r?[o.insertTime,a]:eA(r)?[r.endTime,r.value]:ek(r)?[r.startTime,r.value]:eO(r)?[r.startTime+r.duration,r.values[r.values.length-1]]:[r.startTime,eE(i,s-1,r.startTime,a)],eI=i=>"cancelAndHold"===i.type,eD=i=>"cancelScheduledValues"===i.type,eR=i=>eI(i)||eD(i)?i.cancelTime:eC(i)||eS(i)?i.endTime:i.startTime,eP=(i,s,r,o)=>{let{endTime:a,value:l}=o;return r===l?l:0<r&&0<l||r<0&&l<0?r*(l/r)**((i-s)/(a-s)):0},eN=(i,s,r,o)=>{let{endTime:a,value:l}=o;return r+(i-s)/(a-s)*(l-r)},eV=(i,s)=>{let r=Math.floor(s),o=Math.ceil(s);return r===o?i[r]:(1-(s-r))*i[r]+(1-(o-s))*i[o]},ej=(i,s)=>{let{duration:r,startTime:o,values:a}=s,l=(i-o)/r*(a.length-1);return eV(a,l)},eq=i=>"setTarget"===i.type;class eL{[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(i){let s=eR(i);if(eI(i)||eD(i)){let r=this._automationEvents.findIndex(r=>eD(i)&&eO(r)?r.startTime+r.duration>=s:eR(r)>=s),o=this._automationEvents[r];if(-1!==r&&(this._automationEvents=this._automationEvents.slice(0,r)),eI(i)){let i=this._automationEvents[this._automationEvents.length-1];if(void 0!==o&&eA(o)){if(void 0!==i&&eq(i))throw Error("The internal list is malformed.");let r=void 0===i?o.insertTime:eO(i)?i.startTime+i.duration:eR(i),a=void 0===i?this._defaultValue:eO(i)?i.values[i.values.length-1]:i.value,l=eC(o)?eP(s,r,a,o):eN(s,r,a,o),u=eC(o)?ex(l,s,this._currenTime):ew(l,s,this._currenTime);this._automationEvents.push(u)}if(void 0!==i&&eq(i)&&this._automationEvents.push(tv(this.getValue(s),s)),void 0!==i&&eO(i)&&i.startTime+i.duration>s){let r=s-i.startTime,o=(i.values.length-1)/i.duration,a=Math.max(2,1+Math.ceil(r*o)),l=r/(a-1)*o,u=i.values.slice(0,a);if(l<1)for(let s=1;s<a;s+=1){let r=l*s%1;u[s]=i.values[s-1]*(1-r)+i.values[s]*r}this._automationEvents[this._automationEvents.length-1]=ty(u,i.startTime,r)}}}else{let r=this._automationEvents.findIndex(i=>eR(i)>s),o=-1===r?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(void 0!==o&&eO(o)&&eR(o)+o.duration>s)return!1;let a=eC(i)?ex(i.value,i.endTime,this._currenTime):eS(i)?ew(i.value,s,this._currenTime):i;if(-1===r)this._automationEvents.push(a);else{if(eO(i)&&s+i.duration>eR(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,a)}}return!0}flush(i){let s=this._automationEvents.findIndex(s=>eR(s)>i);if(s>1){let i=this._automationEvents.slice(s-1),r=i[0];eq(r)&&i.unshift(tv(eE(this._automationEvents,s-2,r.startTime,this._defaultValue),r.startTime)),this._automationEvents=i}}getValue(i){if(0===this._automationEvents.length)return this._defaultValue;let s=this._automationEvents.findIndex(s=>eR(s)>i),r=this._automationEvents[s],o=(-1===s?this._automationEvents.length:s)-1,a=this._automationEvents[o];if(void 0!==a&&eq(a)&&(void 0===r||!eA(r)||r.insertTime>i))return eT(i,eE(this._automationEvents,o-1,a.startTime,this._defaultValue),a);if(void 0!==a&&ek(a)&&(void 0===r||!eA(r)))return a.value;if(void 0!==a&&eO(a)&&(void 0===r||!eA(r)||a.startTime+a.duration>i))return i<a.startTime+a.duration?ej(i,a):a.values[a.values.length-1];if(void 0!==a&&eA(a)&&(void 0===r||!eA(r)))return a.value;if(void 0!==r&&eC(r)){let[s,l]=eM(this._automationEvents,o,a,r,this._defaultValue);return eP(i,s,l,r)}if(void 0!==r&&eS(r)){let[s,l]=eM(this._automationEvents,o,a,r,this._defaultValue);return eN(i,s,l,r)}return this._defaultValue}constructor(i){this._automationEvents=[],this._currenTime=0,this._defaultValue=i}}class eF{get size(){return this._map.size}entries(){return this._map.entries()}forEach(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._map.forEach((r,o)=>i.call(s,r,o,this))}get(i){return this._map.get(i)}has(i){return this._map.has(i)}keys(){return this._map.keys()}values(){return this._map.values()}constructor(i){this._map=new Map(i)}}let eB={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function eW(i,s,r,o,a){if("function"==typeof i.copyFromChannel)0===s[r].byteLength&&(s[r]=new Float32Array(128)),i.copyFromChannel(s[r],o,a);else{let l=i.getChannelData(o);if(0===s[r].byteLength)s[r]=l.slice(a,a+128);else{let i=new Float32Array(l.buffer,a*Float32Array.BYTES_PER_ELEMENT,128);s[r].set(i)}}}let eU=(i,s,r,o,a)=>{"function"==typeof i.copyToChannel?0!==s[r].byteLength&&i.copyToChannel(s[r],o,a):0!==s[r].byteLength&&i.getChannelData(o).set(s[r],a)},ez=(i,s)=>{let r=[];for(let o=0;o<i;o+=1){let i=[],a="number"==typeof s?s:s[o];for(let s=0;s<a;s+=1)i.push(new Float32Array(128));r.push(i)}return r},eG=(i,s)=>{let r=tV(tE,i),o=ec(s);return tV(r,o)},eX={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},eZ={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},eH={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},eY={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},eJ={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},eQ=i=>{let{port1:s,port2:r}=new MessageChannel;return new Promise(o=>{let a=()=>{r.onmessage=null,s.close(),r.close(),o()};r.onmessage=()=>a();try{s.postMessage(i,[i])}catch(i){}finally{a()}})},e$={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},eK=i=>"delayTime"in i,e0=(i,s,r)=>{let o=s[r];if(void 0===o)throw i();return o},e1={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},e2={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},e3=()=>new DOMException("","InvalidStateError"),e4=()=>new DOMException("","InvalidAccessError"),e8=i=>{var s;i.getFrequencyResponse=(s=i.getFrequencyResponse,(r,o,a)=>{if(r.length!==o.length||o.length!==a.length)throw e4();return s.call(i,r,o,a)})},e6={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},e5=(i,s,r,o,a,l,u,h,c,d,p)=>{let f=d.length,m=h;for(let h=0;h<f;h+=1){let f=r[0]*d[h];for(let s=1;s<a;s+=1){let o=m-s&c-1;f+=r[s]*l[o],f-=i[s]*u[o]}for(let i=a;i<o;i+=1)f+=r[i]*l[m-i&c-1];for(let r=a;r<s;r+=1)f-=i[r]*u[m-r&c-1];l[m]=d[h],u[m]=f,m=m+1&c-1,p[h]=f}return m},e7={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},e9=i=>{let s=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{let r=i.decodeAudioData(s.buffer,()=>{});return void 0!==r&&(r.catch(()=>{}),!0)}catch(i){}return!1},nt=(i,s,r)=>{let o=s[r];void 0!==o&&o!==i[r]&&(i[r]=o)},ne=(i,s)=>{nt(i,s,"channelCount"),nt(i,s,"channelCountMode"),nt(i,s,"channelInterpretation")},nn=i=>"function"==typeof i.getFloatTimeDomainData,ni=i=>{i.getFloatTimeDomainData=s=>{let r=new Uint8Array(s.length);i.getByteTimeDomainData(r);let o=Math.max(r.length,i.fftSize);for(let i=0;i<o;i+=1)s[i]=.0078125*(r[i]-128);return s}},ns=(i,s,r)=>{let o=s[r];void 0!==o&&o!==i[r].value&&(i[r].value=o)},nr=i=>{var s;let r;i.start=(s=i.start,r=!1,function(){let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2?arguments[2]:void 0;if(r)throw e3();s.call(i,o,a,l),r=!0})},no=i=>{var s;i.start=(s=i.start,function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2?arguments[2]:void 0;if("number"==typeof a&&a<0||o<0||r<0)throw RangeError("The parameters can't be negative.");s.call(i,r,o,a)})},na=i=>{var s;i.stop=(s=i.stop,function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(r<0)throw RangeError("The parameter can't be negative.");s.call(i,r)})},nl=i=>{let{port1:s}=new MessageChannel;try{s.postMessage(i)}finally{s.close()}},nu=(i,s)=>null===i?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(i*s))))),nh=i=>new Promise((s,r)=>{let{port1:o,port2:a}=new MessageChannel;o.onmessage=i=>{let{data:r}=i;o.close(),a.close(),s(r)},o.onmessageerror=i=>{let{data:s}=i;o.close(),a.close(),r(s)},a.postMessage(i)}),nc=async(i,s)=>new i(await nh(s)),nd=(i,s,r,o)=>{let a=tE.get(i);void 0===a&&(a=new WeakMap,tE.set(i,a));let l=nc(r,o);return a.set(s,l),l},np=(i,s)=>{let r=i.createBiquadFilter();return ne(r,s),ns(r,s,"Q"),ns(r,s,"detune"),ns(r,s,"frequency"),ns(r,s,"gain"),nt(r,s,"type"),r},nf=i=>{let s=i.numberOfOutputs;Object.defineProperty(i,"channelCount",{get:()=>s,set:i=>{if(i!==s)throw e3()}}),Object.defineProperty(i,"channelCountMode",{get:()=>"explicit",set:i=>{if("explicit"!==i)throw e3()}}),Object.defineProperty(i,"channelInterpretation",{get:()=>"discrete",set:i=>{if("discrete"!==i)throw e3()}})},nm=(i,s)=>{let r=i.createChannelSplitter(s.numberOfOutputs);return ne(r,s),nf(r),r},ng=(i,s)=>(i.connect=s.connect.bind(s),i.disconnect=s.disconnect.bind(s),i),n_=(i,s)=>{let r=i.createDelay(s.maxDelayTime);return ne(r,s),ns(r,s,"delayTime"),r},nv=(i,s)=>{let r=i.createGain();return ne(r,s),ns(r,s,"gain"),r};function ny(i,s){var r;let o=[0,0];for(let a=i.length-1;a>=0;a-=1)o=[(r=o)[0]*s[0]-r[1]*s[1],r[0]*s[1]+r[1]*s[0]],o[0]+=i[a];return o}let nb=(i,s,r,o)=>i.createScriptProcessor(s,r,o),nx=()=>new DOMException("","NotSupportedError"),nw={numberOfChannels:1},nT={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},nC={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},nS={disableNormalization:!1},nA={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},nk={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},nO=(i,s,r)=>void 0===i.copyFromChannel?i.getChannelData(r)[0]:(i.copyFromChannel(s,r),s[0]),nE=i=>{if(null===i)return!1;let s=i.length;return s%2!=0?0!==i[Math.floor(s/2)]:i[s/2-1]+i[s/2]!==0},nM=(i,s,r,o)=>{let a=i;for(;!a.hasOwnProperty(s);)a=Object.getPrototypeOf(a);let{get:l,set:u}=Object.getOwnPropertyDescriptor(a,s);Object.defineProperty(i,s,{get:r(l),set:o(u)})},nI=(i,s,r)=>{try{i.setValueAtTime(s,r)}catch(o){if(9!==o.code)throw o;nI(i,s,r+1e-7)}},nD=i=>{let s=i.createOscillator();try{s.start(-1)}catch(i){return i instanceof RangeError}return!1},nR=i=>{let s=i.createBuffer(1,1,44100),r=i.createBufferSource();r.buffer=s,r.start(),r.stop();try{return r.stop(),!0}catch(i){return!1}},nP=i=>{let s=i.createOscillator();try{s.stop(-1)}catch(i){return i instanceof RangeError}return!1},nN=(i,s)=>{var r,o;let a;let l=s.createGain();i.connect(l);let u=(r=i.disconnect,()=>{r.call(i,l),i.removeEventListener("ended",u)});i.addEventListener("ended",u),ng(i,l),i.stop=(o=i.stop,a=!1,function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(a)try{o.call(i,s)}catch(i){l.gain.setValueAtTime(0,s)}else o.call(i,s),a=!0})},nV=(i,s)=>r=>{let o={value:i};return Object.defineProperties(r,{currentTarget:o,target:o}),"function"==typeof s?s.call(i,r):s.handleEvent.call(i,r)},nj=new WeakMap,nq=(l=new Map,u=new WeakMap,(i,s)=>{let r=u.get(i);if(void 0!==r)return r;let o=l.get(i);if(void 0!==o)return o;try{let r=s();return r instanceof Promise?(l.set(i,r),r.catch(()=>!1).then(s=>(l.delete(i),u.set(i,s),s))):(u.set(i,r),r)}catch(s){return u.set(i,!1),!1}}),nL=window,nF=(i,s)=>{let r=i.createAnalyser();if(ne(r,s),!(s.maxDecibels>s.minDecibels))throw tZ();return nt(r,s,"fftSize"),nt(r,s,"maxDecibels"),nt(r,s,"minDecibels"),nt(r,s,"smoothingTimeConstant"),nq(nn,()=>nn(r))||ni(r),r},nB=i=>{let s=t4(i);if(null===s.renderer)throw Error("Missing the renderer of the given AudioNode in the audio graph.");return s.renderer},nW=async(i,s,r)=>{let o=t4(i);await Promise.all(o.activeInputs.map((o,a)=>Array.from(o).map(async o=>{let[l,u]=o,h=nB(l),c=await h.render(l,s),d=i.context.destination;ep(l)||i===d&&ep(i)||c.connect(r,u,a)})).reduce((i,s)=>[...i,...s],[]))},nU=i=>{let s=tS.get(i);if(void 0===s)throw e3();return s},nz=null===nL?null:nL.hasOwnProperty("OfflineAudioContext")?nL.OfflineAudioContext:nL.hasOwnProperty("webkitOfflineAudioContext")?nL.webkitOfflineAudioContext:null,nG=i=>null!==nz&&i instanceof nz,nX=new WeakMap,nZ=(i=>{class s{addEventListener(s,r,o){if(null!==r){let a=this._listeners.get(r);void 0===a&&(a=i(this,r),"function"==typeof r&&this._listeners.set(r,a)),this._nativeEventTarget.addEventListener(s,a,o)}}dispatchEvent(i){return this._nativeEventTarget.dispatchEvent(i)}removeEventListener(i,s,r){let o=null===s?void 0:this._listeners.get(s);this._nativeEventTarget.removeEventListener(i,void 0===o?null:o,r)}constructor(i){this._nativeEventTarget=i,this._listeners=new WeakMap}}return s})(nV),nH=null===nL?null:nL.hasOwnProperty("AudioContext")?nL.AudioContext:nL.hasOwnProperty("webkitAudioContext")?nL.webkitAudioContext:null,nY=i=>null!==nH&&i instanceof nH,nJ=i=>null!==nL&&"function"==typeof nL.AudioNode&&i instanceof nL.AudioNode,nQ=i=>null!==nL&&"function"==typeof nL.AudioParam&&i instanceof nL.AudioParam,n$=null===nL?null:nL.hasOwnProperty("AudioWorkletNode")?nL.AudioWorkletNode:null,nK=((i,s,r,o,a,l,u,h,c,d,p,f,m,g,_,v)=>{class y extends d{get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(i){this._nativeAudioNode.channelCount=i}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(i){this._nativeAudioNode.channelCountMode=i}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(i){this._nativeAudioNode.channelInterpretation=i}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(i){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(r<0||r>=this._nativeAudioNode.numberOfOutputs)throw a();let d=p(this._context),f=_(d);if(m(i)||g(i))throw l();if(t9(i)){let a=ec(i);try{let s=er(this._nativeAudioNode,a,r,h),o=ef(this);(f||o)&&this._nativeAudioNode.disconnect(...s),"closed"!==this.context.state&&!o&&ef(i)&&tF(i)}catch(i){if(12===i.code)throw l();throw i}if(s(this,i,r,h,f)){let s=c([this],i);eg(s,o(f))}return i}let v=ed(i);if("playbackRate"===v.name&&1024===v.maxValue)throw u();try{this._nativeAudioNode.connect(v,r),(f||ef(this))&&this._nativeAudioNode.disconnect(v,r)}catch(i){if(12===i.code)throw l();throw i}let y=((i,s,r,o)=>{let{activeInputs:a,passiveInputs:l}=t8(s),{outputs:u}=t4(i),h=tL(i),c=u=>{let h=ec(i),c=ed(s);if(u){let s=eu(l,i,r);en(a,i,s,!1),o||ep(i)||h.connect(c,r)}else{let s=ea(a,i,r);ei(l,s,!1),o||ep(i)||h.disconnect(c,r)}};return!!ee(u,[s,r],i=>i[0]===s&&i[1]===r,!0)&&(h.add(c),tJ(i)?en(a,i,[r,c],!0):ei(l,[i,r,c],!0),!0)})(this,i,r,f);if(y){let s=c([this],i);eg(s,o(f))}}disconnect(i,s,r){let o;let u=p(this._context),d=_(u);if(void 0===i)o=((i,s)=>{let r=t4(i),o=[];for(let a of r.outputs)et(a)?ey(i,s,...a):eb(i,s,...a),o.push(a[0]);return r.outputs.clear(),o})(this,d);else if("number"==typeof i){if(i<0||i>=this.numberOfOutputs)throw a();o=((i,s,r)=>{let o=t4(i),a=[];for(let l of o.outputs)l[1]===r&&(et(l)?ey(i,s,...l):eb(i,s,...l),a.push(l[0]),o.outputs.delete(l));return a})(this,d,i)}else{if(void 0!==s&&(s<0||s>=this.numberOfOutputs)||t9(i)&&void 0!==r&&(r<0||r>=i.numberOfInputs))throw a();if(0===(o=((i,s,r,o,a)=>{let l=t4(i);return Array.from(l.outputs).filter(i=>!(i[0]!==r||void 0!==o&&i[1]!==o||void 0!==a&&i[2]!==a)).map(r=>(et(r)?ey(i,s,...r):eb(i,s,...r),l.outputs.delete(r),r[0]))})(this,d,i,s,r)).length)throw l()}for(let i of o){let s=c([this],i);eg(s,h)}}constructor(s,o,a,l){super(a),this._context=s,this._nativeAudioNode=a;let u=p(s);f(u)&&!0!==r(em,()=>em(u,v))&&ev(a),tw.set(this,a),tA.set(this,new Set),"closed"!==s.state&&o&&tF(this),i(this,l,a)}}return y})((i,s,r)=>{let o=[];for(let i=0;i<r.numberOfInputs;i+=1)o.push(new Set);tx.set(i,{activeInputs:o,outputs:new Set,passiveInputs:new WeakMap,renderer:s})},((i,s,r,o,a,l,u,h,c,d,p,f,m)=>{let g=new WeakMap;return(_,v,y,b,x)=>{let{activeInputs:w,passiveInputs:T}=l(v),{outputs:C}=l(_),S=h(_),A=l=>{let h=c(v),d=c(_);if(l){let s=tq(T,_,y,b);i(w,_,s,!1),x||f(_)||r(d,h,y,b),m(v)&&tF(v)}else{let i=o(w,_,y,b);s(T,b,i,!1),x||f(_)||a(d,h,y,b);let r=u(v);if(0===r)p(v)&&tU(v,w);else{let i=g.get(v);void 0!==i&&clearTimeout(i),g.set(v,setTimeout(()=>{p(v)&&tU(v,w)},1e3*r))}}};return!!d(C,[v,y,b],i=>i[0]===v&&i[1]===y&&i[2]===b,!0)&&(S.add(A),p(_)?i(w,_,[y,b,A],!0):s(T,b,[_,y,A],!0),!0)}})((i,s,r,o)=>{let[a,l,u]=r;ee(i[l],[s,a,u],i=>i[0]===s&&i[1]===a,o)},(i,s,r,o)=>{let[a,l,u]=r,h=i.get(a);void 0===h?i.set(a,new Set([[l,s,u]])):ee(h,[l,s,u],i=>i[0]===l&&i[1]===s,o)},er,(i,s,r,o)=>tj(i[o],i=>i[0]===s&&i[1]===r),eh,t4,i=>{var s;return null!==(s=nj.get(i))&&void 0!==s?s:0},tL,ec,ee,tJ,ep,ef),nq,i=>(s,r)=>{let o=tk.get(s);if(void 0===o){if(!i&&tJ(s)){let i=ec(s),{outputs:r}=t4(s);for(let s of r)if(et(s)){let r=ec(s[0]);eh(i,r,s[1],s[2])}else{let r=ed(s[0]);i.disconnect(r,s[1])}}tk.set(s,r)}else tk.set(s,o+r)},tZ,e4,nx,(i,s)=>{let r=tk.get(i);if(void 0===r)throw Error("Missing the expected cycle count.");let o=nU(i.context),a=nG(o);if(r===s){if(tk.delete(i),!a&&tJ(i)){let s=ec(i),{outputs:r}=t4(i);for(let i of r)if(et(i)){let r=ec(i[0]);er(s,r,i[1],i[2])}else{let r=ed(i[0]);s.connect(r,i[1])}}}else tk.set(i,r-s)},function i(s,r){let o=t9(r)?r:tV(nX,r);if(eK(o))return[];if(s[0]===o)return[s];if(s.includes(o))return[];let{outputs:a}=t4(o);return Array.from(a).map(r=>i([...s,o],r[0])).reduce((i,s)=>i.concat(s),[])},nZ,nU,nY,nJ,nQ,nG,n$),n0=((i,s,r,o,a,l)=>{class u extends i{get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(i){this._nativeAnalyserNode.fftSize=i}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(i){let s=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=i,!(i>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=s,r()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(i){let s=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=i,!(this._nativeAnalyserNode.maxDecibels>i))throw this._nativeAnalyserNode.minDecibels=s,r()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(i){this._nativeAnalyserNode.smoothingTimeConstant=i}getByteFrequencyData(i){this._nativeAnalyserNode.getByteFrequencyData(i)}getByteTimeDomainData(i){this._nativeAnalyserNode.getByteTimeDomainData(i)}getFloatFrequencyData(i){this._nativeAnalyserNode.getFloatFrequencyData(i)}getFloatTimeDomainData(i){this._nativeAnalyserNode.getFloatTimeDomainData(i)}constructor(i,r){let u=a(i),h={...tz,...r},c=o(u,h);super(i,!1,c,l(u)?s():null),this._nativeAnalyserNode=c}}return u})(nK,()=>{let i=new WeakMap;return{render(s,r){let o=i.get(r);return void 0!==o?Promise.resolve(o):(async(s,r)=>{let o=ec(s);if(!tG(o,r)){let i={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,fftSize:o.fftSize,maxDecibels:o.maxDecibels,minDecibels:o.minDecibels,smoothingTimeConstant:o.smoothingTimeConstant};o=nF(r,i)}return i.set(r,o),await nW(s,r,o),o})(s,r)}}},tZ,nF,nU,nG),n1=new WeakSet,n2=null===nL?null:nL.hasOwnProperty("AudioBuffer")?nL.AudioBuffer:null,n3=(h=new Uint32Array(1),i=>(h[0]=i,h[0])),n4=i=>{i.copyFromChannel=function(s,r){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=n3(o),l=n3(r);if(l>=i.numberOfChannels)throw tZ();let u=i.length,h=i.getChannelData(l),c=s.length;for(let i=a<0?-a:0;i+a<u&&i<c;i+=1)s[i]=h[i+a]},i.copyToChannel=function(s,r){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=n3(o),l=n3(r);if(l>=i.numberOfChannels)throw tZ();let u=i.length,h=i.getChannelData(l),c=s.length;for(let i=a<0?-a:0;i+a<u&&i<c;i+=1)h[i+a]=s[i]}},n8=i=>{var s,r;i.copyFromChannel=(s=i.copyFromChannel,function(r,o){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=n3(a),u=n3(o);if(l<i.length)return s.call(i,r,u,l)}),i.copyToChannel=(r=i.copyToChannel,function(s,o){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=n3(a),u=n3(o);if(l<i.length)return r.call(i,s,u,l)})},n6=(c=()=>{if(null===n2)return!1;try{new n2({length:1,sampleRate:44100})}catch(i){return!1}return!0},o=null,class i{static[Symbol.hasInstance](s){return null!==s&&"object"==typeof s&&Object.getPrototypeOf(s)===i.prototype||n1.has(s)}constructor(i){if(null===nz)throw Error("Missing the native OfflineAudioContext constructor.");let{length:s,numberOfChannels:r,sampleRate:a}={...tY,...i};null===o&&(o=new nz(1,1,44100));let l=null!==n2&&nq(c,c)?new n2({length:s,numberOfChannels:r,sampleRate:a}):o.createBuffer(r,s,a);if(0===l.numberOfChannels)throw nx();return"function"!=typeof l.copyFromChannel?(n4(l),tH(l)):nq(tX,()=>tX(l))||n8(l),n1.add(l),l}}),n5=(i,s)=>{let r=nv(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});s.connect(r).connect(i.destination);let o=()=>{s.removeEventListener("ended",o),s.disconnect(r),r.disconnect()};s.addEventListener("ended",o)},n7=async(i,s,r)=>{let o=t8(i);await Promise.all(Array.from(o.activeInputs).map(async i=>{let[o,a]=i,l=nB(o),u=await l.render(o,s);ep(o)||u.connect(r,a)}))},n9=(i,s,r)=>n7(s,i,r),it=(d=i=>{let s=i.createBufferSource();s.start();try{s.start()}catch(i){return!0}return!1},p=i=>{let s=i.createBufferSource(),r=i.createBuffer(1,1,44100);s.buffer=r;try{s.start(0,1)}catch(i){return!1}return!0},f=i=>{let s=i.createBufferSource();s.start();try{s.stop()}catch(i){return!1}return!0},m=i=>{var s;i.start=(s=i.start,function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2?arguments[2]:void 0,l=i.buffer,u=null===l?o:Math.min(l.duration,o);null!==l&&u>l.duration-.5/i.context.sampleRate?s.call(i,r,0,0):s.call(i,r,u,a)})},g=(i,s)=>{let r=s.createBuffer(1,1,44100);null===i.buffer&&(i.buffer=r),nM(i,"buffer",s=>()=>{let o=s.call(i);return o===r?null:o},s=>o=>s.call(i,null===o?r:o))},(i,s)=>{let r=i.createBufferSource();return ne(r,s),ns(r,s,"playbackRate"),nt(r,s,"buffer"),nt(r,s,"loop"),nt(r,s,"loopEnd"),nt(r,s,"loopStart"),nq(d,()=>d(i))||nr(r),nq(p,()=>p(i))||m(r),nq(f,()=>f(i))||g(r,i),nq(nD,()=>nD(i))||no(r),nq(nR,()=>nR(i))||nN(r,i),nq(nP,()=>nP(i))||na(r),n5(i,r),r}),ie=(_=i=>{let s=t8(i);if(null===s.renderer)throw Error("Missing the renderer of the given AudioParam in the audio graph.");return s.renderer},(i,s,r)=>(_(s).replay(r),n7(s,i,r))),ii=(v=(i,s)=>{tT.set(i,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:s})},y=i=>({replay(s){for(let r of i)if("exponentialRampToValue"===r.type){let{endTime:i,value:o}=r;s.exponentialRampToValueAtTime(o,i)}else if("linearRampToValue"===r.type){let{endTime:i,value:o}=r;s.linearRampToValueAtTime(o,i)}else if("setTarget"===r.type){let{startTime:i,target:o,timeConstant:a}=r;s.setTargetAtTime(o,i,a)}else if("setValue"===r.type){let{startTime:i,value:o}=r;s.setValueAtTime(o,i)}else{if("setValueCurve"!==r.type)throw Error("Can't apply an unknown automation.");{let{duration:i,startTime:o,values:a}=r;s.setValueCurveAtTime(a,o,i)}}}}),b=i=>({cancelTime:i,type:"cancelAndHold"}),x=i=>({cancelTime:i,type:"cancelScheduledValues"}),w=(i,s)=>({endTime:s,type:"exponentialRampToValue",value:i}),T=(i,s)=>({endTime:s,type:"linearRampToValue",value:i}),C=(i,s,r)=>({startTime:s,target:i,timeConstant:r,type:"setTarget"}),function(i,s,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,l=r.value,u=new eL(l),h=s?y(u):null,c={get defaultValue(){return l},get maxValue(){return null===o?r.maxValue:o},get minValue(){return null===a?r.minValue:a},get value(){return r.value},set value(e){r.value=e,c.setValueAtTime(e,i.context.currentTime)},cancelAndHoldAtTime(s){if("function"==typeof r.cancelAndHoldAtTime)null===h&&u.flush(i.context.currentTime),u.add(b(s)),r.cancelAndHoldAtTime(s);else{let o=Array.from(u).pop();null===h&&u.flush(i.context.currentTime),u.add(b(s));let a=Array.from(u).pop();r.cancelScheduledValues(s),o!==a&&void 0!==a&&("exponentialRampToValue"===a.type?r.exponentialRampToValueAtTime(a.value,a.endTime):"linearRampToValue"===a.type?r.linearRampToValueAtTime(a.value,a.endTime):"setValue"===a.type?r.setValueAtTime(a.value,a.startTime):"setValueCurve"===a.type&&r.setValueCurveAtTime(a.values,a.startTime,a.duration))}return c},cancelScheduledValues:s=>(null===h&&u.flush(i.context.currentTime),u.add(x(s)),r.cancelScheduledValues(s),c),exponentialRampToValueAtTime(s,o){if(0===s||!Number.isFinite(o)||o<0)throw RangeError();let a=i.context.currentTime;return null===h&&u.flush(a),0===Array.from(u).length&&(u.add(tv(l,a)),r.setValueAtTime(l,a)),u.add(w(s,o)),r.exponentialRampToValueAtTime(s,o),c},linearRampToValueAtTime(s,o){let a=i.context.currentTime;return null===h&&u.flush(a),0===Array.from(u).length&&(u.add(tv(l,a)),r.setValueAtTime(l,a)),u.add(T(s,o)),r.linearRampToValueAtTime(s,o),c},setTargetAtTime:(s,o,a)=>(null===h&&u.flush(i.context.currentTime),u.add(C(s,o,a)),r.setTargetAtTime(s,o,a),c),setValueAtTime:(s,o)=>(null===h&&u.flush(i.context.currentTime),u.add(tv(s,o)),r.setValueAtTime(s,o),c),setValueCurveAtTime(s,o,a){let l=s instanceof Float32Array?s:new Float32Array(s);if(null!==nH&&"webkitAudioContext"===nH.name){let s=o+a,d=i.context.sampleRate,p=Math.ceil(o*d),f=Math.floor(s*d),m=f-p,g=new Float32Array(m);for(let i=0;i<m;i+=1){let s=(l.length-1)/a*((p+i)/d-o),r=Math.floor(s),u=Math.ceil(s);g[i]=r===u?l[r]:(1-(s-r))*l[r]+(1-(u-s))*l[u]}null===h&&u.flush(i.context.currentTime),u.add(ty(g,o,a)),r.setValueCurveAtTime(g,o,a);let _=f/d;_<s&&nI(c,g[g.length-1],_),nI(c,l[l.length-1],s)}else null===h&&u.flush(i.context.currentTime),u.add(ty(l,o,a)),r.setValueCurveAtTime(l,o,a);return c}};return tC.set(c,r),nX.set(c,i),v(c,h),c}),is=((i,s,r,o,a,l,u,h)=>{class c extends i{get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(i){if(this._nativeAudioBufferSourceNode.buffer=i,null!==i){if(this._isBufferSet)throw o();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(i){this._nativeAudioBufferSourceNode.loop=i}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(i){this._nativeAudioBufferSourceNode.loopEnd=i}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(i){this._nativeAudioBufferSourceNode.loopStart=i}get onended(){return this._onended}set onended(i){let s="function"==typeof i?h(this,i):null;this._nativeAudioBufferSourceNode.onended=s;let r=this._nativeAudioBufferSourceNode.onended;this._onended=null!==r&&r===s?i:r}get playbackRate(){return this._playbackRate}start(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;if(this._nativeAudioBufferSourceNode.start(i,s,r),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===r?[i,s]:[i,s,r]),"closed"!==this.context.state){tF(this);let i=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",i),tJ(this)&&tW(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",i)}}stop(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._nativeAudioBufferSourceNode.stop(i),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=i)}constructor(i,o){let h=l(i),c={...tQ,...o},d=a(h,c),p=u(h),f=p?s():null;super(i,!1,d,f),this._audioBufferSourceNodeRenderer=f,this._isBufferNullified=!1,this._isBufferSet=null!==c.buffer,this._nativeAudioBufferSourceNode=d,this._onended=null,this._playbackRate=r(this,p,d.playbackRate,34028234663852886e22,-34028234663852886e22)}}return c})(nK,()=>{let i=new WeakMap,s=null,r=null;return{set start(t){s=t},set stop(t){r=t},render(o,a){let l=i.get(a);return void 0!==l?Promise.resolve(l):(async(o,a)=>{let l=ec(o),u=tG(l,a);if(!u){let i={buffer:l.buffer,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,loop:l.loop,loopEnd:l.loopEnd,loopStart:l.loopStart,playbackRate:l.playbackRate.value};l=it(a,i),null!==s&&l.start(...s),null!==r&&l.stop(r)}return i.set(a,l),u?await n9(a,o.playbackRate,l.playbackRate):await ie(a,o.playbackRate,l.playbackRate),await nW(o,a,l),l})(o,a)}}},ii,e3,it,nU,nG,nV),ir=((i,s,r,o,a,l,u,h)=>{class c extends i{get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(i){if(this._isNodeOfNativeOfflineAudioContext)throw o();if(i>this._nativeAudioDestinationNode.maxChannelCount)throw r();this._nativeAudioDestinationNode.channelCount=i}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(i){if(this._isNodeOfNativeOfflineAudioContext)throw o();this._nativeAudioDestinationNode.channelCountMode=i}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}constructor(i,r){let o=l(i),c=u(o),d=a(o,r,c);super(i,!1,d,c?s(h):null),this._isNodeOfNativeOfflineAudioContext=c,this._nativeAudioDestinationNode=d}}return c})(nK,i=>{let s=new WeakMap;return{render(r,o){let a=s.get(o);return void 0!==a?Promise.resolve(a):(async(r,o)=>{let a=o.destination;return s.set(o,a),await i(r,o,a),a})(r,o)}}},tZ,e3,(i,s,r)=>{let o=i.destination;if(o.channelCount!==s)try{o.channelCount=s}catch(i){}r&&"explicit"!==o.channelCountMode&&(o.channelCountMode="explicit"),0===o.maxChannelCount&&Object.defineProperty(o,"maxChannelCount",{value:s});let a=nv(i,{channelCount:s,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,gain:1});return nM(a,"channelCount",i=>()=>i.call(a),i=>s=>{i.call(a,s);try{o.channelCount=s}catch(i){if(s>o.maxChannelCount)throw i}}),nM(a,"channelCountMode",i=>()=>i.call(a),i=>s=>{i.call(a,s),o.channelCountMode=s}),nM(a,"channelInterpretation",i=>()=>i.call(a),i=>s=>{i.call(a,s),o.channelInterpretation=s}),Object.defineProperty(a,"maxChannelCount",{get:()=>o.maxChannelCount}),a.connect(o),a},nU,nG,nW),io=(i,s)=>nj.set(i,s),ia=((i,s,r,o,a,l,u,h)=>{class c extends i{get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(i){this._nativeBiquadFilterNode.type=i}getFrequencyResponse(i,s,r){try{this._nativeBiquadFilterNode.getFrequencyResponse(i,s,r)}catch(i){if(11===i.code)throw o();throw i}if(i.length!==s.length||s.length!==r.length)throw o()}constructor(i,o){let c=l(i),d={...eX,...o},p=a(c,d),f=u(c);super(i,!1,p,f?r():null),this._Q=s(this,f,p.Q,34028234663852886e22,-34028234663852886e22),this._detune=s(this,f,p.detune,1200*Math.log2(34028234663852886e22),-1200*Math.log2(34028234663852886e22)),this._frequency=s(this,f,p.frequency,i.sampleRate/2,0),this._gain=s(this,f,p.gain,40*Math.log10(34028234663852886e22),-34028234663852886e22),this._nativeBiquadFilterNode=p,h(this,1)}}return c})(nK,ii,()=>{let i=new WeakMap;return{render(s,r){let o=i.get(r);return void 0!==o?Promise.resolve(o):(async(s,r)=>{let o=ec(s),a=tG(o,r);if(!a){let i={Q:o.Q.value,channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,detune:o.detune.value,frequency:o.frequency.value,gain:o.gain.value,type:o.type};o=np(r,i)}return i.set(r,o),a?(await n9(r,s.Q,o.Q),await n9(r,s.detune,o.detune),await n9(r,s.frequency,o.frequency),await n9(r,s.gain,o.gain)):(await ie(r,s.Q,o.Q),await ie(r,s.detune,o.detune),await ie(r,s.frequency,o.frequency),await ie(r,s.gain,o.gain)),await nW(s,r,o),o})(s,r)}}},e4,np,nU,nG,io),il=(i,s,r)=>{var o,a;let l=new Set;return i.connect=(o=i.connect,function(r){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,h=0===l.size;if(nJ(r))return o.call(i,r,a,u),ee(l,[r,a,u],i=>i[0]===r&&i[1]===a&&i[2]===u,!0),h&&s(),r;o.call(i,r,a),ee(l,[r,a],i=>i[0]===r&&i[1]===a,!0),h&&s()}),i.disconnect=(a=i.disconnect,(s,o,u)=>{let h=l.size>0;if(void 0===s)a.apply(i),l.clear();else if("number"==typeof s)for(let r of(a.call(i,s),l))r[1]===s&&l.delete(r);else for(let r of(nJ(s)?a.call(i,s,o,u):a.call(i,s,o),l))r[0]!==s||void 0!==o&&r[1]!==o||void 0!==u&&r[2]!==u||l.delete(r);let c=0===l.size;h&&c&&r()}),i},iu=(S=(i,s)=>{s.channelCount=1,s.channelCountMode="explicit",Object.defineProperty(s,"channelCount",{get:()=>1,set:()=>{throw e3()}}),Object.defineProperty(s,"channelCountMode",{get:()=>"explicit",set:()=>{throw e3()}});let r=i.createBufferSource();il(s,()=>{let i=s.numberOfInputs;for(let o=0;o<i;o+=1)r.connect(s,0,o)},()=>r.disconnect(s))},(i,s)=>{let r=i.createChannelMerger(s.numberOfInputs);return null!==nH&&"webkitAudioContext"===nH.name&&S(i,r),ne(r,s),r}),ih=((i,s,r,o,a)=>{class l extends i{constructor(i,l){let u=o(i),h={...eZ,...l};super(i,!1,r(u,h),a(u)?s():null)}}return l})(nK,()=>{let i=new WeakMap;return{render(s,r){let o=i.get(r);return void 0!==o?Promise.resolve(o):(async(s,r)=>{let o=ec(s);if(!tG(o,r)){let i={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfInputs:o.numberOfInputs};o=iu(r,i)}return i.set(r,o),await nW(s,r,o),o})(s,r)}}},iu,nU,nG),ic=((i,s,r,o,a,l)=>{class u extends i{constructor(i,u){let h=o(i),c=l({...eH,...u});super(i,!1,r(h,c),a(h)?s():null)}}return u})(nK,()=>{let i=new WeakMap;return{render(s,r){let o=i.get(r);return void 0!==o?Promise.resolve(o):(async(s,r)=>{let o=ec(s);if(!tG(o,r)){let i={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfOutputs:o.numberOfOutputs};o=nm(r,i)}return i.set(r,o),await nW(s,r,o),o})(s,r)}}},nm,nU,nG,i=>({...i,channelCount:i.numberOfOutputs})),id=(A=(i,s)=>{let{offset:r,...o}=s,a=i.createBuffer(1,2,44100),l=it(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),u=nv(i,{...o,gain:r}),h=a.getChannelData(0);return h[0]=1,h[1]=1,l.buffer=a,l.loop=!0,n5(i,l),il(ng({get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(e){u.channelCount=e},get channelCountMode(){return u.channelCountMode},set channelCountMode(e){u.channelCountMode=e},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(e){u.channelInterpretation=e},get context(){return u.context},get inputs(){return[]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get offset(){return u.gain},get onended(){return l.onended},set onended(e){l.onended=e},addEventListener:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];return l.addEventListener(s[0],s[1],s[2])},dispatchEvent:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];return l.dispatchEvent(s[0])},removeEventListener:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];return l.removeEventListener(s[0],s[1],s[2])},start(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;l.start.call(l,i)},stop(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;l.stop.call(l,i)}},u),()=>l.connect(u),()=>l.disconnect(u))},(i,s)=>{if(void 0===i.createConstantSource)return A(i,s);let r=i.createConstantSource();return ne(r,s),ns(r,s,"offset"),nq(nD,()=>nD(i))||no(r),nq(nP,()=>nP(i))||na(r),n5(i,r),r}),ip=((i,s,r,o,a,l,u)=>{class h extends i{get offset(){return this._offset}get onended(){return this._onended}set onended(i){let s="function"==typeof i?u(this,i):null;this._nativeConstantSourceNode.onended=s;let r=this._nativeConstantSourceNode.onended;this._onended=null!==r&&r===s?i:r}start(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this._nativeConstantSourceNode.start(i),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=i),"closed"!==this.context.state){tF(this);let i=()=>{this._nativeConstantSourceNode.removeEventListener("ended",i),tJ(this)&&tW(this)};this._nativeConstantSourceNode.addEventListener("ended",i)}}stop(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._nativeConstantSourceNode.stop(i),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=i)}constructor(i,u){let h=a(i),c={...eY,...u},d=o(h,c),p=l(h),f=p?r():null;super(i,!1,d,f),this._constantSourceNodeRenderer=f,this._nativeConstantSourceNode=d,this._offset=s(this,p,d.offset,34028234663852886e22,-34028234663852886e22),this._onended=null}}return h})(nK,ii,()=>{let i=new WeakMap,s=null,r=null;return{set start(t){s=t},set stop(t){r=t},render(o,a){let l=i.get(a);return void 0!==l?Promise.resolve(l):(async(o,a)=>{let l=ec(o),u=tG(l,a);if(!u){let i={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,offset:l.offset.value};l=id(a,i),null!==s&&l.start(s),null!==r&&l.stop(r)}return i.set(a,l),u?await n9(a,o.offset,l.offset):await ie(a,o.offset,l.offset),await nW(o,a,l),l})(o,a)}}},id,nU,nG,nV),im=(i,s)=>{let r=i.createConvolver();if(ne(r,s),s.disableNormalization===r.normalize&&(r.normalize=!s.disableNormalization),nt(r,s,"buffer"),s.channelCount>2||(nM(r,"channelCount",i=>()=>i.call(r),i=>s=>{if(s>2)throw nx();return i.call(r,s)}),"max"===s.channelCountMode))throw nx();return nM(r,"channelCountMode",i=>()=>i.call(r),i=>s=>{if("max"===s)throw nx();return i.call(r,s)}),r},ig=((i,s,r,o,a,l)=>{class u extends i{get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(i){if(this._nativeConvolverNode.buffer=i,null===i&&null!==this._nativeConvolverNode.buffer){let i=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=i.createBuffer(1,1,i.sampleRate),this._isBufferNullified=!0,l(this,0)}else this._isBufferNullified=!1,l(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(i){this._nativeConvolverNode.normalize=i}constructor(i,u){let h=o(i),c={...eJ,...u},d=r(h,c);super(i,!1,d,a(h)?s():null),this._isBufferNullified=!1,this._nativeConvolverNode=d,null!==c.buffer&&l(this,c.buffer.duration)}}return u})(nK,()=>{let i=new WeakMap;return{render(s,r){let o=i.get(r);return void 0!==o?Promise.resolve(o):(async(s,r)=>{let o=ec(s);if(!tG(o,r)){let i={buffer:o.buffer,channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,disableNormalization:!o.normalize};o=im(r,i)}return i.set(r,o),es(o)?await nW(s,r,o.inputs[0]):await nW(s,r,o),o})(s,r)}}},im,nU,nG,io),i_=((i,s,r,o,a,l,u)=>{class h extends i{get delayTime(){return this._delayTime}constructor(i,h){let c=a(i),d={...e$,...h},p=o(c,d),f=l(c);super(i,!1,p,f?r(d.maxDelayTime):null),this._delayTime=s(this,f,p.delayTime),u(this,d.maxDelayTime)}}return h})(nK,ii,i=>{let s=new WeakMap;return{render(r,o){let a=s.get(o);return void 0!==a?Promise.resolve(a):(async(r,o)=>{let a=ec(r),l=tG(a,o);if(!l){let s={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,delayTime:a.delayTime.value,maxDelayTime:i};a=n_(o,s)}return s.set(o,a),l?await n9(o,r.delayTime,a.delayTime):await ie(o,r.delayTime,a.delayTime),await nW(r,o,a),a})(r,o)}}},n_,nU,nG,io),iv=(i,s)=>{let r=i.createDynamicsCompressor();if(ne(r,s),s.channelCount>2||"max"===s.channelCountMode)throw nx();return ns(r,s,"attack"),ns(r,s,"knee"),ns(r,s,"ratio"),ns(r,s,"release"),ns(r,s,"threshold"),r},iy=((i,s,r,o,a,l,u,h)=>{class c extends i{get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(i){let s=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=i,i>2)throw this._nativeDynamicsCompressorNode.channelCount=s,a()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(i){let s=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=i,"max"===i)throw this._nativeDynamicsCompressorNode.channelCountMode=s,a()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}constructor(i,a){let c=l(i),d={...e1,...a},p=o(c,d),f=u(c);super(i,!1,p,f?r():null),this._attack=s(this,f,p.attack),this._knee=s(this,f,p.knee),this._nativeDynamicsCompressorNode=p,this._ratio=s(this,f,p.ratio),this._release=s(this,f,p.release),this._threshold=s(this,f,p.threshold),h(this,.006)}}return c})(nK,ii,()=>{let i=new WeakMap;return{render(s,r){let o=i.get(r);return void 0!==o?Promise.resolve(o):(async(s,r)=>{let o=ec(s),a=tG(o,r);if(!a){let i={attack:o.attack.value,channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,knee:o.knee.value,ratio:o.ratio.value,release:o.release.value,threshold:o.threshold.value};o=iv(r,i)}return i.set(r,o),a?(await n9(r,s.attack,o.attack),await n9(r,s.knee,o.knee),await n9(r,s.ratio,o.ratio),await n9(r,s.release,o.release),await n9(r,s.threshold,o.threshold)):(await ie(r,s.attack,o.attack),await ie(r,s.knee,o.knee),await ie(r,s.ratio,o.ratio),await ie(r,s.release,o.release),await ie(r,s.threshold,o.threshold)),await nW(s,r,o),o})(s,r)}}},iv,nx,nU,nG,io),ib=((i,s,r,o,a,l)=>{class u extends i{get gain(){return this._gain}constructor(i,u){let h=a(i),c={...e2,...u},d=o(h,c),p=l(h);super(i,!1,d,p?r():null),this._gain=s(this,p,d.gain,34028234663852886e22,-34028234663852886e22)}}return u})(nK,ii,()=>{let i=new WeakMap;return{render(s,r){let o=i.get(r);return void 0!==o?Promise.resolve(o):(async(s,r)=>{let o=ec(s),a=tG(o,r);if(!a){let i={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,gain:o.gain.value};o=nv(r,i)}return i.set(r,o),a?await n9(r,s.gain,o.gain):await ie(r,s.gain,o.gain),await nW(s,r,o),o})(s,r)}}},nv,nU,nG),ix=(k=()=>{if(null===nz)return Promise.resolve(!1);let i=new nz(1,1,44100),s=nv(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(r=>{i.oncomplete=()=>{s.disconnect(),r(0!==i.currentTime)},i.startRendering()})},i=>nq(e9,()=>e9(i))?Promise.resolve(nq(k,k)).then(s=>{if(!s){let s=nb(i,512,0,1);i.oncomplete=()=>{s.onaudioprocess=null,s.disconnect()},s.onaudioprocess=()=>i.currentTime,s.connect(i.destination)}return i.startRendering()}):new Promise(s=>{let r=nv(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=i=>{r.disconnect(),s(i.renderedBuffer)},r.connect(i.destination),i.startRendering()})),iw=((i,s,r,o,a,l)=>{class u extends i{getFrequencyResponse(i,s,r){return this._nativeIIRFilterNode.getFrequencyResponse(i,s,r)}constructor(i,u){let h=o(i),c=a(h),d={...e6,...u},p=s(h,c?null:i.baseLatency,d);super(i,!1,p,c?r(d.feedback,d.feedforward):null),e8(p),this._nativeIIRFilterNode=p,l(this,1)}}return u})(nK,(O=(i,s,r)=>{let{channelCount:o,channelCountMode:a,channelInterpretation:l,feedback:u,feedforward:h}=r,c=nu(s,i.sampleRate),d=u instanceof Float64Array?u:new Float64Array(u),p=h instanceof Float64Array?h:new Float64Array(h),f=d.length,m=p.length,g=Math.min(f,m);if(0===f||f>20)throw nx();if(0===d[0])throw e3();if(0===m||m>20)throw nx();if(0===p[0])throw e3();if(1!==d[0]){for(let i=0;i<m;i+=1)p[i]/=d[0];for(let i=1;i<f;i+=1)d[i]/=d[0]}let _=nb(i,c,o,o);_.channelCount=o,_.channelCountMode=a,_.channelInterpretation=l;let v=[],y=[],b=[];for(let i=0;i<o;i+=1){v.push(0);let i=new Float32Array(32),s=new Float32Array(32);i.fill(0),s.fill(0),y.push(i),b.push(s)}_.onaudioprocess=i=>{let s=i.inputBuffer,r=i.outputBuffer,o=s.numberOfChannels;for(let i=0;i<o;i+=1){let o=s.getChannelData(i),a=r.getChannelData(i);v[i]=e5(d,f,p,m,g,y[i],b[i],v[i],32,o,a)}};let x=i.sampleRate/2;return ng({get bufferSize(){return c},get channelCount(){return _.channelCount},set channelCount(t){_.channelCount=t},get channelCountMode(){return _.channelCountMode},set channelCountMode(t){_.channelCountMode=t},get channelInterpretation(){return _.channelInterpretation},set channelInterpretation(t){_.channelInterpretation=t},get context(){return _.context},get inputs(){return[_]},get numberOfInputs(){return _.numberOfInputs},get numberOfOutputs(){return _.numberOfOutputs},addEventListener:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];return _.addEventListener(s[0],s[1],s[2])},dispatchEvent:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];return _.dispatchEvent(s[0])},getFrequencyResponse(i,s,r){if(i.length!==s.length||s.length!==r.length)throw e4();let o=i.length;for(let a=0;a<o;a+=1){let o=-Math.PI*(i[a]/x),l=[Math.cos(o),Math.sin(o)],u=function(i,s){let r=s[0]*s[0]+s[1]*s[1];return[(i[0]*s[0]+i[1]*s[1])/r,(i[1]*s[0]-i[0]*s[1])/r]}(ny(p,l),ny(d,l));s[a]=Math.sqrt(u[0]*u[0]+u[1]*u[1]),r[a]=Math.atan2(u[1],u[0])}},removeEventListener:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];return _.removeEventListener(s[0],s[1],s[2])}},_)},(i,s,r)=>{if(void 0===i.createIIRFilter)return O(i,s,r);let o=i.createIIRFilter(r.feedforward,r.feedback);return ne(o,r),o}),(i,s)=>{let r=new WeakMap,o=null,a=async(a,l)=>{let u=null,h=ec(a),c=tG(h,l);if(void 0===l.createIIRFilter?u=it(l,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):c||(h=l.createIIRFilter(s,i)),r.set(l,null===u?h:u),null!==u){if(null===o){if(null===nz)throw Error("Missing the native OfflineAudioContext constructor.");let r=new nz(a.context.destination.channelCount,a.context.length,l.sampleRate);o=(async()=>(await nW(a,r,r.destination),((i,s,r,o)=>{let a=r instanceof Float64Array?r:new Float64Array(r),l=o instanceof Float64Array?o:new Float64Array(o),u=a.length,h=l.length,c=Math.min(u,h);if(1!==a[0]){for(let i=0;i<u;i+=1)l[i]/=a[0];for(let i=1;i<h;i+=1)a[i]/=a[0]}let d=new Float32Array(32),p=new Float32Array(32),f=s.createBuffer(i.numberOfChannels,i.length,i.sampleRate),m=i.numberOfChannels;for(let s=0;s<m;s+=1){let r=i.getChannelData(s),o=f.getChannelData(s);d.fill(0),p.fill(0),e5(a,u,l,h,c,d,p,0,32,r,o)}return f})(await ix(r),l,i,s)))()}let r=await o;return u.buffer=r,u.start(0),u}return await nW(a,l,h),h};return{render(i,s){let o=r.get(s);return void 0!==o?Promise.resolve(o):a(i,s)}}},nU,nG,io),iT=new WeakMap,iC=((i,s,r,o,a,l)=>{class u extends r{get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(i){let s="function"==typeof i?l(this,i):null;this._nativeContext.onstatechange=s;let r=this._nativeContext.onstatechange;this._onstatechange=null!==r&&r===s?i:r}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}constructor(r,l){super(r),this._nativeContext=r,tS.set(this,r),o(r)&&a.set(r,new Set),this._destination=new i(this,l),this._listener=s(this,r),this._onstatechange=null}}return u})(ir,(i,s)=>{let r=s.listener,{forwardX:o,forwardY:a,forwardZ:l,positionX:u,positionY:h,positionZ:c,upX:d,upY:p,upZ:f}=void 0===r.forwardX?(()=>{let o=new Float32Array(1),a=iu(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),l=nG(s),u=!1,h=[0,0,-1,0,1,0],c=[0,0,0],d=()=>{if(u)return;u=!0;let i=nb(s,256,9,0);i.onaudioprocess=i=>{let{inputBuffer:s}=i,a=[nO(s,o,0),nO(s,o,1),nO(s,o,2),nO(s,o,3),nO(s,o,4),nO(s,o,5)];a.some((i,s)=>i!==h[s])&&(r.setOrientation(...a),h=a);let l=[nO(s,o,6),nO(s,o,7),nO(s,o,8)];l.some((i,s)=>i!==c[s])&&(r.setPosition(...l),c=l)},a.connect(i)},p=i=>s=>{s!==h[i]&&(h[i]=s,r.setOrientation(...h))},f=i=>s=>{s!==c[i]&&(c[i]=s,r.setPosition(...c))},m=(r,o,u)=>{var h,c,p,f,m,g,_;let v=id(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:o});v.connect(a,0,r),v.start(),Object.defineProperty(v.offset,"defaultValue",{get:()=>o});let y=ii({context:i},l,v.offset,34028234663852886e22,-34028234663852886e22);return nM(y,"value",i=>()=>i.call(y),i=>s=>{try{i.call(y,s)}catch(i){if(9!==i.code)throw i}d(),l&&u(s)}),y.cancelAndHoldAtTime=(h=y.cancelAndHoldAtTime,l?()=>{throw nx()}:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];let o=h.apply(y,s);return d(),o}),y.cancelScheduledValues=(c=y.cancelScheduledValues,l?()=>{throw nx()}:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];let o=c.apply(y,s);return d(),o}),y.exponentialRampToValueAtTime=(p=y.exponentialRampToValueAtTime,l?()=>{throw nx()}:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];let o=p.apply(y,s);return d(),o}),y.linearRampToValueAtTime=(f=y.linearRampToValueAtTime,l?()=>{throw nx()}:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];let o=f.apply(y,s);return d(),o}),y.setTargetAtTime=(m=y.setTargetAtTime,l?()=>{throw nx()}:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];let o=m.apply(y,s);return d(),o}),y.setValueAtTime=(g=y.setValueAtTime,l?()=>{throw nx()}:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];let o=g.apply(y,s);return d(),o}),y.setValueCurveAtTime=(_=y.setValueCurveAtTime,l?()=>{throw nx()}:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];let o=_.apply(y,s);return d(),o}),y};return{forwardX:m(0,0,p(0)),forwardY:m(1,0,p(1)),forwardZ:m(2,-1,p(2)),positionX:m(6,0,f(0)),positionY:m(7,0,f(1)),positionZ:m(8,0,f(2)),upX:m(3,0,p(3)),upY:m(4,1,p(4)),upZ:m(5,0,p(5))}})():r;return{get forwardX(){return o},get forwardY(){return a},get forwardZ(){return l},get positionX(){return u},get positionY(){return h},get positionZ(){return c},get upX(){return d},get upY(){return p},get upZ(){return f}}},nZ,nG,iT,nV),iS=(i,s)=>{let r=i.createOscillator();return ne(r,s),ns(r,s,"detune"),ns(r,s,"frequency"),void 0!==s.periodicWave?r.setPeriodicWave(s.periodicWave):nt(r,s,"type"),nq(nD,()=>nD(i))||no(r),nq(nR,()=>nR(i))||nN(r,i),nq(nP,()=>nP(i))||na(r),n5(i,r),r},iA=((i,s,r,o,a,l,u)=>{class h extends i{get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(i){let s="function"==typeof i?u(this,i):null;this._nativeOscillatorNode.onended=s;let r=this._nativeOscillatorNode.onended;this._onended=null!==r&&r===s?i:r}get type(){return this._nativeOscillatorNode.type}set type(i){this._nativeOscillatorNode.type=i,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(i){this._nativeOscillatorNode.setPeriodicWave(i),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=i)}start(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this._nativeOscillatorNode.start(i),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=i),"closed"!==this.context.state){tF(this);let i=()=>{this._nativeOscillatorNode.removeEventListener("ended",i),tJ(this)&&tW(this)};this._nativeOscillatorNode.addEventListener("ended",i)}}stop(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._nativeOscillatorNode.stop(i),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=i)}constructor(i,u){let h=a(i),c={...nT,...u},d=r(h,c),p=l(h),f=p?o():null,m=i.sampleRate/2;super(i,!1,d,f),this._detune=s(this,p,d.detune,153600,-153600),this._frequency=s(this,p,d.frequency,m,-m),this._nativeOscillatorNode=d,this._onended=null,this._oscillatorNodeRenderer=f,null!==this._oscillatorNodeRenderer&&void 0!==c.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=c.periodicWave)}}return h})(nK,ii,iS,()=>{let i=new WeakMap,s=null,r=null,o=null;return{set periodicWave(e){s=e},set start(e){r=e},set stop(e){o=e},render(a,l){let u=i.get(l);return void 0!==u?Promise.resolve(u):(async(a,l)=>{let u=ec(a),h=tG(u,l);if(!h){let i={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,detune:u.detune.value,frequency:u.frequency.value,periodicWave:null===s?void 0:s,type:u.type};u=iS(l,i),null!==r&&u.start(r),null!==o&&u.stop(o)}return i.set(l,u),h?(await n9(l,a.detune,u.detune),await n9(l,a.frequency,u.frequency)):(await ie(l,a.detune,u.detune),await ie(l,a.frequency,u.frequency)),await nW(a,l,u),u})(a,l)}}},nU,nG,nV),ik=(i,s)=>{let r=it(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),o=i.createBuffer(1,2,44100);return r.buffer=o,r.loop=!0,r.connect(s),r.start(),()=>{r.stop(),r.disconnect(s)}},iO=(E=(i,s)=>{let{curve:r,oversample:o,...a}=s,l=i.createWaveShaper(),u=i.createWaveShaper();ne(l,a),ne(u,a);let h=nv(i,{...a,gain:1}),c=nv(i,{...a,gain:-1}),d=nv(i,{...a,gain:1}),p=nv(i,{...a,gain:-1}),f=null,m=!1,g=null,_={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(n){h.channelCount=n,c.channelCount=n,l.channelCount=n,d.channelCount=n,u.channelCount=n,p.channelCount=n},get channelCountMode(){return l.channelCountMode},set channelCountMode(n){h.channelCountMode=n,c.channelCountMode=n,l.channelCountMode=n,d.channelCountMode=n,u.channelCountMode=n,p.channelCountMode=n},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(n){h.channelInterpretation=n,c.channelInterpretation=n,l.channelInterpretation=n,d.channelInterpretation=n,u.channelInterpretation=n,p.channelInterpretation=n},get context(){return l.context},get curve(){return g},set curve(n){if(null!==n&&n.length<2)throw e3();if(null===n)l.curve=n,u.curve=n;else{let i=n.length,s=new Float32Array(i+2-i%2),r=new Float32Array(i+2-i%2);s[0]=n[0],r[0]=-n[i-1];let o=Math.ceil((i+1)/2),a=(i+1)/2-1;for(let l=1;l<o;l+=1){let u=l/o*a,h=Math.floor(u),c=Math.ceil(u);s[l]=h===c?n[h]:(1-(u-h))*n[h]+(1-(c-u))*n[c],r[l]=h===c?-n[i-1-h]:-(1-(u-h))*n[i-1-h]-(1-(c-u))*n[i-1-c]}s[o]=i%2==1?n[o-1]:(n[o-2]+n[o-1])/2,l.curve=s,u.curve=r}g=n,m&&(nE(g)&&null===f?f=ik(i,h):null!==f&&(f(),f=null))},get inputs(){return[h]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(n){l.oversample=n,u.oversample=n},addEventListener:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];return h.addEventListener(s[0],s[1],s[2])},dispatchEvent:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];return h.dispatchEvent(s[0])},removeEventListener:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];return h.removeEventListener(s[0],s[1],s[2])}};return null!==r&&(_.curve=r instanceof Float32Array?r:new Float32Array(r)),o!==_.oversample&&(_.oversample=o),il(ng(_,d),()=>{h.connect(l).connect(d),h.connect(c).connect(u).connect(p).connect(d),m=!0,nE(g)&&(f=ik(i,h))},()=>{h.disconnect(l),l.disconnect(d),h.disconnect(c),c.disconnect(u),u.disconnect(p),p.disconnect(d),m=!1,null!==f&&(f(),f=null)})},(i,s)=>{let r=i.createWaveShaper();if(null!==nH&&"webkitAudioContext"===nH.name&&void 0===i.createGain().gain.automationRate)return E(i,s);ne(r,s);let o=null===s.curve||s.curve instanceof Float32Array?s.curve:new Float32Array(s.curve);if(null!==o&&o.length<2)throw e3();nt(r,{curve:o},"curve"),nt(r,s,"oversample");let a=null,l=!1;return nM(r,"curve",i=>()=>i.call(r),s=>o=>(s.call(r,o),l&&(nE(o)&&null===a?a=ik(i,r):nE(o)||null===a||(a(),a=null)),o)),il(r,()=>{l=!0,nE(r.curve)&&(a=ik(i,r))},()=>{l=!1,null!==a&&(a(),a=null)})}),iE=(M=(i,s)=>{let{coneInnerAngle:r,coneOuterAngle:o,coneOuterGain:a,distanceModel:l,maxDistance:u,orientationX:h,orientationY:c,orientationZ:d,panningModel:p,positionX:f,positionY:m,positionZ:g,refDistance:_,rolloffFactor:v,...y}=s,b=i.createPanner();if(y.channelCount>2||"max"===y.channelCountMode)throw nx();ne(b,y);let x={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},w=iu(i,{...x,channelInterpretation:"speakers",numberOfInputs:6}),T=nv(i,{...y,gain:1}),C=nv(i,{...x,gain:1}),S=nv(i,{...x,gain:0}),A=nv(i,{...x,gain:0}),k=nv(i,{...x,gain:0}),O=nv(i,{...x,gain:0}),E=nv(i,{...x,gain:0}),M=nb(i,256,6,1),I=iO(i,{...x,curve:new Float32Array([1,1]),oversample:"none"}),D=[h,c,d],R=[f,m,g],P=new Float32Array(1);M.onaudioprocess=i=>{let{inputBuffer:s}=i,r=[nO(s,P,0),nO(s,P,1),nO(s,P,2)];r.some((i,s)=>i!==D[s])&&(b.setOrientation(...r),D=r);let o=[nO(s,P,3),nO(s,P,4),nO(s,P,5)];o.some((i,s)=>i!==R[s])&&(b.setPosition(...o),R=o)},Object.defineProperty(S.gain,"defaultValue",{get:()=>0}),Object.defineProperty(A.gain,"defaultValue",{get:()=>0}),Object.defineProperty(k.gain,"defaultValue",{get:()=>0}),Object.defineProperty(O.gain,"defaultValue",{get:()=>0}),Object.defineProperty(E.gain,"defaultValue",{get:()=>0});let N={get bufferSize(){},get channelCount(){return b.channelCount},set channelCount(n){if(n>2)throw nx();T.channelCount=n,b.channelCount=n},get channelCountMode(){return b.channelCountMode},set channelCountMode(n){if("max"===n)throw nx();T.channelCountMode=n,b.channelCountMode=n},get channelInterpretation(){return b.channelInterpretation},set channelInterpretation(n){T.channelInterpretation=n,b.channelInterpretation=n},get coneInnerAngle(){return b.coneInnerAngle},set coneInnerAngle(n){b.coneInnerAngle=n},get coneOuterAngle(){return b.coneOuterAngle},set coneOuterAngle(n){b.coneOuterAngle=n},get coneOuterGain(){return b.coneOuterGain},set coneOuterGain(n){if(n<0||n>1)throw e3();b.coneOuterGain=n},get context(){return b.context},get distanceModel(){return b.distanceModel},set distanceModel(n){b.distanceModel=n},get inputs(){return[T]},get maxDistance(){return b.maxDistance},set maxDistance(n){if(n<0)throw RangeError();b.maxDistance=n},get numberOfInputs(){return b.numberOfInputs},get numberOfOutputs(){return b.numberOfOutputs},get orientationX(){return C.gain},get orientationY(){return S.gain},get orientationZ(){return A.gain},get panningModel(){return b.panningModel},set panningModel(n){b.panningModel=n},get positionX(){return k.gain},get positionY(){return O.gain},get positionZ(){return E.gain},get refDistance(){return b.refDistance},set refDistance(n){if(n<0)throw RangeError();b.refDistance=n},get rolloffFactor(){return b.rolloffFactor},set rolloffFactor(n){if(n<0)throw RangeError();b.rolloffFactor=n},addEventListener:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];return T.addEventListener(s[0],s[1],s[2])},dispatchEvent:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];return T.dispatchEvent(s[0])},removeEventListener:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];return T.removeEventListener(s[0],s[1],s[2])}};return r!==N.coneInnerAngle&&(N.coneInnerAngle=r),o!==N.coneOuterAngle&&(N.coneOuterAngle=o),a!==N.coneOuterGain&&(N.coneOuterGain=a),l!==N.distanceModel&&(N.distanceModel=l),u!==N.maxDistance&&(N.maxDistance=u),h!==N.orientationX.value&&(N.orientationX.value=h),c!==N.orientationY.value&&(N.orientationY.value=c),d!==N.orientationZ.value&&(N.orientationZ.value=d),p!==N.panningModel&&(N.panningModel=p),f!==N.positionX.value&&(N.positionX.value=f),m!==N.positionY.value&&(N.positionY.value=m),g!==N.positionZ.value&&(N.positionZ.value=g),_!==N.refDistance&&(N.refDistance=_),v!==N.rolloffFactor&&(N.rolloffFactor=v),1===D[0]&&0===D[1]&&0===D[2]||b.setOrientation(...D),0===R[0]&&0===R[1]&&0===R[2]||b.setPosition(...R),il(ng(N,b),()=>{T.connect(b),er(T,I,0,0),I.connect(C).connect(w,0,0),I.connect(S).connect(w,0,1),I.connect(A).connect(w,0,2),I.connect(k).connect(w,0,3),I.connect(O).connect(w,0,4),I.connect(E).connect(w,0,5),w.connect(M).connect(i.destination)},()=>{T.disconnect(b),eh(T,I,0,0),I.disconnect(C),C.disconnect(w),I.disconnect(S),S.disconnect(w),I.disconnect(A),A.disconnect(w),I.disconnect(k),k.disconnect(w),I.disconnect(O),O.disconnect(w),I.disconnect(E),E.disconnect(w),w.disconnect(M),M.disconnect(i.destination)})},(i,s)=>{let r=i.createPanner();return void 0===r.orientationX?M(i,s):(ne(r,s),ns(r,s,"orientationX"),ns(r,s,"orientationY"),ns(r,s,"orientationZ"),ns(r,s,"positionX"),ns(r,s,"positionY"),ns(r,s,"positionZ"),nt(r,s,"coneInnerAngle"),nt(r,s,"coneOuterAngle"),nt(r,s,"coneOuterGain"),nt(r,s,"distanceModel"),nt(r,s,"maxDistance"),nt(r,s,"panningModel"),nt(r,s,"refDistance"),nt(r,s,"rolloffFactor"),r)}),iM=((i,s,r,o,a,l,u)=>{class h extends i{get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(i){this._nativePannerNode.coneInnerAngle=i}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(i){this._nativePannerNode.coneOuterAngle=i}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(i){this._nativePannerNode.coneOuterGain=i}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(i){this._nativePannerNode.distanceModel=i}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(i){this._nativePannerNode.maxDistance=i}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(i){this._nativePannerNode.panningModel=i}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(i){this._nativePannerNode.refDistance=i}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(i){this._nativePannerNode.rolloffFactor=i}constructor(i,h){let c=a(i),d={...nC,...h},p=r(c,d),f=l(c);super(i,!1,p,f?o():null),this._nativePannerNode=p,this._orientationX=s(this,f,p.orientationX,34028234663852886e22,-34028234663852886e22),this._orientationY=s(this,f,p.orientationY,34028234663852886e22,-34028234663852886e22),this._orientationZ=s(this,f,p.orientationZ,34028234663852886e22,-34028234663852886e22),this._positionX=s(this,f,p.positionX,34028234663852886e22,-34028234663852886e22),this._positionY=s(this,f,p.positionY,34028234663852886e22,-34028234663852886e22),this._positionZ=s(this,f,p.positionZ,34028234663852886e22,-34028234663852886e22),u(this,1)}}return h})(nK,ii,iE,()=>{let i=new WeakMap,s=null;return{render(r,o){let a=i.get(o);return void 0!==a?Promise.resolve(a):(async(r,o)=>{let a=null,l=ec(r),u={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation},h={...u,coneInnerAngle:l.coneInnerAngle,coneOuterAngle:l.coneOuterAngle,coneOuterGain:l.coneOuterGain,distanceModel:l.distanceModel,maxDistance:l.maxDistance,panningModel:l.panningModel,refDistance:l.refDistance,rolloffFactor:l.rolloffFactor},c=tG(l,o);if("bufferSize"in l)a=nv(o,{...u,gain:1});else if(!c){let i={...h,orientationX:l.orientationX.value,orientationY:l.orientationY.value,orientationZ:l.orientationZ.value,positionX:l.positionX.value,positionY:l.positionY.value,positionZ:l.positionZ.value};l=iE(o,i)}if(i.set(o,null===a?l:a),null!==a){if(null===s){if(null===nz)throw Error("Missing the native OfflineAudioContext constructor.");let i=new nz(6,r.context.length,o.sampleRate),a=iu(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});a.connect(i.destination),s=(async()=>{let s=await Promise.all([r.orientationX,r.orientationY,r.orientationZ,r.positionX,r.positionY,r.positionZ].map(async(s,r)=>{let o=id(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===r?1:0});return await ie(i,s,o.offset),o}));for(let i=0;i<6;i+=1)s[i].connect(a,0,i),s[i].start(0);return ix(i)})()}let i=await s,l=nv(o,{...u,gain:1});await nW(r,o,l);let c=[];for(let s=0;s<i.numberOfChannels;s+=1)c.push(i.getChannelData(s));let d=[c[0][0],c[1][0],c[2][0]],p=[c[3][0],c[4][0],c[5][0]],f=nv(o,{...u,gain:1}),m=iE(o,{...h,orientationX:d[0],orientationY:d[1],orientationZ:d[2],positionX:p[0],positionY:p[1],positionZ:p[2]});l.connect(f).connect(m.inputs[0]),m.connect(a);for(let s=128;s<i.length;s+=128){let i=[c[0][s],c[1][s],c[2][s]],r=[c[3][s],c[4][s],c[5][s]];if(i.some((i,s)=>i!==d[s])||r.some((i,s)=>i!==p[s])){d=i,p=r;let c=s/o.sampleRate;f.gain.setValueAtTime(0,c),f=nv(o,{...u,gain:0}),m=iE(o,{...h,orientationX:d[0],orientationY:d[1],orientationZ:d[2],positionX:p[0],positionY:p[1],positionZ:p[2]}),f.gain.setValueAtTime(1,c),l.connect(f).connect(m.inputs[0]),m.connect(a)}}return a}return c?(await n9(o,r.orientationX,l.orientationX),await n9(o,r.orientationY,l.orientationY),await n9(o,r.orientationZ,l.orientationZ),await n9(o,r.positionX,l.positionX),await n9(o,r.positionY,l.positionY),await n9(o,r.positionZ,l.positionZ)):(await ie(o,r.orientationX,l.orientationX),await ie(o,r.orientationY,l.orientationY),await ie(o,r.orientationZ,l.orientationZ),await ie(o,r.positionX,l.positionX),await ie(o,r.positionY,l.positionY),await ie(o,r.positionZ,l.positionZ)),es(l)?await nW(r,o,l.inputs[0]):await nW(r,o,l),l})(r,o)}}},nU,nG,io),iI=((i,s,r,o)=>{class a{static[Symbol.hasInstance](i){return null!==i&&"object"==typeof i&&Object.getPrototypeOf(i)===a.prototype||r.has(i)}constructor(a,l){let u=s(a),h=o({...nS,...l}),c=i(u,h);return r.add(c),c}}return a})((i,s)=>{let{disableNormalization:r,imag:o,real:a}=s,l=o instanceof Float32Array?o:new Float32Array(o),u=a instanceof Float32Array?a:new Float32Array(a),h=i.createPeriodicWave(u,l,{disableNormalization:r});if(Array.from(o).length<2)throw tZ();return h},nU,new WeakSet,i=>{let{imag:s,real:r}=i;return void 0===s?void 0===r?{...i,imag:[0,0],real:[0,0]}:{...i,imag:Array.from(r,()=>0),real:r}:void 0===r?{...i,imag:s,real:Array.from(s,()=>0)}:{...i,imag:s,real:r}}),iD=(I=((i,s,r,o,a,l)=>{let u=new Float32Array([1,1]),h=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},d={...c,oversample:"none"},p=(i,l,p,f,m)=>{if(1===l)return((i,s,a,l)=>{let p=new Float32Array(16385),f=new Float32Array(16385);for(let i=0;i<16385;i+=1){let s=i/16384*h;p[i]=Math.cos(s),f[i]=Math.sin(s)}let m=r(i,{...c,gain:0}),g=o(i,{...d,curve:p}),_=o(i,{...d,curve:u}),v=r(i,{...c,gain:0}),y=o(i,{...d,curve:f});return{connectGraph(){s.connect(m),s.connect(void 0===_.inputs?_:_.inputs[0]),s.connect(v),_.connect(a),a.connect(void 0===g.inputs?g:g.inputs[0]),a.connect(void 0===y.inputs?y:y.inputs[0]),g.connect(m.gain),y.connect(v.gain),m.connect(l,0,0),v.connect(l,0,1)},disconnectGraph(){s.disconnect(m),s.disconnect(void 0===_.inputs?_:_.inputs[0]),s.disconnect(v),_.disconnect(a),a.disconnect(void 0===g.inputs?g:g.inputs[0]),a.disconnect(void 0===y.inputs?y:y.inputs[0]),g.disconnect(m.gain),y.disconnect(v.gain),m.disconnect(l,0,0),v.disconnect(l,0,1)}}})(i,p,f,m);if(2===l)return((i,a,l,p)=>{let f=new Float32Array(16385),m=new Float32Array(16385),g=new Float32Array(16385),_=new Float32Array(16385),v=Math.floor(8192.5);for(let i=0;i<16385;i+=1)if(i>v){let s=(i-v)/(16384-v)*h;f[i]=Math.cos(s),m[i]=Math.sin(s),g[i]=0,_[i]=1}else{let s=i/(16384-v)*h;f[i]=1,m[i]=0,g[i]=Math.cos(s),_[i]=Math.sin(s)}let y=s(i,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),b=r(i,{...c,gain:0}),x=o(i,{...d,curve:f}),w=r(i,{...c,gain:0}),T=o(i,{...d,curve:m}),C=o(i,{...d,curve:u}),S=r(i,{...c,gain:0}),A=o(i,{...d,curve:g}),k=r(i,{...c,gain:0}),O=o(i,{...d,curve:_});return{connectGraph(){a.connect(y),a.connect(void 0===C.inputs?C:C.inputs[0]),y.connect(b,0),y.connect(w,0),y.connect(S,1),y.connect(k,1),C.connect(l),l.connect(void 0===x.inputs?x:x.inputs[0]),l.connect(void 0===T.inputs?T:T.inputs[0]),l.connect(void 0===A.inputs?A:A.inputs[0]),l.connect(void 0===O.inputs?O:O.inputs[0]),x.connect(b.gain),T.connect(w.gain),A.connect(S.gain),O.connect(k.gain),b.connect(p,0,0),S.connect(p,0,0),w.connect(p,0,1),k.connect(p,0,1)},disconnectGraph(){a.disconnect(y),a.disconnect(void 0===C.inputs?C:C.inputs[0]),y.disconnect(b,0),y.disconnect(w,0),y.disconnect(S,1),y.disconnect(k,1),C.disconnect(l),l.disconnect(void 0===x.inputs?x:x.inputs[0]),l.disconnect(void 0===T.inputs?T:T.inputs[0]),l.disconnect(void 0===A.inputs?A:A.inputs[0]),l.disconnect(void 0===O.inputs?O:O.inputs[0]),x.disconnect(b.gain),T.disconnect(w.gain),A.disconnect(S.gain),O.disconnect(k.gain),b.disconnect(p,0,0),S.disconnect(p,0,0),w.disconnect(p,0,1),k.disconnect(p,0,1)}}})(i,p,f,m);throw a()};return(s,o)=>{let{channelCount:u,channelCountMode:h,pan:c,...d}=o;if("max"===h)throw a();let f=i(s,{...d,channelCount:1,channelCountMode:h,numberOfInputs:2}),m=r(s,{...d,channelCount:u,channelCountMode:h,gain:1}),g=r(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:c}),{connectGraph:_,disconnectGraph:v}=p(s,u,m,g,f);Object.defineProperty(g.gain,"defaultValue",{get:()=>0}),Object.defineProperty(g.gain,"maxValue",{get:()=>1}),Object.defineProperty(g.gain,"minValue",{get:()=>-1});let y=!1;return l(ng({get bufferSize(){},get channelCount(){return m.channelCount},set channelCount(n){m.channelCount!==n&&(y&&v(),{connectGraph:_,disconnectGraph:v}=p(s,n,m,g,f),y&&_()),m.channelCount=n},get channelCountMode(){return m.channelCountMode},set channelCountMode(n){if("clamped-max"===n||"max"===n)throw a();m.channelCountMode=n},get channelInterpretation(){return m.channelInterpretation},set channelInterpretation(n){m.channelInterpretation=n},get context(){return m.context},get inputs(){return[m]},get numberOfInputs(){return m.numberOfInputs},get numberOfOutputs(){return m.numberOfOutputs},get pan(){return g.gain},addEventListener:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];return m.addEventListener(s[0],s[1],s[2])},dispatchEvent:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];return m.dispatchEvent(s[0])},removeEventListener:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];return m.removeEventListener(s[0],s[1],s[2])}},f),()=>{_(),y=!0},()=>{v(),y=!1})}})(iu,nm,nv,iO,nx,il),(i,s)=>{let r=s.channelCountMode;if("clamped-max"===r)throw nx();if(void 0===i.createStereoPanner)return I(i,s);let o=i.createStereoPanner();return ne(o,s),ns(o,s,"pan"),Object.defineProperty(o,"channelCountMode",{get:()=>r,set:i=>{if(i!==r)throw nx()}}),o}),iR=((i,s,r,o,a,l)=>{class u extends i{get pan(){return this._pan}constructor(i,u){let h=a(i),c={...nA,...u},d=r(h,c),p=l(h);super(i,!1,d,p?o():null),this._pan=s(this,p,d.pan)}}return u})(nK,ii,iD,()=>{let i=new WeakMap;return{render(s,r){let o=i.get(r);return void 0!==o?Promise.resolve(o):(async(s,r)=>{let o=ec(s),a=tG(o,r);if(!a){let i={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,pan:o.pan.value};o=iD(r,i)}return i.set(r,o),a?await n9(r,s.pan,o.pan):await ie(r,s.pan,o.pan),es(o)?await nW(s,r,o.inputs[0]):await nW(s,r,o),o})(s,r)}}},nU,nG),iP=((i,s,r,o,a,l,u)=>{class h extends i{get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(i){if(null===i)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(i.length<2)throw s();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=i}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(i){this._nativeWaveShaperNode.oversample=i}constructor(i,s){let h=a(i),c={...nk,...s},d=r(h,c);super(i,!0,d,l(h)?o():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=d,u(this,1)}}return h})(nK,e3,iO,()=>{let i=new WeakMap;return{render(s,r){let o=i.get(r);return void 0!==o?Promise.resolve(o):(async(s,r)=>{let o=ec(s);if(!tG(o,r)){let i={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,curve:o.curve,oversample:o.oversample};o=iO(r,i)}return i.set(r,o),es(o)?await nW(s,r,o.inputs[0]):await nW(s,r,o),o})(s,r)}}},nU,nG,io),iN=null!==nL&&nL.isSecureContext,iV=(i,s,r)=>{Object.defineProperties(nL,{currentFrame:{configurable:!0,get:()=>Math.round(i*s)},currentTime:{configurable:!0,get:()=>i}});try{return r()}finally{null!==nL&&(delete nL.currentFrame,delete nL.currentTime)}},ij=new WeakMap,iq=iN?(R=i=>new Promise((s,r)=>{if(null===nL)return void r(SyntaxError());let o=nL.document.head;if(null===o)r(SyntaxError());else{let a=nL.document.createElement("script"),l=new Blob([i],{type:"application/javascript"}),u=URL.createObjectURL(l),h=nL.onerror,c=()=>{nL.onerror=h,URL.revokeObjectURL(u)};nL.onerror=(i,s,o,a,l)=>s===u||s===nL.location.href&&1===o&&1===a?(c(),r(l),!1):null!==h?h(i,s,o,a,l):void 0,a.onerror=()=>{c(),r(SyntaxError())},a.onload=()=>{c(),s()},a.src=u,a.type="module",o.appendChild(a)}}),D=()=>new DOMException("","AbortError"),P=async i=>{try{let s=await fetch(i);if(s.ok)return[await s.text(),s.url]}catch(i){}throw D()},N=i=>{let s=ij.get(i);if(void 0!==s)return s;if(null===nz)throw Error("Missing the native OfflineAudioContext constructor.");return s=new nz(1,1,44100),ij.set(i,s),s},V=new WeakMap,j=new WeakMap,q=async()=>{if(null===n$)return!0;if(null===nz)return!1;let i=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),s=new nz(1,128,44100),r=URL.createObjectURL(i),o=!1,a=!1;try{await s.audioWorklet.addModule(r);let i=new n$(s,"a",{numberOfOutputs:0}),l=s.createOscillator();i.port.onmessage=()=>o=!0,i.onprocessorerror=()=>a=!0,l.connect(i),l.start(0),await s.startRendering(),await new Promise(i=>setTimeout(i))}catch(i){}finally{URL.revokeObjectURL(r)}return o&&!a},a=0,function(i,s){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{credentials:"omit"},o=j.get(i);if(void 0!==o&&o.has(s))return Promise.resolve();let l=V.get(i);if(void 0!==l){let i=l.get(s);if(void 0!==i)return i}let u=nU(i),h=void 0===u.audioWorklet?P(s).then(i=>{let[s,r]=i,[o,a]=tR(s,r);return R("".concat(o,";((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{").concat(a,"\n})})(window,'_AWGS')"))}).then(()=>{let i=nL._AWGS.pop();if(void 0===i)throw SyntaxError();iV(u.currentTime,u.sampleRate,()=>i(class{},void 0,(i,s)=>{if(""===i.trim())throw nx();let r=tO.get(u);if(void 0!==r){if(r.has(i))throw nx();tN(s),tP(s.parameterDescriptors),r.set(i,s)}else tN(s),tP(s.parameterDescriptors),tO.set(u,new Map([[i,s]]))},u.sampleRate,void 0,void 0))}):Promise.all([P(s),Promise.resolve(nq(q,q))]).then(i=>{let[[s,o],l]=i,h=a+1;a=h;let[c,d]=tR(s,o),p=new Blob(["".concat(c,";((AudioWorkletProcessor,registerProcessor)=>{").concat(d,"\n})(").concat(l?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}",",(n,p)=>registerProcessor(n,class extends p{").concat(l?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));","process(i,o,p){").concat(l?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));","return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac").concat(h,"',class extends AudioWorkletProcessor{process(){return !1}})")],{type:"application/javascript; charset=utf-8"}),f=URL.createObjectURL(p);return u.audioWorklet.addModule(f,r).then(()=>{if(nG(u))return u;let i=N(u);return i.audioWorklet.addModule(f,r).then(()=>i)}).then(i=>{if(null===n$)throw SyntaxError();try{new n$(i,"__sac".concat(h))}catch(i){throw SyntaxError()}}).finally(()=>URL.revokeObjectURL(f))});return void 0===l?V.set(i,new Map([[s,h]])):l.set(s,h),h.then(()=>{let r=j.get(i);void 0===r?j.set(i,new Set([s])):r.add(s)}).finally(()=>{let r=V.get(i);void 0!==r&&r.delete(s)}),h}):void 0,iL=(L=()=>new DOMException("","DataCloneError"),F=()=>new DOMException("","EncodingError"),B=new WeakSet,W=i=>nY(i)||nG(i),(i,s)=>{let r=W(i)?i:nU(i);if(B.has(s)){let i=L();return Promise.reject(i)}try{B.add(s)}catch(i){}return nq(e9,()=>e9(r))?r.decodeAudioData(s).then(i=>(eQ(s).catch(()=>{}),nq(tX,()=>tX(i))||n8(i),n1.add(i),i)):new Promise((i,o)=>{let a=async()=>{try{await eQ(s)}catch(i){}},l=i=>{o(i),a()};try{r.decodeAudioData(s,s=>{"function"!=typeof s.copyFromChannel&&(n4(s),tH(s)),n1.add(s),a().then(()=>i(s))},i=>{l(null===i?F():i)})}catch(i){l(i)}})}),iF=((i,s,r,o,a,l,u,h,c,d,p,f,m,g,_,v,y,b,x,w)=>{class T extends _{get audioWorklet(){return this._audioWorklet}createAnalyser(){return new s(this)}createBiquadFilter(){return new a(this)}createBuffer(i,s,o){return new r({length:s,numberOfChannels:i,sampleRate:o})}createBufferSource(){return new o(this)}createChannelMerger(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;return new l(this,{numberOfInputs:i})}createChannelSplitter(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6;return new u(this,{numberOfOutputs:i})}createConstantSource(){return new h(this)}createConvolver(){return new c(this)}createDelay(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new p(this,{maxDelayTime:i})}createDynamicsCompressor(){return new f(this)}createGain(){return new m(this)}createIIRFilter(i,s){return new g(this,{feedback:s,feedforward:i})}createOscillator(){return new v(this)}createPanner(){return new y(this)}createPeriodicWave(i,s){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{disableNormalization:!1};return new b(this,{...r,imag:s,real:i})}createStereoPanner(){return new x(this)}createWaveShaper(){return new w(this)}decodeAudioData(i,s,r){return d(this._nativeContext,i).then(i=>("function"==typeof s&&s(i),i),i=>{throw"function"==typeof r&&r(i),i})}constructor(s,r){super(s,r),this._nativeContext=s,this._audioWorklet=void 0===i?void 0:{addModule:(s,r)=>i(this,s,r)}}}return T})(iq,n0,n6,is,ia,ih,ic,ip,ig,iL,i_,iy,ib,iw,iC,iA,iM,iI,iR,iP),iB=((i,s,r,o)=>{class a extends i{get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}constructor(i,a){let l=r(i),u=s(l,a);if(o(l))throw TypeError();super(i,!0,u,null),this._nativeMediaElementAudioSourceNode=u}}return a})(nK,(i,s)=>i.createMediaElementSource(s.mediaElement),nU,nG),iW=((i,s,r,o)=>{class a extends i{get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}constructor(i,a){let l=r(i);if(o(l))throw TypeError();let u={...e7,...a},h=s(l,u);super(i,!1,h,null),this._nativeMediaStreamAudioDestinationNode=h}}return a})(nK,(i,s)=>{let r=i.createMediaStreamDestination();return ne(r,s),1===r.numberOfOutputs&&Object.defineProperty(r,"numberOfOutputs",{get:()=>0}),r},nU,nG),iU=((i,s,r,o)=>{class a extends i{get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}constructor(i,a){let l=r(i),u=s(l,a);if(o(l))throw TypeError();super(i,!0,u,null),this._nativeMediaStreamAudioSourceNode=u}}return a})(nK,(i,s)=>{let{mediaStream:r}=s,o=r.getAudioTracks();o.sort((i,s)=>i.id<s.id?-1:i.id>s.id?1:0);let a=o.slice(0,1),l=i.createMediaStreamSource(new MediaStream(a));return Object.defineProperty(l,"mediaStream",{value:r}),l},nU,nG),iz=((i,s,r)=>{class o extends i{constructor(i,o){let a=r(i);super(i,!0,s(a,o),null)}}return o})(nK,(i,s)=>{let{mediaStreamTrack:r}=s;if("function"==typeof i.createMediaStreamTrackSource)return i.createMediaStreamTrackSource(r);let o=new MediaStream([r]),a=i.createMediaStreamSource(o);if("audio"!==r.kind)throw e3();if(nG(i))throw TypeError();return a},nU),iG=((i,s,r,o,a,l,u,h,c)=>{class d extends i{get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then(()=>{throw s()}):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then(()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),t5(this)}))}createMediaElementSource(i){return new a(this,{mediaElement:i})}createMediaStreamDestination(){return new l(this)}createMediaStreamSource(i){return new u(this,{mediaStream:i})}createMediaStreamTrackSource(i){return new h(this,{mediaStreamTrack:i})}resume(){return"suspended"===this._state?new Promise((i,s)=>{let r=()=>{this._nativeAudioContext.removeEventListener("statechange",r),"running"===this._nativeAudioContext.state?i():this.resume().then(i,s)};this._nativeAudioContext.addEventListener("statechange",r)}):this._nativeAudioContext.resume().catch(i=>{if(void 0===i||15===i.code)throw s();throw i})}suspend(){return this._nativeAudioContext.suspend().catch(i=>{if(void 0===i)throw s();throw i})}constructor(i={}){let s;if(null===c)throw Error("Missing the native AudioContext constructor.");try{s=new c(i)}catch(i){if(12===i.code&&"sampleRate is not in range"===i.message)throw r();throw i}if(null===s)throw o();if(!t7(i.latencyHint))throw TypeError("The provided value '".concat(i.latencyHint,"' is not a valid enum value of type AudioContextLatencyCategory."));if(void 0!==i.sampleRate&&s.sampleRate!==i.sampleRate)throw r();super(s,2);let{latencyHint:a}=i,{sampleRate:l}=s;if(this._baseLatency="number"==typeof s.baseLatency?s.baseLatency:"balanced"===a?512/l:"interactive"===a||void 0===a?256/l:"playback"===a?1024/l:128*Math.max(2,Math.min(128,Math.round(a*l/128)))/l,this._nativeAudioContext=s,"webkitAudioContext"===c.name?(this._nativeGainNode=s.createGain(),this._nativeOscillatorNode=s.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(s.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===s.state){this._state="suspended";let i=()=>{"suspended"===this._state&&(this._state=null),s.removeEventListener("statechange",i)};s.addEventListener("statechange",i)}}}return d})(iF,e3,nx,()=>new DOMException("","UnknownError"),iB,iW,iU,iz,nH),iX=i=>{let s=iT.get(i);if(void 0===s)throw Error("The context has no set of AudioWorkletNodes.");return s},iZ=function(i,s){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=i[r];if(void 0===a)throw tZ();return e_(s)?a.connect(s,0,o):a.connect(s,0)},iH=function(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return void 0===s?i.forEach(i=>i.disconnect()):"number"==typeof s?e0(tZ,i,s).disconnect():e_(s)?void 0===r?i.forEach(i=>i.disconnect(s)):void 0===o?e0(tZ,i,r).disconnect(s,0):e0(tZ,i,r).disconnect(s,0,o):void 0===r?i.forEach(i=>i.disconnect(s)):e0(tZ,i,r).disconnect(s,0)},iY=new WeakMap,iJ=(U=i=>tV(iY,i),z=(i,s,r,o)=>{var a,l;if(0===o.numberOfInputs&&0===o.numberOfOutputs)throw nx();let u=Array.isArray(o.outputChannelCount)?o.outputChannelCount:Array.from(o.outputChannelCount);if(u.some(i=>i<1))throw nx();if(u.length!==o.numberOfOutputs)throw tZ();if("explicit"!==o.channelCountMode)throw nx();let h=o.channelCount*o.numberOfInputs,c=u.reduce((i,s)=>i+s,0),d=void 0===r.parameterDescriptors?0:r.parameterDescriptors.length;if(h+d>6||c>6)throw nx();let p=new MessageChannel,f=[],m=[];for(let s=0;s<o.numberOfInputs;s+=1)f.push(nv(i,{channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,gain:1})),m.push(nm(i,{channelCount:o.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:o.channelCount}));let g=[];if(void 0!==r.parameterDescriptors)for(let{defaultValue:s,maxValue:a,minValue:l,name:u}of r.parameterDescriptors){let r=id(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==o.parameterData[u]?o.parameterData[u]:void 0===s?0:s});Object.defineProperties(r.offset,{defaultValue:{get:()=>void 0===s?0:s},maxValue:{get:()=>void 0===a?34028234663852886e22:a},minValue:{get:()=>void 0===l?-34028234663852886e22:l}}),g.push(r)}let _=iu(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,h+d)}),v=nu(s,i.sampleRate),y=nb(i,v,h+d,Math.max(1,c)),b=nm(i,{channelCount:Math.max(1,c),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,c)}),x=[];for(let s=0;s<o.numberOfOutputs;s+=1)x.push(iu(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:u[s]}));for(let i=0;i<o.numberOfInputs;i+=1){f[i].connect(m[i]);for(let s=0;s<o.channelCount;s+=1)m[i].connect(_,s,i*o.channelCount+s)}let w=new eF(void 0===r.parameterDescriptors?[]:r.parameterDescriptors.map((i,s)=>{let{name:r}=i,o=g[s];return o.connect(_,0,h+s),o.start(0),[r,o.offset]}));_.connect(y);let T=o.channelInterpretation,C=null,S=0===o.numberOfOutputs?[y]:x,A={get bufferSize(){return v},get channelCount(){return o.channelCount},set channelCount(e){throw e3()},get channelCountMode(){return o.channelCountMode},set channelCountMode(e){throw e3()},get channelInterpretation(){return T},set channelInterpretation(e){for(let i of f)i.channelInterpretation=e;T=e},get context(){return y.context},get inputs(){return f},get numberOfInputs(){return o.numberOfInputs},get numberOfOutputs(){return o.numberOfOutputs},get onprocessorerror(){return C},set onprocessorerror(e){"function"==typeof C&&A.removeEventListener("processorerror",C),"function"==typeof(C="function"==typeof e?e:null)&&A.addEventListener("processorerror",C)},get parameters(){return w},get port(){return p.port2},addEventListener:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];return y.addEventListener(s[0],s[1],s[2])},connect:iZ.bind(null,S),disconnect:iH.bind(null,S),dispatchEvent:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];return y.dispatchEvent(s[0])},removeEventListener:function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];return y.removeEventListener(s[0],s[1],s[2])}},k=new Map;p.port1.addEventListener=(a=p.port1.addEventListener,function(){for(var s=arguments.length,r=Array(s),o=0;o<s;o++)r[o]=arguments[o];if("message"===r[0]){let s="function"==typeof r[1]?r[1]:"object"==typeof r[1]&&null!==r[1]&&"function"==typeof r[1].handleEvent?r[1].handleEvent:null;if(null!==s){let o=k.get(r[1]);void 0!==o?r[1]=o:(r[1]=r=>{iV(i.currentTime,i.sampleRate,()=>s(r))},k.set(s,r[1]))}}return a.call(p.port1,r[0],r[1],r[2])}),p.port1.removeEventListener=(l=p.port1.removeEventListener,function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];if("message"===s[0]){let i=k.get(s[1]);void 0!==i&&(k.delete(s[1]),s[1]=i)}return l.call(p.port1,s[0],s[1],s[2])});let O=null;Object.defineProperty(p.port1,"onmessage",{get:()=>O,set:i=>{"function"==typeof O&&p.port1.removeEventListener("message",O),"function"==typeof(O="function"==typeof i?i:null)&&(p.port1.addEventListener("message",O),p.port1.start())}}),r.prototype.port=p.port1;let E=null;nd(i,A,r,o).then(i=>E=i);let M=ez(o.numberOfInputs,o.channelCount),I=ez(o.numberOfOutputs,u),D=void 0===r.parameterDescriptors?[]:r.parameterDescriptors.reduce((i,s)=>{let{name:r}=s;return{...i,[r]:new Float32Array(128)}},{}),R=!0,P=()=>{o.numberOfOutputs>0&&y.disconnect(b);for(let i=0,s=0;i<o.numberOfOutputs;i+=1){let r=x[i];for(let o=0;o<u[i];o+=1)b.disconnect(r,s+o,o);s+=u[i]}},N=new Map;y.onaudioprocess=s=>{let{inputBuffer:a,outputBuffer:l}=s;if(null!==E){let s=U(A);for(let c=0;c<v;c+=128){for(let i=0;i<o.numberOfInputs;i+=1)for(let s=0;s<o.channelCount;s+=1)eW(a,M[i],s,s,c);void 0!==r.parameterDescriptors&&r.parameterDescriptors.forEach((i,s)=>{let{name:r}=i;eW(a,D,r,h+s,c)});for(let i=0;i<o.numberOfInputs;i+=1)for(let s=0;s<u[i];s+=1)0===I[i][s].byteLength&&(I[i][s]=new Float32Array(128));try{let r=M.map((i,r)=>{if(s[r].size>0)return N.set(r,v/128),i;let o=N.get(r);return void 0===o?[]:(i.every(i=>i.every(i=>0===i))&&(1===o?N.delete(r):N.set(r,o-1)),i)}),a=iV(i.currentTime+c/i.sampleRate,i.sampleRate,()=>E.process(r,I,D));R=a;for(let i=0,s=0;i<o.numberOfOutputs;i+=1){for(let r=0;r<u[i];r+=1)eU(l,I[i],r,s+r,c);s+=u[i]}}catch(i){R=!1,A.dispatchEvent(new ErrorEvent("processorerror",{colno:i.colno,filename:i.filename,lineno:i.lineno,message:i.message}))}if(!R){for(let i=0;i<o.numberOfInputs;i+=1){f[i].disconnect(m[i]);for(let s=0;s<o.channelCount;s+=1)m[c].disconnect(_,s,i*o.channelCount+s)}if(void 0!==r.parameterDescriptors){let i=r.parameterDescriptors.length;for(let s=0;s<i;s+=1){let i=g[s];i.disconnect(_,0,h+s),i.stop()}}_.disconnect(y),y.onaudioprocess=null,V?P():L();break}}}};let V=!1,j=nv(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),q=()=>y.connect(j).connect(i.destination),L=()=>{y.disconnect(j),j.disconnect()};return q(),il(A,()=>{if(R){L(),o.numberOfOutputs>0&&y.connect(b);for(let i=0,s=0;i<o.numberOfOutputs;i+=1){let r=x[i];for(let o=0;o<u[i];o+=1)b.connect(r,s+o,o);s+=u[i]}}V=!0},()=>{R&&(q(),P()),V=!1})},(i,s,r,o,a,l)=>{var u,h;if(null!==r)try{let s=new r(i,o,l),a=new Map,c=null;if(Object.defineProperties(s,{channelCount:{get:()=>l.channelCount,set:()=>{throw e3()}},channelCountMode:{get:()=>"explicit",set:()=>{throw e3()}},onprocessorerror:{get:()=>c,set:i=>{"function"==typeof c&&s.removeEventListener("processorerror",c),c="function"==typeof i?i:null,"function"==typeof c&&s.addEventListener("processorerror",c)}}}),s.addEventListener=(h=s.addEventListener,function(){for(var i=arguments.length,r=Array(i),o=0;o<i;o++)r[o]=arguments[o];if("processorerror"===r[0]){let i="function"==typeof r[1]?r[1]:"object"==typeof r[1]&&null!==r[1]&&"function"==typeof r[1].handleEvent?r[1].handleEvent:null;if(null!==i){let s=a.get(r[1]);void 0!==s?r[1]=s:(r[1]=s=>{"error"===s.type?(Object.defineProperties(s,{type:{value:"processorerror"}}),i(s)):i(new ErrorEvent(r[0],{...s}))},a.set(i,r[1]))}}return h.call(s,"error",r[1],r[2]),h.call(s,...r)}),s.removeEventListener=(u=s.removeEventListener,function(){for(var i=arguments.length,r=Array(i),o=0;o<i;o++)r[o]=arguments[o];if("processorerror"===r[0]){let i=a.get(r[1]);void 0!==i&&(a.delete(r[1]),r[1]=i)}return u.call(s,"error",r[1],r[2]),u.call(s,r[0],r[1],r[2])}),0!==l.numberOfOutputs){let r=nv(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return s.connect(r).connect(i.destination),il(s,()=>r.disconnect(),()=>r.connect(i.destination))}return s}catch(i){if(11===i.code)throw nx();throw i}if(void 0===a)throw nx();return nl(l),z(i,s,a,l)}),iQ=(G=(i,s)=>{iX(i).delete(s)},(i,s,r)=>{let o=new WeakMap,a=null,l=async(l,u)=>{let h=ec(l),c=null,d=tG(h,u),p=Array.isArray(s.outputChannelCount)?s.outputChannelCount:Array.from(s.outputChannelCount);if(null===n$){let i=p.reduce((i,s)=>i+s,0),r=nm(u,{channelCount:Math.max(1,i),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,i)}),o=[];for(let i=0;i<l.numberOfOutputs;i+=1)o.push(iu(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:p[i]}));let a=nv(u,{channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});a.connect=iZ.bind(null,o),a.disconnect=iH.bind(null,o),c=[r,o,a]}else d||(h=new n$(u,i));if(o.set(u,null===c?h:c[2]),null!==c){if(null===a){if(void 0===r)throw Error("Missing the processor constructor.");if(null===nz)throw Error("Missing the native OfflineAudioContext constructor.");let i=l.channelCount*l.numberOfInputs,o=void 0===r.parameterDescriptors?0:r.parameterDescriptors.length,h=i+o,c=async()=>{let r=new nz(h,128*Math.ceil(l.context.length/128),u.sampleRate),a=[],c=[];for(let i=0;i<s.numberOfInputs;i+=1)a.push(nv(r,{channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1})),c.push(nm(r,{channelCount:s.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:s.channelCount}));let d=await Promise.all(Array.from(l.parameters.values()).map(async i=>{let s=id(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:i.value});return await ie(r,i,s.offset),s})),p=iu(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,i+o)});for(let i=0;i<s.numberOfInputs;i+=1){a[i].connect(c[i]);for(let r=0;r<s.channelCount;r+=1)c[i].connect(p,r,i*s.channelCount+r)}for(let[s,r]of d.entries())r.connect(p,0,i+s),r.start(0);return p.connect(r.destination),await Promise.all(a.map(i=>nW(l,r,i))),ix(r)};a=(async(i,s,r,o,a,l,u)=>{let h=null===s?128*Math.ceil(i.context.length/128):s.length,c=o.channelCount*o.numberOfInputs,d=a.reduce((i,s)=>i+s,0),p=0===d?null:r.createBuffer(d,h,r.sampleRate);if(void 0===l)throw Error("Missing the processor constructor.");let f=t4(i),m=await eG(r,i),g=ez(o.numberOfInputs,o.channelCount),_=ez(o.numberOfOutputs,a),v=Array.from(i.parameters.keys()).reduce((i,s)=>({...i,[s]:new Float32Array(128)}),{});for(let d=0;d<h;d+=128){if(o.numberOfInputs>0&&null!==s)for(let i=0;i<o.numberOfInputs;i+=1)for(let r=0;r<o.channelCount;r+=1)eW(s,g[i],r,r,d);void 0!==l.parameterDescriptors&&null!==s&&l.parameterDescriptors.forEach((i,r)=>{let{name:o}=i;eW(s,v,o,c+r,d)});for(let i=0;i<o.numberOfInputs;i+=1)for(let s=0;s<a[i];s+=1)0===_[i][s].byteLength&&(_[i][s]=new Float32Array(128));try{let i=g.map((i,s)=>0===f.activeInputs[s].size?[]:i),s=u(d/r.sampleRate,r.sampleRate,()=>m.process(i,_,v));if(null!==p)for(let i=0,s=0;i<o.numberOfOutputs;i+=1){for(let r=0;r<a[i];r+=1)eU(p,_[i],r,s+r,d);s+=a[i]}if(!s)break}catch(s){i.dispatchEvent(new ErrorEvent("processorerror",{colno:s.colno,filename:s.filename,lineno:s.lineno,message:s.message}));break}}return p})(l,0===h?null:await c(),u,s,p,r,iV)}let i=await a,o=it(u,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[h,d,f]=c;null!==i&&(o.buffer=i,o.start(0)),o.connect(h);for(let i=0,s=0;i<l.numberOfOutputs;i+=1){let r=d[i];for(let o=0;o<p[i];o+=1)h.connect(r,s+o,o);s+=p[i]}return f}if(d)for(let[i,s]of l.parameters.entries())await n9(u,s,h.parameters.get(i));else for(let[i,s]of l.parameters.entries())await ie(u,s,h.parameters.get(i));return await nW(l,u,h),h};return{render(i,s){G(s,i);let r=o.get(s);return void 0!==r?Promise.resolve(r):l(i,s)}}}),i$=iN?((i,s,r,o,a,l,u,h,c,d,p,f,m,g)=>{class _ extends s{get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(i){let s="function"==typeof i?g(this,i):null;this._nativeAudioWorkletNode.onprocessorerror=s;let r=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==r&&r===s?i:r}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}constructor(s,g,_){var v;let y=h(s),b=c(y),x=p({...eB,..._});m(x);let w=tO.get(y),T=null==w?void 0:w.get(g),C=b||"closed"!==y.state?y:null!==(v=u(y))&&void 0!==v?v:y,S=a(C,b?null:s.baseLatency,d,g,T,x);super(s,!0,S,b?o(g,x,T):null);let A=[];S.parameters.forEach((i,s)=>{let o=r(this,b,i);A.push([s,o])}),this._nativeAudioWorkletNode=S,this._onprocessorerror=null,this._parameters=new eF(A),b&&i(y,this);let{activeInputs:k}=l(this);f(S,k)}}return _})((i,s)=>{iX(i).add(s)},nK,ii,iQ,iJ,t4,i=>ij.get(i),nU,nG,n$,i=>({...i,outputChannelCount:void 0!==i.outputChannelCount?i.outputChannelCount:1===i.numberOfInputs&&1===i.numberOfOutputs?[i.channelCount]:Array.from({length:i.numberOfOutputs},()=>1)}),(i,s)=>{iY.set(i,s)},i=>{let{port1:s,port2:r}=new MessageChannel;try{s.postMessage(i)}finally{s.close(),r.close()}},nV):void 0,iK=((i,s,r,o,a)=>{class l extends i{get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(r()):(this._state="running",a(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,t5(this)}))}_waitForThePromiseToSettle(i){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(i):setTimeout(()=>this._waitForThePromiseToSettle(i))}constructor(i,r,a){let l;if("number"==typeof i&&void 0!==r&&void 0!==a)l={length:r,numberOfChannels:i,sampleRate:a};else{if("object"!=typeof i)throw Error("The given parameters are not valid.");l=i}let{length:u,numberOfChannels:h,sampleRate:c}={...nw,...l},d=o(h,u,c);s(e9,()=>e9(d))||d.addEventListener("statechange",(()=>{let i=0,s=r=>{"running"===this._state&&(i>0?(d.removeEventListener("statechange",s),r.stopImmediatePropagation(),this._waitForThePromiseToSettle(r)):i+=1)};return s})()),super(d,h),this._length=u,this._nativeOfflineAudioContext=d,this._state=null}}return l})(iF,nq,e3,(i,s,r)=>{if(null===nz)throw Error("Missing the native OfflineAudioContext constructor.");try{return new nz(i,s,r)}catch(i){if("SyntaxError"===i.name)throw nx();throw i}},(i,s)=>nB(i).render(i,s).then(()=>Promise.all(Array.from(iX(s)).map(i=>nB(i).render(i,s)))).then(()=>ix(s)).then(i=>("function"!=typeof i.copyFromChannel?(n4(i),tH(i)):nq(tX,()=>tX(i))||n8(i),n1.add(i),i))),i0=i=>{let s=tS.get(i);return nY(s)||nY(i)},i1=i=>tw.has(i)||nJ(i),i2=i=>tC.has(i)||nQ(i),i3=i=>{let s=tS.get(i);return nG(s)||nG(i)};function i4(i){return void 0===i}function i8(i){return void 0!==i}function i6(i){return"number"==typeof i}function i5(i){return"[object Object]"===Object.prototype.toString.call(i)&&i.constructor===Object}function i7(i){return Array.isArray(i)}function i9(i){return"string"==typeof i}function st(i){return i9(i)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(i)}function se(i,s){if(!i)throw Error(s)}function sn(i,s){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;if(!(s<=i&&i<=r))throw RangeError("Value must be within [".concat(s,", ").concat(r,"], got: ").concat(i))}function si(i){i.isOffline||"running"===i.state||sa('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let ss=!1,sr=!1,so=console;function sa(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];so.warn(...s)}let sl="object"==typeof self?self:null,su=sl&&(sl.hasOwnProperty("AudioContext")||sl.hasOwnProperty("webkitAudioContext"));class sh{_createWorker(){let i=new Blob(["\n			// the initial timeout time\n			let timeoutTime =  ".concat((1e3*this._updateInterval).toFixed(1),";\n			// onmessage callback\n			self.onmessage = function(msg){\n				timeoutTime = parseInt(msg.data);\n			};\n			// the tick function which posts a message\n			// and schedules a new tick\n			function tick(){\n				setTimeout(tick, timeoutTime);\n				self.postMessage('tick');\n			}\n			// call tick initially\n			tick();\n			")],{type:"text/javascript"}),s=URL.createObjectURL(i),r=new Worker(s);r.onmessage=this._callback.bind(this),this._worker=r}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(i){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&clearTimeout(this._timeout),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(i){var s;this._updateInterval=Math.max(i,this._minimumUpdateInterval),"worker"===this._type&&(null===(s=this._worker)||void 0===s||s.postMessage(1e3*this._updateInterval))}get type(){return this._type}set type(i){this._disposeClock(),this._type=i,this._createClock()}dispose(){this._disposeClock()}constructor(i,s,r,o){this._callback=i,this._type=s,this._minimumUpdateInterval=Math.max(128/(o||44100),.001),this.updateInterval=r,this._createClock()}}function sc(i){for(var s,r=arguments.length,o=Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];if(!o.length)return i;let l=o.shift();if(i5(i)&&i5(l))for(let r in l)(s=l[r],"value"===r||i2(s)||i1(s)||s instanceof n6)?i[r]=l[r]:i5(l[r])?(i[r]||Object.assign(i,{[r]:{}}),sc(i[r],l[r])):Object.assign(i,{[r]:l[r]});return sc(i,...o)}function sd(i,s){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3?arguments[3]:void 0,a={},l=Array.from(s);if(i5(l[0])&&o&&!Reflect.has(l[0],o)&&(Object.keys(l[0]).some(s=>Reflect.has(i,s))||(sc(a,{[o]:l[0]}),r.splice(r.indexOf(o),1),l.shift())),1===l.length&&i5(l[0]))sc(a,l[0]);else for(let i=0;i<r.length;i++)i8(l[i])&&(a[r[i]]=l[i]);return sc(i,a)}function sp(i,s){return i4(i)?s:i}function sf(i,s){return s.forEach(s=>{Reflect.has(i,s)&&delete i[s]}),i}/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2019 Yotam Mann
 */class sm{static getDefaults(){return{}}log(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];(this.debug||sl&&this.toString()===sl.TONE_DEBUG_CLASS)&&function(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];so.log(...s)}(this,...s)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}constructor(){this.debug=!1,this._wasDisposed=!1}}function sg(i,s){return i>s+1e-6}function s_(i,s){return sg(i,s)||sy(i,s)}function sv(i,s){return i+1e-6<s}function sy(i,s){return 1e-6>Math.abs(i-s)}sm.version=t_;class sb extends sm{static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(i){if(se(Reflect.has(i,"time"),"Timeline: events must have a time attribute"),i.time=i.time.valueOf(),this.increasing&&this.length){let s=this._timeline[this.length-1];se(s_(i.time,s.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(i)}else{let s=this._search(i.time);this._timeline.splice(s+1,0,i)}if(this.length>this.memory){let i=this.length-this.memory;this._timeline.splice(0,i)}return this}remove(i){let s=this._timeline.indexOf(i);return -1!==s&&this._timeline.splice(s,1),this}get(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time",r=this._search(i,s);return -1!==r?this._timeline[r]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time",r=this._search(i,s);return r+1<this._timeline.length?this._timeline[r+1]:null}getBefore(i){let s=this._timeline.length;if(s>0&&this._timeline[s-1].time<i)return this._timeline[s-1];let r=this._search(i);return r-1>=0?this._timeline[r-1]:null}cancel(i){if(this._timeline.length>1){let s=this._search(i);if(s>=0){if(sy(this._timeline[s].time,i)){for(let r=s;r>=0&&sy(this._timeline[r].time,i);r--)s=r;this._timeline=this._timeline.slice(0,s)}else this._timeline=this._timeline.slice(0,s+1)}else this._timeline=[]}else 1===this._timeline.length&&s_(this._timeline[0].time,i)&&(this._timeline=[]);return this}cancelBefore(i){let s=this._search(i);return s>=0&&(this._timeline=this._timeline.slice(s+1)),this}previousEvent(i){let s=this._timeline.indexOf(i);return s>0?this._timeline[s-1]:null}_search(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time";if(0===this._timeline.length)return -1;let r=0,o=this._timeline.length,a=o;if(o>0&&this._timeline[o-1][s]<=i)return o-1;for(;r<a;){let o=Math.floor(r+(a-r)/2),l=this._timeline[o],u=this._timeline[o+1];if(sy(l[s],i)){for(let r=o;r<this._timeline.length;r++){let a=this._timeline[r];if(!sy(a[s],i))break;o=r}return o}if(sv(l[s],i)&&sg(u[s],i))return o;sg(l[s],i)?a=o:r=o+1}return -1}_iterate(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._timeline.length-1;this._timeline.slice(s,r+1).forEach(i)}forEach(i){return this._iterate(i),this}forEachBefore(i,s){let r=this._search(i);return -1!==r&&this._iterate(s,0,r),this}forEachAfter(i,s){let r=this._search(i);return this._iterate(s,r+1),this}forEachBetween(i,s,r){let o=this._search(i),a=this._search(s);return -1!==o&&-1!==a?(this._timeline[o].time!==i&&(o+=1),this._timeline[a].time===s&&(a-=1),this._iterate(r,o,a)):-1===o&&this._iterate(r,0,a),this}forEachFrom(i,s){let r=this._search(i);for(;r>=0&&this._timeline[r].time>=i;)r--;return this._iterate(s,r+1),this}forEachAtTime(i,s){let r=this._search(i);if(-1!==r&&sy(this._timeline[r].time,i)){let o=r;for(let s=r;s>=0&&sy(this._timeline[s].time,i);s--)o=s;this._iterate(i=>{s(i)},o,r)}return this}dispose(){return super.dispose(),this._timeline=[],this}constructor(){super(),this.name="Timeline",this._timeline=[];let i=sd(sb.getDefaults(),arguments,["memory"]);this.memory=i.memory,this.increasing=i.increasing}}let sx=[];function sw(i){sx.push(i)}let sT=[];function sC(i){sT.push(i)}class sS extends sm{on(i,s){return i.split(/\W+/).forEach(i=>{i4(this._events)&&(this._events={}),this._events.hasOwnProperty(i)||(this._events[i]=[]),this._events[i].push(s)}),this}once(i,s){var r=this;let o=function(){for(var a=arguments.length,l=Array(a),u=0;u<a;u++)l[u]=arguments[u];s(...l),r.off(i,o)};return this.on(i,o),this}off(i,s){return i.split(/\W+/).forEach(i=>{if(i4(this._events)&&(this._events={}),this._events.hasOwnProperty(i)){if(i4(s))this._events[i]=[];else{let r=this._events[i];for(let i=r.length-1;i>=0;i--)r[i]===s&&r.splice(i,1)}}}),this}emit(i){for(var s=arguments.length,r=Array(s>1?s-1:0),o=1;o<s;o++)r[o-1]=arguments[o];if(this._events&&this._events.hasOwnProperty(i)){let s=this._events[i].slice(0);for(let i=0,o=s.length;i<o;i++)s[i].apply(this,r)}return this}static mixin(i){["on","once","off","emit"].forEach(s=>{let r=Object.getOwnPropertyDescriptor(sS.prototype,s);Object.defineProperty(i.prototype,s,r)})}dispose(){return super.dispose(),this._events=void 0,this}constructor(){super(...arguments),this.name="Emitter"}}class sA extends sS{toJSON(){return{}}constructor(){super(...arguments),this.isOffline=!1}}class sk extends sA{static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){var i;return this._initialized||(i=this,sx.forEach(s=>s(i)),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(i,s,r){return this._context.createBuffer(i,s,r)}createChannelMerger(i){return this._context.createChannelMerger(i)}createChannelSplitter(i){return this._context.createChannelSplitter(i)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(i){return this._context.createDelay(i)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(i,s){return this._context.createIIRFilter(i,s)}createPanner(){return this._context.createPanner()}createPeriodicWave(i,s,r){return this._context.createPeriodicWave(i,s,r)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(i){return se(i0(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(i)}createMediaElementSource(i){return se(i0(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(i)}createMediaStreamDestination(){return se(i0(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(i){return this._context.decodeAudioData(i)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(i){se(!this._initialized,"The listener cannot be set after initialization."),this._listener=i}get transport(){return this.initialize(),this._transport}set transport(i){se(!this._initialized,"The transport cannot be set after initialization."),this._transport=i}get draw(){return this.initialize(),this._draw}set draw(i){se(!this._initialized,"Draw cannot be set after initialization."),this._draw=i}get destination(){return this.initialize(),this._destination}set destination(i){se(!this._initialized,"The destination cannot be set after initialization."),this._destination=i}createAudioWorkletNode(i,s){var r;return r=this.rawContext,se(i8(i$),"This node only works in a secure context (https or localhost)"),new i$(r,i,s)}addAudioWorkletModule(i){return K(this,void 0,void 0,function*(){se(i8(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletPromise||(this._workletPromise=this.rawContext.audioWorklet.addModule(i)),yield this._workletPromise})}workletsAreReady(){return K(this,void 0,void 0,function*(){(yield this._workletPromise)?this._workletPromise:Promise.resolve()})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(i){this._ticker.updateInterval=i}get clockSource(){return this._ticker.type}set clockSource(i){this._ticker.type=i}get lookAhead(){return this._lookAhead}set lookAhead(i){this._lookAhead=i,this.updateInterval=i?i/2:.01}get latencyHint(){return this._latencyHint}get rawContext(){return this._context}now(){return this._context.currentTime+this._lookAhead}immediate(){return this._context.currentTime}resume(){return i0(this._context)?this._context.resume():Promise.resolve()}close(){return K(this,void 0,void 0,function*(){var i;i0(this._context)&&"closed"!==this.state&&!this._closeStarted&&(this._closeStarted=!0,yield this._context.close()),this._initialized&&(i=this,sT.forEach(s=>s(i)))})}getConstant(i){if(this._constants.has(i))return this._constants.get(i);{let s=this._context.createBuffer(1,128,this._context.sampleRate),r=s.getChannelData(0);for(let s=0;s<r.length;s++)r[s]=i;let o=this._context.createBufferSource();return o.channelCount=1,o.channelCountMode="explicit",o.buffer=s,o.loop=!0,o.start(0),this._constants.set(i,o),o}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(i=>this._constants[i].disconnect()),this.close(),this}_timeoutLoop(){let i=this.now(),s=this._timeouts.peek();for(;this._timeouts.length&&s&&s.time<=i;)s.callback(),this._timeouts.shift(),s=this._timeouts.peek()}setTimeout(i,s){this._timeoutIds++;let r=this.now();return this._timeouts.add({callback:i,id:this._timeoutIds,time:r+s}),this._timeoutIds}clearTimeout(i){return this._timeouts.forEach(s=>{s.id===i&&this._timeouts.remove(s)}),this}clearInterval(i){return this.clearTimeout(i)}setInterval(i,s){let r=++this._timeoutIds,o=()=>{let a=this.now();this._timeouts.add({callback:()=>{i(),o()},id:r,time:a+s})};return o(),r}constructor(){var i,s;super(),this.name="Context",this._constants=new Map,this._timeouts=new sb,this._timeoutIds=0,this._initialized=!1,this._closeStarted=!1,this.isOffline=!1,this._workletPromise=null;let r=sd(sk.getDefaults(),arguments,["context"]);r.context?(this._context=r.context,this._latencyHint=(null===(i=arguments[0])||void 0===i?void 0:i.latencyHint)||""):(this._context=new iG({latencyHint:r.latencyHint}),this._latencyHint=r.latencyHint),this._ticker=new sh(this.emit.bind(this,"tick"),r.clockSource,r.updateInterval,this._context.sampleRate),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this[(null===(s=arguments[0])||void 0===s?void 0:s.hasOwnProperty("updateInterval"))?"_lookAhead":"lookAhead"]=r.lookAhead}}class sO extends sA{createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(i,s,r){return{}}createChannelMerger(i){return{}}createChannelSplitter(i){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(i){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(i,s){return{}}createPanner(){return{}}createPeriodicWave(i,s,r){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(i){return{}}createMediaElementSource(i){return{}}createMediaStreamDestination(){return{}}decodeAudioData(i){return Promise.resolve({})}createAudioWorkletNode(i,s){return{}}get rawContext(){return{}}addAudioWorkletModule(i){return K(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(i,s){return 0}clearTimeout(i){return this}setInterval(i,s){return 0}clearInterval(i){return this}getConstant(i){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(i){}get destination(){return{}}set destination(i){}now(){return 0}immediate(){return 0}constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}}function sE(i,s){i7(s)?s.forEach(s=>sE(i,s)):Object.defineProperty(i,s,{enumerable:!0,writable:!1})}let sM=()=>{};class sI extends sm{static getDefaults(){return{onerror:sM,onload:sM,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:sN().sampleRate}set(i){return i instanceof sI?i.loaded?this._buffer=i.get():i.onload=()=>{this.set(i),this.onload(this)}:this._buffer=i,this._reversed&&this._reverse(),this}get(){return this._buffer}load(i){return K(this,void 0,void 0,function*(){let s=sI.load(i).then(i=>{this.set(i),this.onload(this)});sI.downloads.push(s);try{yield s}finally{let i=sI.downloads.indexOf(s);sI.downloads.splice(i,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(i){let s=i7(i)&&i[0].length>0,r=s?i.length:1,o=s?i[0].length:i.length,a=sN(),l=a.createBuffer(r,o,a.sampleRate),u=s||1!==r?i:[i];for(let i=0;i<r;i++)l.copyToChannel(u[i],i);return this._buffer=l,this}toMono(i){if(i6(i))this.fromArray(this.toArray(i));else{let i=new Float32Array(this.length),s=this.numberOfChannels;for(let r=0;r<s;r++){let s=this.toArray(r);for(let r=0;r<s.length;r++)i[r]+=s[r]}i=i.map(i=>i/s),this.fromArray(i)}return this}toArray(i){if(i6(i))return this.getChannelData(i);if(1===this.numberOfChannels)return this.toArray(0);{let i=[];for(let s=0;s<this.numberOfChannels;s++)i[s]=this.getChannelData(s);return i}}getChannelData(i){return this._buffer?this._buffer.getChannelData(i):new Float32Array(0)}slice(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.duration;se(this.loaded,"Buffer is not loaded");let r=Math.floor(i*this.sampleRate),o=Math.floor(s*this.sampleRate);se(r<o,"The start time must be less than the end time");let a=sN().createBuffer(this.numberOfChannels,o-r,this.sampleRate);for(let i=0;i<this.numberOfChannels;i++)a.copyToChannel(this.getChannelData(i).subarray(r,o),i);return new sI(a)}_reverse(){if(this.loaded)for(let i=0;i<this.numberOfChannels;i++)this.getChannelData(i).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(i){this._reversed!==i&&(this._reversed=i,this._reverse())}static fromArray(i){return(new sI).fromArray(i)}static fromUrl(i){return K(this,void 0,void 0,function*(){let s=new sI;return yield s.load(i)})}static load(i){return K(this,void 0,void 0,function*(){let s=i.match(/\[([^\]\[]+\|.+)\]$/);if(s){let r=s[1].split("|"),o=r[0];for(let i of r)if(sI.supportsType(i)){o=i;break}i=i.replace(s[0],o)}let r=""===sI.baseUrl||sI.baseUrl.endsWith("/")?sI.baseUrl:sI.baseUrl+"/",o=document.createElement("a");o.href=r+i,o.pathname=(o.pathname+o.hash).split("/").map(encodeURIComponent).join("/");let a=yield fetch(o.href);if(!a.ok)throw Error("could not load url: ".concat(i));let l=yield a.arrayBuffer();return yield sN().decodeAudioData(l)})}static supportsType(i){let s=i.split("."),r=s[s.length-1];return""!==document.createElement("audio").canPlayType("audio/"+r)}static loaded(){return K(this,void 0,void 0,function*(){for(yield Promise.resolve();sI.downloads.length;)yield sI.downloads[0]})}constructor(){super(),this.name="ToneAudioBuffer",this.onload=sM;let i=sd(sI.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=i.reverse,this.onload=i.onload,i9(i.url)?this.load(i.url).catch(i.onerror):i.url&&this.set(i.url)}}sI.baseUrl="",sI.downloads=[];class sD extends sk{now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(i){return K(this,void 0,void 0,function*(){let s=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,s++;let r=Math.floor(this.sampleRate/128);i&&s%r==0&&(yield new Promise(i=>setTimeout(i,1)))}})}render(){let i=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return K(this,void 0,void 0,function*(){yield this.workletsAreReady(),yield this._renderClock(i);let s=yield this._context.startRendering();return new sI(s)})}close(){return Promise.resolve()}constructor(){var i,s,r,o,a,l;super({clockSource:"offline",context:(i=arguments[0],i3(i))?arguments[0]:(s=arguments[0],r=arguments[1]*arguments[2],o=arguments[2],new iK(s,r,o)),lookAhead:0,updateInterval:(a=arguments[0],i3(a))?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,l=arguments[0],this._duration=i3(l)?arguments[0].length/arguments[0].sampleRate:arguments[1]}}let sR=new sO,sP=sR;function sN(){return sP===sR&&su&&sV(new sk),sP}function sV(i){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];s&&sP.dispose(),sP=i0(i)?new sk(i):i3(i)?new sD(i):i}function sj(){return sP.resume()}function sq(i){return Math.pow(2,i/12)}sl&&!sl.TONE_SILENCE_LOGGING&&console.log("%c".concat(" * Tone.js v".concat(t_," * ")),"background: #000; color: #fff");let sL=440;function sF(i){return Math.round(sB(i))}function sB(i){return 69+12*Math.log2(i/sL)}class sW extends sm{_getExpressions(){return{hz:{method:i=>this._frequencyToUnits(parseFloat(i)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:i=>this._ticksToUnits(parseInt(i,10)),regexp:/^(\d+)i$/i},m:{method:i=>this._beatsToUnits(parseInt(i,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(i,s)=>{let r=parseInt(i,10),o="."===s?1.5:1;return 1===r?this._beatsToUnits(this._getTimeSignature())*o:this._beatsToUnits(4/r)*o},regexp:/^(\d+)n(\.?)$/i},number:{method:i=>this._expressions[this.defaultUnits].method.call(this,i),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:i=>this._secondsToUnits(parseFloat(i)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:i=>parseInt(i,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:i=>{let s=parseInt(i,10);return this._beatsToUnits(8/(3*Math.floor(s)))},regexp:/^(\d+)t$/i},tr:{method:(i,s,r)=>{let o=0;return i&&"0"!==i&&(o+=this._beatsToUnits(this._getTimeSignature()*parseFloat(i))),s&&"0"!==s&&(o+=this._beatsToUnits(parseFloat(s))),r&&"0"!==r&&(o+=this._beatsToUnits(parseFloat(r)/4)),o},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof sW&&this.fromType(this._val),i4(this._val))return this._noArg();if(i9(this._val)&&i4(this._units)){for(let i in this._expressions)if(this._expressions[i].regexp.test(this._val.trim())){this._units=i;break}}else if(i5(this._val)){let i=0;for(let s in this._val)if(i8(this._val[s])){let r=this._val[s];i+=new this.constructor(this.context,s).valueOf()*r}return i}if(i8(this._units)){let i=this._expressions[this._units],s=this._val.toString().trim().match(i.regexp);return s?i.method.apply(this,s.slice(1)):i.method.call(this,this._val)}return i9(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(i){return 1/i}_beatsToUnits(i){return 60/this._getBpm()*i}_secondsToUnits(i){return i}_ticksToUnits(i){return i*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(i){switch(this._units=void 0,this.defaultUnits){case"s":this._val=i.toSeconds();break;case"i":this._val=i.toTicks();break;case"hz":this._val=i.toFrequency();break;case"midi":this._val=i.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}constructor(i,s,r){super(),this.defaultUnits="s",this._val=s,this._units=r,this.context=i,this._expressions=this._getExpressions()}}class sU extends sW{_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:i=>this._now()+new this.constructor(this.context,i).valueOf(),regexp:/^\+(.+)/},quantize:{method:i=>{let s=new sU(this.context,i).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(s))},regexp:/^@(.+)/}})}quantize(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=new this.constructor(this.context,i).valueOf(),o=this.valueOf();return o+(Math.round(o/r)*r-o)*s}toNotation(){let i=this.toSeconds(),s=["1m"];for(let i=1;i<9;i++){let r=Math.pow(2,i);s.push(r+"n."),s.push(r+"n"),s.push(r+"t")}s.push("0");let r=s[0],o=new sU(this.context,s[0]).toSeconds();return s.forEach(s=>{let a=new sU(this.context,s).toSeconds();Math.abs(a-i)<Math.abs(o-i)&&(r=s,o=a)}),r}toBarsBeatsSixteenths(){let i=this._beatsToUnits(1),s=this.valueOf()/i;s=parseFloat(s.toFixed(4));let r=Math.floor(s/this._getTimeSignature()),o=s%1*4;s=Math.floor(s)%this._getTimeSignature();let a=o.toString();return a.length>3&&(o=parseFloat(parseFloat(a).toFixed(3))),[r,s,o].join(":")}toTicks(){let i=this._beatsToUnits(1);return this.valueOf()/i*this._getPPQ()}toSeconds(){return this.valueOf()}toMidi(){return sF(this.toFrequency())}_now(){return this.context.now()}constructor(){super(...arguments),this.name="TimeClass"}}function sz(i,s){return new sU(sN(),i,s)}class sG extends sU{static get A4(){return sL}static set A4(i){sL=i}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(i){return"midi"===this.defaultUnits?i:sG.mtof(i)}},note:{regexp:/^([a-g]{1}(?:b|#|##|x|bb|###|#x|x#|bbb)?)(-?[0-9]+)/i,method(i,s){let r=sX[i.toLowerCase()]+12*(parseInt(s,10)+1);return"midi"===this.defaultUnits?r:sG.mtof(r)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(i,s,r){let o=1;return i&&"0"!==i&&(o*=this._beatsToUnits(this._getTimeSignature()*parseFloat(i))),s&&"0"!==s&&(o*=this._beatsToUnits(parseFloat(s))),r&&"0"!==r&&(o*=this._beatsToUnits(parseFloat(r)/4)),o}}})}transpose(i){return new sG(this.context,this.valueOf()*sq(i))}harmonize(i){return i.map(i=>this.transpose(i))}toMidi(){return sF(this.valueOf())}toNote(){let i=this.toFrequency(),s=Math.log2(i/sG.A4),r=Math.round(12*s)+57,o=Math.floor(r/12);return o<0&&(r+=-12*o),sZ[r%12]+o.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){let i=this._beatsToUnits(1),s=this.valueOf()/i;return Math.floor(s*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(i){return i}_ticksToUnits(i){return 1/(60*i/(this._getBpm()*this._getPPQ()))}_beatsToUnits(i){return 1/super._beatsToUnits(i)}_secondsToUnits(i){return 1/i}static mtof(i){return sL*Math.pow(2,(i-69)/12)}static ftom(i){return sF(i)}constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}}let sX={cbbb:-3,cbb:-2,cb:-1,c:0,"c#":1,cx:2,"c##":2,"c###":3,"cx#":3,"c#x":3,dbbb:-1,dbb:0,db:1,d:2,"d#":3,dx:4,"d##":4,"d###":5,"dx#":5,"d#x":5,ebbb:1,ebb:2,eb:3,e:4,"e#":5,ex:6,"e##":6,"e###":7,"ex#":7,"e#x":7,fbbb:2,fbb:3,fb:4,f:5,"f#":6,fx:7,"f##":7,"f###":8,"fx#":8,"f#x":8,gbbb:4,gbb:5,gb:6,g:7,"g#":8,gx:9,"g##":9,"g###":10,"gx#":10,"g#x":10,abbb:6,abb:7,ab:8,a:9,"a#":10,ax:11,"a##":11,"a###":12,"ax#":12,"a#x":12,bbbb:8,bbb:9,bb:10,b:11,"b#":12,bx:13,"b##":13,"b###":14,"bx#":14,"b#x":14},sZ=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];class sH extends sU{_now(){return this.context.transport.seconds}constructor(){super(...arguments),this.name="TransportTime"}}class sY extends sm{static getDefaults(){return{context:sN()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(i){return i4(i)&&ss&&!sr&&(sr=!0,sa("Events scheduled inside of scheduled callbacks should use the passed in scheduling time. See https://github.com/Tonejs/Tone.js/wiki/Accurate-Timing")),new sU(this.context,i).toSeconds()}toFrequency(i){return new sG(this.context,i).toFrequency()}toTicks(i){return new sH(this.context,i).toTicks()}_getPartialProperties(i){let s=this.get();return Object.keys(s).forEach(r=>{i4(i[r])&&delete s[r]}),s}get(){let i=this.constructor.getDefaults();return Object.keys(i).forEach(s=>{if(Reflect.has(this,s)){let r=this[s];i8(r)&&i8(r.value)&&i8(r.setValueAtTime)?i[s]=r.value:r instanceof sY?i[s]=r._getPartialProperties(i[s]):i7(r)||i6(r)||i9(r)||"boolean"==typeof r?i[s]=r:delete i[s]}}),i}set(i){return Object.keys(i).forEach(s=>{Reflect.has(this,s)&&i8(this[s])&&(this[s]&&i8(this[s].value)&&i8(this[s].setValueAtTime)?this[s].value!==i[s]&&(this[s].value=i[s]):this[s]instanceof sY?this[s].set(i[s]):this[s]=i[s])}),this}constructor(){super();let i=sd(sY.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=i.context}}class sJ extends sb{getValueAtTime(i){let s=this.get(i);return null!==s?s.state:this._initial}setStateAtTime(i,s,r){return sn(s,0),this.add(Object.assign({},r,{state:i,time:s})),this}getLastState(i,s){for(let r=this._search(s);r>=0;r--){let s=this._timeline[r];if(s.state===i)return s}}getNextState(i,s){let r=this._search(s);if(-1!==r)for(let s=r;s<this._timeline.length;s++){let r=this._timeline[s];if(r.state===i)return r}}constructor(i="stopped"){super(),this.name="StateTimeline",this._initial=i,this.setStateAtTime(this._initial,0)}}class sQ extends sY{static getDefaults(){return Object.assign(sY.getDefaults(),{convert:!0,units:"number"})}get value(){let i=this.now();return this.getValueAtTime(i)}set value(i){this.cancelScheduledValues(this.now()),this.setValueAtTime(i,this.now())}get minValue(){return i8(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return i8(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(i,s){return this.units===s}_assertRange(i){return i8(this.maxValue)&&i8(this.minValue)&&sn(i,this._fromType(this.minValue),this._fromType(this.maxValue)),i}_fromType(i){return this.convert&&!this.overridden?this._is(i,"time")?this.toSeconds(i):this._is(i,"decibels")?Math.pow(10,i/20):this._is(i,"frequency")?this.toFrequency(i):i:this.overridden?0:i}_toType(i){return this.convert&&"decibels"===this.units?Math.log(i)/Math.LN10*20:i}setValueAtTime(i,s){let r=this.toSeconds(s),o=this._fromType(i);return se(isFinite(o)&&isFinite(r),"Invalid argument(s) to setValueAtTime: ".concat(JSON.stringify(i),", ").concat(JSON.stringify(s))),this._assertRange(o),this.log(this.units,"setValueAtTime",i,r),this._events.add({time:r,type:"setValueAtTime",value:o}),this._param.setValueAtTime(o,r),this}getValueAtTime(i){let s=Math.max(this.toSeconds(i),0),r=this._events.getAfter(s),o=this._events.get(s),a=this._initialValue;if(null===o)a=this._initialValue;else if("setTargetAtTime"!==o.type||null!==r&&"setValueAtTime"!==r.type){if(null===r)a=o.value;else if("linearRampToValueAtTime"===r.type||"exponentialRampToValueAtTime"===r.type){let i=o.value;if("setTargetAtTime"===o.type){let s=this._events.getBefore(o.time);i=null===s?this._initialValue:s.value}a="linearRampToValueAtTime"===r.type?this._linearInterpolate(o.time,i,r.time,r.value,s):this._exponentialInterpolate(o.time,i,r.time,r.value,s)}else a=o.value}else{let i;let r=this._events.getBefore(o.time);i=null===r?this._initialValue:r.value,"setTargetAtTime"===o.type&&(a=this._exponentialApproach(o.time,i,o.value,o.constant,s))}return this._toType(a)}setRampPoint(i){i=this.toSeconds(i);let s=this.getValueAtTime(i);return this.cancelAndHoldAtTime(i),0===this._fromType(s)&&(s=this._toType(this._minOutput)),this.setValueAtTime(s,i),this}linearRampToValueAtTime(i,s){let r=this._fromType(i),o=this.toSeconds(s);return se(isFinite(r)&&isFinite(o),"Invalid argument(s) to linearRampToValueAtTime: ".concat(JSON.stringify(i),", ").concat(JSON.stringify(s))),this._assertRange(r),this._events.add({time:o,type:"linearRampToValueAtTime",value:r}),this.log(this.units,"linearRampToValueAtTime",i,o),this._param.linearRampToValueAtTime(r,o),this}exponentialRampToValueAtTime(i,s){let r=this._fromType(i);r=sy(r,0)?this._minOutput:r,this._assertRange(r);let o=this.toSeconds(s);return se(isFinite(r)&&isFinite(o),"Invalid argument(s) to exponentialRampToValueAtTime: ".concat(JSON.stringify(i),", ").concat(JSON.stringify(s))),this._events.add({time:o,type:"exponentialRampToValueAtTime",value:r}),this.log(this.units,"exponentialRampToValueAtTime",i,o),this._param.exponentialRampToValueAtTime(r,o),this}exponentialRampTo(i,s,r){return r=this.toSeconds(r),this.setRampPoint(r),this.exponentialRampToValueAtTime(i,r+this.toSeconds(s)),this}linearRampTo(i,s,r){return r=this.toSeconds(r),this.setRampPoint(r),this.linearRampToValueAtTime(i,r+this.toSeconds(s)),this}targetRampTo(i,s,r){return r=this.toSeconds(r),this.setRampPoint(r),this.exponentialApproachValueAtTime(i,r,s),this}exponentialApproachValueAtTime(i,s,r){s=this.toSeconds(s),r=this.toSeconds(r);let o=Math.log(r+1)/Math.log(200);return this.setTargetAtTime(i,s,o),this.cancelAndHoldAtTime(s+.9*r),this.linearRampToValueAtTime(i,s+r),this}setTargetAtTime(i,s,r){let o=this._fromType(i);se(isFinite(r)&&r>0,"timeConstant must be a number greater than 0");let a=this.toSeconds(s);return this._assertRange(o),se(isFinite(o)&&isFinite(a),"Invalid argument(s) to setTargetAtTime: ".concat(JSON.stringify(i),", ").concat(JSON.stringify(s))),this._events.add({constant:r,time:a,type:"setTargetAtTime",value:o}),this.log(this.units,"setTargetAtTime",i,a,r),this._param.setTargetAtTime(o,a,r),this}setValueCurveAtTime(i,s,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;r=this.toSeconds(r),s=this.toSeconds(s);let a=this._fromType(i[0])*o;this.setValueAtTime(this._toType(a),s);let l=r/(i.length-1);for(let r=1;r<i.length;r++){let a=this._fromType(i[r])*o;this.linearRampToValueAtTime(this._toType(a),s+r*l)}return this}cancelScheduledValues(i){let s=this.toSeconds(i);return se(isFinite(s),"Invalid argument to cancelScheduledValues: ".concat(JSON.stringify(i))),this._events.cancel(s),this._param.cancelScheduledValues(s),this.log(this.units,"cancelScheduledValues",s),this}cancelAndHoldAtTime(i){let s=this.toSeconds(i),r=this._fromType(this.getValueAtTime(s));se(isFinite(s),"Invalid argument to cancelAndHoldAtTime: ".concat(JSON.stringify(i))),this.log(this.units,"cancelAndHoldAtTime",s,"value="+r);let o=this._events.get(s),a=this._events.getAfter(s);return o&&sy(o.time,s)?a?(this._param.cancelScheduledValues(a.time),this._events.cancel(a.time)):(this._param.cancelAndHoldAtTime(s),this._events.cancel(s+this.sampleTime)):a&&(this._param.cancelScheduledValues(a.time),this._events.cancel(a.time),"linearRampToValueAtTime"===a.type?this.linearRampToValueAtTime(this._toType(r),s):"exponentialRampToValueAtTime"===a.type&&this.exponentialRampToValueAtTime(this._toType(r),s)),this._events.add({time:s,type:"setValueAtTime",value:r}),this._param.setValueAtTime(r,s),this}rampTo(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,r=arguments.length>2?arguments[2]:void 0;return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(i,s,r):this.linearRampTo(i,s,r),this}apply(i){let s=this.context.currentTime;i.setValueAtTime(this.getValueAtTime(s),s);let r=this._events.get(s);if(r&&"setTargetAtTime"===r.type){let o=this._events.getAfter(r.time),a=o?o.time:s+2,l=(a-s)/10;for(let r=s;r<a;r+=l)i.linearRampToValueAtTime(this.getValueAtTime(r),r)}return this._events.forEachAfter(this.context.currentTime,s=>{"cancelScheduledValues"===s.type?i.cancelScheduledValues(s.time):"setTargetAtTime"===s.type?i.setTargetAtTime(s.value,s.time,s.constant):i[s.type](s.value,s.time)}),this}setParam(i){se(this._swappable,"The Param must be assigned as 'swappable' in the constructor");let s=this.input;return s.disconnect(this._param),this.apply(i),this._param=i,s.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(i,s,r,o,a){return r+(s-r)*Math.exp(-(a-i)/o)}_linearInterpolate(i,s,r,o,a){return s+(a-i)/(r-i)*(o-s)}_exponentialInterpolate(i,s,r,o,a){return s*Math.pow(o/s,(a-i)/(r-i))}constructor(){super(sd(sQ.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;let i=sd(sQ.getDefaults(),arguments,["param","units","convert"]);for(se(i8(i.param)&&(i2(i.param)||i.param instanceof sQ),"param must be an AudioParam");!i2(i.param);)i.param=i.param._param;this._swappable=!!i8(i.swappable)&&i.swappable,this._swappable?(this.input=this.context.createGain(),this._param=i.param,this.input.connect(this._param)):this._param=this.input=i.param,this._events=new sb(1e3),this._initialValue=this._param.defaultValue,this.units=i.units,this.convert=i.convert,this._minValue=i.minValue,this._maxValue=i.maxValue,i8(i.value)&&i.value!==this._toType(this._initialValue)&&this.setValueAtTime(i.value,0)}}class s$ extends sY{get numberOfInputs(){return i8(this.input)?i2(this.input)||this.input instanceof sQ?1:this.input.numberOfInputs:0}get numberOfOutputs(){return i8(this.output)?this.output.numberOfOutputs:0}_isAudioNode(i){return i8(i)&&(i instanceof s$||i1(i))}_getInternalNodes(){let i=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&i.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&i.push(this.output),i}_setChannelProperties(i){this._getInternalNodes().forEach(s=>{s.channelCount=i.channelCount,s.channelCountMode=i.channelCountMode,s.channelInterpretation=i.channelInterpretation})}_getChannelProperties(){let i=this._getInternalNodes();se(i.length>0,"ToneAudioNode does not have any internal nodes");let s=i[0];return{channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(i){let s=this._getChannelProperties();this._setChannelProperties(Object.assign(s,{channelCount:i}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(i){let s=this._getChannelProperties();this._setChannelProperties(Object.assign(s,{channelCountMode:i}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(i){let s=this._getChannelProperties();this._setChannelProperties(Object.assign(s,{channelInterpretation:i}))}connect(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return s0(this,i,s,r),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return sa("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return function(i,s){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(i8(s))for(;s instanceof s$;)s=s.input;for(;!i1(i);)i8(i.output)&&(i=i.output);i2(s)?i.disconnect(s,r):i1(s)?i.disconnect(s,r,o):i.disconnect()}(this,i,s,r),this}chain(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];return sK(this,...s),this}fan(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];return s.forEach(i=>this.connect(i)),this}dispose(){return super.dispose(),i8(this.input)&&(this.input instanceof s$?this.input.dispose():i1(this.input)&&this.input.disconnect()),i8(this.output)&&(this.output instanceof s$?this.output.dispose():i1(this.output)&&this.output.disconnect()),this._internalChannels=[],this}constructor(){super(...arguments),this._internalChannels=[]}}function sK(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];let o=s.shift();s.reduce((i,s)=>(i instanceof s$?i.connect(s):i1(i)&&s0(i,s),s),o)}function s0(i,s){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;for(se(i8(i),"Cannot connect from undefined node"),se(i8(s),"Cannot connect to undefined node"),(s instanceof s$||i1(s))&&se(s.numberOfInputs>0,"Cannot connect to node with no inputs"),se(i.numberOfOutputs>0,"Cannot connect from node with no outputs");s instanceof s$||s instanceof sQ;)i8(s.input)&&(s=s.input);for(;i instanceof s$;)i8(i.output)&&(i=i.output);i2(s)?i.connect(s,r):i.connect(s,r,o)}class s1 extends s${static getDefaults(){return Object.assign(s$.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}constructor(){super(sd(s1.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;let i=sd(s1.getDefaults(),arguments,["gain","units"]);this.gain=new sQ({context:this.context,convert:i.convert,param:this._gainNode.gain,units:i.units,value:i.gain,minValue:i.minValue,maxValue:i.maxValue}),sE(this,"gain")}}class s2 extends s${static getDefaults(){return Object.assign(s$.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:sM})}_startGain(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;se(-1===this._startTime,"Source cannot be started more than once");let r=this.toSeconds(this._fadeIn);return this._startTime=i+r,this._startTime=Math.max(this._startTime,this.context.currentTime),r>0?(this._gainNode.gain.setValueAtTime(0,i),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(s,i+r):this._gainNode.gain.exponentialApproachValueAtTime(s,i,r)):this._gainNode.gain.setValueAtTime(s,i),this}stop(i){return this.log("stop",i),this._stopGain(this.toSeconds(i)),this}_stopGain(i){se(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();let s=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(i)+s,this._stopTime=Math.max(this._stopTime,this.now()),s>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,s,i):this._gainNode.gain.targetRampTo(0,s,i):(this._gainNode.gain.cancelAndHoldAtTime(i),this._gainNode.gain.setValueAtTime(0,i)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{let i="exponential"===this._curve?2*s:0;this._stopSource(this.now()+i),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==sM&&(this.onended(this),this.onended=sM,!this.context.isOffline)){let i=()=>this.dispose();void 0!==window.requestIdleCallback?window.requestIdleCallback(i):setTimeout(i,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),se(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.dispose(),this.onended=sM,this}constructor(i){super(i),this.onended=sM,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new s1({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(i){let s=this.toSeconds(i);return -1!==this._startTime&&s>=this._startTime&&(-1===this._stopTime||s<=this._stopTime)?"started":"stopped"},this._fadeIn=i.fadeIn,this._fadeOut=i.fadeOut,this._curve=i.curve,this.onended=i.onended}}class s3 extends s2{static getDefaults(){return Object.assign(s2.getDefaults(),{convert:!0,offset:1,units:"number"})}start(i){let s=this.toSeconds(i);return this.log("start",s),this._startGain(s),this._source.start(s),this}_stopSource(i){this._source.stop(i)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}constructor(){super(sd(s3.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();let i=sd(s3.getDefaults(),arguments,["offset"]);s0(this._source,this._gainNode),this.offset=new sQ({context:this.context,convert:i.convert,param:this._source.offset,units:i.units,value:i.offset,minValue:i.minValue,maxValue:i.maxValue})}}class s4 extends s${static getDefaults(){return Object.assign(s$.getDefaults(),{convert:!0,units:"number",value:0})}connect(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return s8(this,i,s,r),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(i,s){return this._param.setValueAtTime(i,s),this}getValueAtTime(i){return this._param.getValueAtTime(i)}setRampPoint(i){return this._param.setRampPoint(i),this}linearRampToValueAtTime(i,s){return this._param.linearRampToValueAtTime(i,s),this}exponentialRampToValueAtTime(i,s){return this._param.exponentialRampToValueAtTime(i,s),this}exponentialRampTo(i,s,r){return this._param.exponentialRampTo(i,s,r),this}linearRampTo(i,s,r){return this._param.linearRampTo(i,s,r),this}targetRampTo(i,s,r){return this._param.targetRampTo(i,s,r),this}exponentialApproachValueAtTime(i,s,r){return this._param.exponentialApproachValueAtTime(i,s,r),this}setTargetAtTime(i,s,r){return this._param.setTargetAtTime(i,s,r),this}setValueCurveAtTime(i,s,r,o){return this._param.setValueCurveAtTime(i,s,r,o),this}cancelScheduledValues(i){return this._param.cancelScheduledValues(i),this}cancelAndHoldAtTime(i){return this._param.cancelAndHoldAtTime(i),this}rampTo(i,s,r){return this._param.rampTo(i,s,r),this}get value(){return this._param.value}set value(i){this._param.value=i}get convert(){return this._param.convert}set convert(i){this._param.convert=i}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(i){this._param.overridden=i}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(i){return this._param.apply(i),this}constructor(){super(sd(s4.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;let i=sd(s4.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new s3({context:this.context,convert:i.convert,offset:i.value,units:i.units,minValue:i.minValue,maxValue:i.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}}function s8(i,s,r,o){(s instanceof sQ||i2(s)||s instanceof s4&&s.override)&&(s.cancelScheduledValues(0),s.setValueAtTime(0,0),s instanceof s4&&(s.overridden=!0)),s0(i,s,r,o)}class s6 extends sQ{static getDefaults(){return Object.assign(sQ.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(i,s,r){s=this.toSeconds(s),this.setRampPoint(s);let o=this._fromType(i),a=this._events.get(s),l=Math.round(Math.max(1/r,1));for(let i=0;i<=l;i++){let l=r*i+s,u=this._exponentialApproach(a.time,a.value,o,r,l);this.linearRampToValueAtTime(this._toType(u),l)}return this}setValueAtTime(i,s){let r=this.toSeconds(s);super.setValueAtTime(i,s);let o=this._events.get(r),a=this._events.previousEvent(o),l=this._getTicksUntilEvent(a,r);return o.ticks=Math.max(l,0),this}linearRampToValueAtTime(i,s){let r=this.toSeconds(s);super.linearRampToValueAtTime(i,s);let o=this._events.get(r),a=this._events.previousEvent(o),l=this._getTicksUntilEvent(a,r);return o.ticks=Math.max(l,0),this}exponentialRampToValueAtTime(i,s){s=this.toSeconds(s);let r=this._fromType(i),o=this._events.get(s),a=Math.round(Math.max(10*(s-o.time),1)),l=(s-o.time)/a;for(let i=0;i<=a;i++){let a=l*i+o.time,u=this._exponentialInterpolate(o.time,o.value,s,r,a);this.linearRampToValueAtTime(this._toType(u),a)}return this}_getTicksUntilEvent(i,s){if(null===i)i={ticks:0,time:0,type:"setValueAtTime",value:0};else if(i4(i.ticks)){let s=this._events.previousEvent(i);i.ticks=this._getTicksUntilEvent(s,i.time)}let r=this._fromType(this.getValueAtTime(i.time)),o=this._fromType(this.getValueAtTime(s)),a=this._events.get(s);return a&&a.time===s&&"setValueAtTime"===a.type&&(o=this._fromType(this.getValueAtTime(s-this.sampleTime))),.5*(s-i.time)*(r+o)+i.ticks}getTicksAtTime(i){let s=this.toSeconds(i),r=this._events.get(s);return Math.max(this._getTicksUntilEvent(r,s),0)}getDurationOfTicks(i,s){let r=this.toSeconds(s),o=this.getTicksAtTime(s);return this.getTimeOfTick(o+i)-r}getTimeOfTick(i){let s=this._events.get(i,"ticks"),r=this._events.getAfter(i,"ticks");if(s&&s.ticks===i)return s.time;if(s&&r&&"linearRampToValueAtTime"===r.type&&s.value!==r.value){let o=this._fromType(this.getValueAtTime(s.time)),a=(this._fromType(this.getValueAtTime(r.time))-o)/(r.time-s.time),l=Math.sqrt(Math.pow(o,2)-2*a*(s.ticks-i)),u=(-o+l)/a;return(u>0?u:(-o-l)/a)+s.time}return s?0===s.value?1/0:s.time+(i-s.ticks)/s.value:i/this._initialValue}ticksToTime(i,s){return this.getDurationOfTicks(i,s)}timeToTicks(i,s){let r=this.toSeconds(s),o=this.toSeconds(i),a=this.getTicksAtTime(r);return this.getTicksAtTime(r+o)-a}_fromType(i){return"bpm"===this.units&&this.multiplier?1/(60/i/this.multiplier):super._fromType(i)}_toType(i){return"bpm"===this.units&&this.multiplier?i/this.multiplier*60:super._toType(i)}get multiplier(){return this._multiplier}set multiplier(i){let s=this.value;this._multiplier=i,this.cancelScheduledValues(0),this.setValueAtTime(s,0)}constructor(){super(sd(s6.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new sb(1/0),this._multiplier=1;let i=sd(s6.getDefaults(),arguments,["value"]);this._multiplier=i.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(i.value)}),this.setValueAtTime(i.value,0)}}class s5 extends s4{static getDefaults(){return Object.assign(s4.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(i,s){return this._param.ticksToTime(i,s)}timeToTicks(i,s){return this._param.timeToTicks(i,s)}getTimeOfTick(i){return this._param.getTimeOfTick(i)}getDurationOfTicks(i,s){return this._param.getDurationOfTicks(i,s)}getTicksAtTime(i){return this._param.getTicksAtTime(i)}get multiplier(){return this._param.multiplier}set multiplier(i){this._param.multiplier=i}dispose(){return super.dispose(),this._param.dispose(),this}constructor(){super(sd(s5.getDefaults(),arguments,["value"])),this.name="TickSignal";let i=sd(s5.getDefaults(),arguments,["value"]);this.input=this._param=new s6({context:this.context,convert:i.convert,multiplier:i.multiplier,param:this._constantSource.offset,units:i.units,value:i.value})}}class s7 extends sY{static getDefaults(){return Object.assign({frequency:1,units:"hertz"},sY.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(i,s){let r=this.toSeconds(i);return"started"!==this._state.getValueAtTime(r)&&(this._state.setStateAtTime("started",r),i8(s)&&this.setTicksAtTime(s,r),this._ticksAtTime.cancel(r),this._secondsAtTime.cancel(r)),this}stop(i){let s=this.toSeconds(i);if("stopped"===this._state.getValueAtTime(s)){let i=this._state.get(s);i&&i.time>0&&(this._tickOffset.cancel(i.time),this._state.cancel(i.time))}return this._state.cancel(s),this._state.setStateAtTime("stopped",s),this.setTicksAtTime(0,s),this._ticksAtTime.cancel(s),this._secondsAtTime.cancel(s),this}pause(i){let s=this.toSeconds(i);return"started"===this._state.getValueAtTime(s)&&(this._state.setStateAtTime("paused",s),this._ticksAtTime.cancel(s),this._secondsAtTime.cancel(s)),this}cancel(i){return i=this.toSeconds(i),this._state.cancel(i),this._tickOffset.cancel(i),this._ticksAtTime.cancel(i),this._secondsAtTime.cancel(i),this}getTicksAtTime(i){let s=this.toSeconds(i),r=this._state.getLastState("stopped",s),o=this._ticksAtTime.get(s),a={state:"paused",time:s};this._state.add(a);let l=o||r,u=o?o.ticks:0,h=null;return this._state.forEachBetween(l.time,s+this.sampleTime,i=>{let s=l.time,r=this._tickOffset.get(i.time);r&&r.time>=l.time&&(u=r.ticks,s=r.time),"started"===l.state&&"started"!==i.state&&(u+=this.frequency.getTicksAtTime(i.time)-this.frequency.getTicksAtTime(s),i.time!==a.time&&(h={state:i.state,time:i.time,ticks:u})),l=i}),this._state.remove(a),h&&this._ticksAtTime.add(h),u}get ticks(){return this.getTicksAtTime(this.now())}set ticks(i){this.setTicksAtTime(i,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(i){let s=this.now(),r=this.frequency.timeToTicks(i,s);this.setTicksAtTime(r,s)}getSecondsAtTime(i){i=this.toSeconds(i);let s=this._state.getLastState("stopped",i),r={state:"paused",time:i};this._state.add(r);let o=this._secondsAtTime.get(i),a=o||s,l=o?o.seconds:0,u=null;return this._state.forEachBetween(a.time,i+this.sampleTime,i=>{let s=a.time,o=this._tickOffset.get(i.time);o&&o.time>=a.time&&(l=o.seconds,s=o.time),"started"===a.state&&"started"!==i.state&&(l+=i.time-s,i.time!==r.time&&(u={state:i.state,time:i.time,seconds:l})),a=i}),this._state.remove(r),u&&this._secondsAtTime.add(u),l}setTicksAtTime(i,s){return s=this.toSeconds(s),this._tickOffset.cancel(s),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(i,s),ticks:i,time:s}),this._ticksAtTime.cancel(s),this._secondsAtTime.cancel(s),this}getStateAtTime(i){return i=this.toSeconds(i),this._state.getValueAtTime(i)}getTimeOfTick(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.now(),r=this._tickOffset.get(s),o=this._state.get(s),a=Math.max(r.time,o.time),l=this.frequency.getTicksAtTime(a)+i-r.ticks;return this.frequency.getTimeOfTick(l)}forEachTickBetween(i,s,r){let o=this._state.get(i);this._state.forEachBetween(i,s,s=>{o&&"started"===o.state&&"started"!==s.state&&this.forEachTickBetween(Math.max(o.time,i),s.time-this.sampleTime,r),o=s});let a=null;if(o&&"started"===o.state){let l=Math.max(o.time,i),u=this.frequency.getTicksAtTime(l),h=u-this.frequency.getTicksAtTime(o.time),c=Math.ceil(h)-h;c=sy(c,1)?0:c;let d=this.frequency.getTimeOfTick(u+c);for(;d<s;){try{r(d,Math.round(this.getTicksAtTime(d)))}catch(i){a=i;break}d+=this.frequency.getDurationOfTicks(1,d)}}if(a)throw a;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this._ticksAtTime.dispose(),this._secondsAtTime.dispose(),this.frequency.dispose(),this}constructor(){super(sd(s7.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new sJ,this._tickOffset=new sb,this._ticksAtTime=new sb,this._secondsAtTime=new sb;let i=sd(s7.getDefaults(),arguments,["frequency"]);this.frequency=new s5({context:this.context,units:i.units,value:i.frequency}),sE(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}}class s9 extends sY{static getDefaults(){return Object.assign(sY.getDefaults(),{callback:sM,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(i,s){si(this.context);let r=this.toSeconds(i);return this.log("start",r),"started"!==this._state.getValueAtTime(r)&&(this._state.setStateAtTime("started",r),this._tickSource.start(r,s),r<this._lastUpdate&&this.emit("start",r,s)),this}stop(i){let s=this.toSeconds(i);return this.log("stop",s),this._state.cancel(s),this._state.setStateAtTime("stopped",s),this._tickSource.stop(s),s<this._lastUpdate&&this.emit("stop",s),this}pause(i){let s=this.toSeconds(i);return"started"===this._state.getValueAtTime(s)&&(this._state.setStateAtTime("paused",s),this._tickSource.pause(s),s<this._lastUpdate&&this.emit("pause",s)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(i){this._tickSource.ticks=i}get seconds(){return this._tickSource.seconds}set seconds(i){this._tickSource.seconds=i}getSecondsAtTime(i){return this._tickSource.getSecondsAtTime(i)}setTicksAtTime(i,s){return this._tickSource.setTicksAtTime(i,s),this}getTimeOfTick(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.now();return this._tickSource.getTimeOfTick(i,s)}getTicksAtTime(i){return this._tickSource.getTicksAtTime(i)}nextTickTime(i,s){let r=this.toSeconds(s),o=this.getTicksAtTime(r);return this._tickSource.getTimeOfTick(o+i,r)}_loop(){let i=this._lastUpdate,s=this.now();this._lastUpdate=s,this.log("loop",i,s),i!==s&&(this._state.forEachBetween(i,s,i=>{switch(i.state){case"started":let s=this._tickSource.getTicksAtTime(i.time);this.emit("start",i.time,s);break;case"stopped":0!==i.time&&this.emit("stop",i.time);break;case"paused":this.emit("pause",i.time)}}),this._tickSource.forEachTickBetween(i,s,(i,s)=>{this.callback(i,s)}))}getStateAtTime(i){let s=this.toSeconds(i);return this._state.getValueAtTime(s)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}constructor(){super(sd(s9.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=sM,this._lastUpdate=0,this._state=new sJ("stopped"),this._boundLoop=this._loop.bind(this);let i=sd(s9.getDefaults(),arguments,["callback","frequency"]);this.callback=i.callback,this._tickSource=new s7({context:this.context,frequency:i.frequency,units:i.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,sE(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}}sS.mixin(s9);class rt extends sY{schedule(i,s){return this._events.add({callback:i,time:this.toSeconds(s)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(i){return this._events.cancel(this.toSeconds(i)),this}_drawLoop(){let i=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=i;){let s=this._events.shift();s&&i-s.time<=this.expiration&&s.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new sb,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}}sw(i=>{i.draw=new rt({context:i})}),sC(i=>{i.draw.dispose()});class re extends s${static getDefaults(){return Object.assign(s$.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(i){!this.mute&&i?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!i&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}constructor(){super(sd(re.getDefaults(),arguments,["volume"])),this.name="Volume";let i=sd(re.getDefaults(),arguments,["volume"]);this.input=this.output=new s1({context:this.context,gain:i.volume,units:"decibels"}),this.volume=this.output.gain,sE(this,"volume"),this._unmutedVolume=i.volume,this.mute=i.mute}}class rn extends s${static getDefaults(){return Object.assign(s$.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(i){this.input.mute=i}chain(){for(var i=arguments.length,s=Array(i),r=0;r<i;r++)s[r]=arguments[r];return this.input.disconnect(),s.unshift(this.input),s.push(this.output),sK(...s),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}constructor(){super(sd(rn.getDefaults(),arguments)),this.name="Destination",this.input=new re({context:this.context}),this.output=new s1({context:this.context}),this.volume=this.input.volume;let i=sd(rn.getDefaults(),arguments);sK(this.input,this.output,this.context.rawContext.destination),this.mute=i.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}}sw(i=>{i.destination=new rn({context:i})}),sC(i=>{i.destination.dispose()});class ri extends sm{set(i,s){return this._timeline.add({value:i,time:s}),this}get(i){let s=this._timeline.get(i);return s?s.value:this._initialValue}constructor(i){super(),this.name="TimelineValue",this._timeline=new sb({memory:10}),this._initialValue=i}}class rs extends s${connect(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return s8(this,i,s,r),this}constructor(){super(Object.assign(sd(rs.getDefaults(),arguments,["context"])))}}class rr extends rs{static getDefaults(){return Object.assign(s4.getDefaults(),{length:1024})}setMap(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=new Float32Array(s);for(let o=0;o<s;o++){let a=o/(s-1)*2-1;r[o]=i(a,o)}return this.curve=r,this}get curve(){return this._shaper.curve}set curve(i){this._shaper.curve=i}get oversample(){return this._shaper.oversample}set oversample(i){let s=["none","2x","4x"].some(s=>s.includes(i));se(s,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=i}dispose(){return super.dispose(),this._shaper.disconnect(),this}constructor(){super(Object.assign(sd(rr.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;let i=sd(rr.getDefaults(),arguments,["mapping","length"]);i7(i.mapping)||i.mapping instanceof Float32Array?this.curve=Float32Array.from(i.mapping):"function"==typeof i.mapping&&this.setMap(i.mapping,i.length)}}class ro extends rs{static getDefaults(){return Object.assign(rs.getDefaults(),{value:1})}_expFunc(i){return s=>Math.pow(Math.abs(s),i)}get value(){return this._exponent}set value(i){this._exponent=i,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}constructor(){super(Object.assign(sd(ro.getDefaults(),arguments,["value"]))),this.name="Pow";let i=sd(ro.getDefaults(),arguments,["value"]);this._exponentScaler=this.input=this.output=new rr({context:this.context,mapping:this._expFunc(i.value),length:8192}),this._exponent=i.value}}class ra extends sH{_now(){return this.context.transport.ticks}_beatsToUnits(i){return this._getPPQ()*i}_secondsToUnits(i){return Math.floor(i/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(i){return i}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}}class rl extends sm{add(i){se(i8(i.time),"Events must have a time property"),se(i8(i.duration),"Events must have a duration parameter"),i.time=i.time.valueOf();let s=new ru(i.time,i.time+i.duration,i);for(null===this._root?this._root=s:this._root.insert(s),this._length++;null!==s;)s.updateHeight(),s.updateMax(),this._rebalance(s),s=s.parent;return this}remove(i){if(null!==this._root){let s=[];for(let r of(this._root.search(i.time,s),s))if(r.event===i){this._removeNode(r),this._length--;break}}return this}get length(){return this._length}cancel(i){return this.forEachFrom(i,i=>this.remove(i)),this}_setRoot(i){this._root=i,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(i,s){null!==i.parent?(i.isLeftChild()?i.parent.left=s:i.parent.right=s,this._rebalance(i.parent)):this._setRoot(s)}_removeNode(i){if(null===i.left&&null===i.right)this._replaceNodeInParent(i,null);else if(null===i.right)this._replaceNodeInParent(i,i.left);else if(null===i.left)this._replaceNodeInParent(i,i.right);else{let s,r=null;if(i.getBalance()>0){if(null===i.left.right)(s=i.left).right=i.right,r=s;else{for(s=i.left.right;null!==s.right;)s=s.right;s.parent&&(s.parent.right=s.left,r=s.parent,s.left=i.left,s.right=i.right)}}else if(null===i.right.left)(s=i.right).left=i.left,r=s;else{for(s=i.right.left;null!==s.left;)s=s.left;s.parent&&(s.parent.left=s.right,r=s.parent,s.left=i.left,s.right=i.right)}null!==i.parent?i.isLeftChild()?i.parent.left=s:i.parent.right=s:this._setRoot(s),r&&this._rebalance(r)}i.dispose()}_rotateLeft(i){let s=i.parent,r=i.isLeftChild(),o=i.right;o&&(i.right=o.left,o.left=i),null!==s?r?s.left=o:s.right=o:this._setRoot(o)}_rotateRight(i){let s=i.parent,r=i.isLeftChild(),o=i.left;o&&(i.left=o.right,o.right=i),null!==s?r?s.left=o:s.right=o:this._setRoot(o)}_rebalance(i){let s=i.getBalance();s>1&&i.left?0>i.left.getBalance()?this._rotateLeft(i.left):this._rotateRight(i):s<-1&&i.right&&(i.right.getBalance()>0?this._rotateRight(i.right):this._rotateLeft(i))}get(i){if(null!==this._root){let s=[];if(this._root.search(i,s),s.length>0){let i=s[0];for(let r=1;r<s.length;r++)s[r].low>i.low&&(i=s[r]);return i.event}}return null}forEach(i){if(null!==this._root){let s=[];this._root.traverse(i=>s.push(i)),s.forEach(s=>{s.event&&i(s.event)})}return this}forEachAtTime(i,s){if(null!==this._root){let r=[];this._root.search(i,r),r.forEach(i=>{i.event&&s(i.event)})}return this}forEachFrom(i,s){if(null!==this._root){let r=[];this._root.searchAfter(i,r),r.forEach(i=>{i.event&&s(i.event)})}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse(i=>i.dispose()),this._root=null,this}constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}}class ru{insert(i){i.low<=this.low?null===this.left?this.left=i:this.left.insert(i):null===this.right?this.right=i:this.right.insert(i)}search(i,s){i>this.max||(null!==this.left&&this.left.search(i,s),this.low<=i&&this.high>i&&s.push(this),this.low>i||null!==this.right&&this.right.search(i,s))}searchAfter(i,s){this.low>=i&&(s.push(this),null!==this.left&&this.left.searchAfter(i,s)),null!==this.right&&this.right.searchAfter(i,s)}traverse(i){i(this),null!==this.left&&this.left.traverse(i),null!==this.right&&this.right.traverse(i)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let i=0;return null!==this.left&&null!==this.right?i=this.left.height-this.right.height:null!==this.left?i=this.left.height+1:null!==this.right&&(i=-(this.right.height+1)),i}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(i){this._left=i,null!==i&&(i.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(i){this._right=i,null!==i&&(i.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}constructor(i,s,r){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=r,this.low=i,this.high=s,this.max=this.high}}class rh{static getDefaults(){return{callback:sM,once:!1,time:0}}get floatTime(){return this.time+this._remainderTime}invoke(i){if(this.callback){let s=this.transport.bpm.getDurationOfTicks(1,i);this.callback(i+this._remainderTime*s),this._once&&this.transport.clear(this.id)}}dispose(){return this.callback=void 0,this}constructor(i,s){this.id=rh._eventId++,this._remainderTime=0;let r=Object.assign(rh.getDefaults(),s);this.transport=i,this.callback=r.callback,this._once=r.once,this.time=Math.floor(r.time),this._remainderTime=r.time-this.time}}rh._eventId=0;class rc extends rh{static getDefaults(){return Object.assign({},rh.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(i){this._createEvents(i),super.invoke(i)}_createEvent(){return sv(this._nextTick,this.floatTime+this.duration)?this.transport.scheduleOnce(this.invoke.bind(this),new ra(this.context,this._nextTick).toSeconds()):-1}_createEvents(i){sv(this._nextTick+this._interval,this.floatTime+this.duration)&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new ra(this.context,this._nextTick).toSeconds()))}_restart(i){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.floatTime;let s=this.transport.getTicksAtTime(i);sg(s,this.time)&&(this._nextTick=this.floatTime+Math.ceil((s-this.floatTime)/this._interval)*this._interval),this._currentId=this._createEvent(),this._nextTick+=this._interval,this._nextId=this._createEvent()}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this.transport.off("ticks",this._boundRestart),this}constructor(i,s){super(i,s),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);let r=Object.assign(rc.getDefaults(),s);this.duration=r.duration,this._interval=r.interval,this._nextTick=r.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.transport.on("ticks",this._boundRestart),this.context=this.transport.context,this._restart()}}class rd extends sY{static getDefaults(){return Object.assign(sY.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(i,s){if(this._loop.get(i)&&s>=this._loopEnd&&(this.emit("loopEnd",i),this._clock.setTicksAtTime(this._loopStart,i),s=this._loopStart,this.emit("loopStart",i,this._clock.getSecondsAtTime(i)),this.emit("loop",i)),this._swingAmount>0&&s%this._ppq!=0&&s%(2*this._swingTicks)!=0){let r=s%(2*this._swingTicks)/(2*this._swingTicks),o=Math.sin(r*Math.PI)*this._swingAmount;i+=new ra(this.context,2*this._swingTicks/3).toSeconds()*o}ss=!0,this._timeline.forEachAtTime(s,s=>s.invoke(i)),ss=!1}schedule(i,s){let r=new rh(this,{callback:i,time:new sH(this.context,s).toTicks()});return this._addEvent(r,this._timeline)}scheduleRepeat(i,s,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,a=new rc(this,{callback:i,duration:new sU(this.context,o).toTicks(),interval:new sU(this.context,s).toTicks(),time:new sH(this.context,r).toTicks()});return this._addEvent(a,this._repeatedEvents)}scheduleOnce(i,s){let r=new rh(this,{callback:i,once:!0,time:new sH(this.context,s).toTicks()});return this._addEvent(r,this._timeline)}clear(i){if(this._scheduledEvents.hasOwnProperty(i)){let s=this._scheduledEvents[i.toString()];s.timeline.remove(s.event),s.event.dispose(),delete this._scheduledEvents[i.toString()]}return this}_addEvent(i,s){return this._scheduledEvents[i.id.toString()]={event:i,timeline:s},s.add(i),i.id}cancel(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=this.toTicks(i);return this._timeline.forEachFrom(s,i=>this.clear(i.id)),this._repeatedEvents.forEachFrom(s,i=>this.clear(i.id)),this}_bindClockEvents(){this._clock.on("start",(i,s)=>{s=new ra(this.context,s).toSeconds(),this.emit("start",i,s)}),this._clock.on("stop",i=>{this.emit("stop",i)}),this._clock.on("pause",i=>{this.emit("pause",i)})}get state(){return this._clock.getStateAtTime(this.now())}start(i,s){let r;return this.context.resume(),i8(s)&&(r=this.toTicks(s)),this._clock.start(i,r),this}stop(i){return this._clock.stop(i),this}pause(i){return this._clock.pause(i),this}toggle(i){return i=this.toSeconds(i),"started"!==this._clock.getStateAtTime(i)?this.start(i):this.stop(i),this}get timeSignature(){return this._timeSignature}set timeSignature(i){i7(i)&&(i=i[0]/i[1]*4),this._timeSignature=i}get loopStart(){return new sU(this.context,this._loopStart,"i").toSeconds()}set loopStart(i){this._loopStart=this.toTicks(i)}get loopEnd(){return new sU(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(i){this._loopEnd=this.toTicks(i)}get loop(){return this._loop.get(this.now())}set loop(i){this._loop.set(i,this.now())}setLoopPoints(i,s){return this.loopStart=i,this.loopEnd=s,this}get swing(){return this._swingAmount}set swing(i){this._swingAmount=i}get swingSubdivision(){return new ra(this.context,this._swingTicks).toNotation()}set swingSubdivision(i){this._swingTicks=this.toTicks(i)}get position(){let i=this.now(),s=this._clock.getTicksAtTime(i);return new ra(this.context,s).toBarsBeatsSixteenths()}set position(i){let s=this.toTicks(i);this.ticks=s}get seconds(){return this._clock.seconds}set seconds(i){let s=this.now(),r=this._clock.frequency.timeToTicks(i,s);this.ticks=r}get progress(){if(this.loop){let i=this.now();return(this._clock.getTicksAtTime(i)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(i){if(this._clock.ticks!==i){let s=this.now();if("started"===this.state){let r=this._clock.getTicksAtTime(s),o=s+this._clock.frequency.getDurationOfTicks(Math.ceil(r)-r,s);this.emit("stop",o),this._clock.setTicksAtTime(i,o),this.emit("start",o,this._clock.getSecondsAtTime(o))}else this.emit("ticks",s),this._clock.setTicksAtTime(i,s)}}getTicksAtTime(i){return this._clock.getTicksAtTime(i)}getSecondsAtTime(i){return this._clock.getSecondsAtTime(i)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(i){this._clock.frequency.multiplier=i}nextSubdivision(i){if(i=this.toTicks(i),"started"!==this.state)return 0;{let s=this.now(),r=i-this.getTicksAtTime(s)%i;return this._clock.nextTickTime(r,s)}}syncSignal(i,s){let r=this.now(),o=this.bpm,a=1/(60/o.getValueAtTime(r)/this.PPQ),l=[];if("time"===i.units){let i=1/64/a,s=new s1(i),r=new ro(-1),u=new s1(i);o.chain(s,r,u),o=u,a=1/a,l=[s,r,u]}s||(s=0!==i.getValueAtTime(r)?i.getValueAtTime(r)/a:0);let u=new s1(s);return o.connect(u),u.connect(i._param),l.push(u),this._syncedSignals.push({initial:i.value,nodes:l,signal:i}),i.value=0,this}unsyncSignal(i){for(let s=this._syncedSignals.length-1;s>=0;s--){let r=this._syncedSignals[s];r.signal===i&&(r.nodes.forEach(i=>i.dispose()),r.signal.value=r.initial,this._syncedSignals.splice(s,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),function i(s,r){i7(r)?r.forEach(r=>i(s,r)):Object.defineProperty(s,r,{writable:!0})}(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}constructor(){super(sd(rd.getDefaults(),arguments)),this.name="Transport",this._loop=new ri(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new sb,this._repeatedEvents=new rl,this._syncedSignals=[],this._swingAmount=0;let i=sd(rd.getDefaults(),arguments);this._ppq=i.ppq,this._clock=new s9({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=i.ppq,this.bpm.setValueAtTime(i.bpm,0),sE(this,"bpm"),this._timeSignature=i.timeSignature,this._swingTicks=i.ppq/2}}sS.mixin(rd),sw(i=>{i.transport=new rd({context:i})}),sC(i=>{i.transport.dispose()});class rp extends s${static getDefaults(){return Object.assign(s$.getDefaults(),{mute:!1,onstop:sM,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(i){this._volume.mute=i}_clampToCurrentTime(i){return this._synced?i:Math.max(i,this.context.currentTime)}start(i,s,r){let o=i4(i)&&this._synced?this.context.transport.seconds:this.toSeconds(i);if(o=this._clampToCurrentTime(o),this._synced||"started"!==this._state.getValueAtTime(o)){if(this.log("start",o),this._state.setStateAtTime("started",o),this._synced){let i=this._state.get(o);i&&(i.offset=this.toSeconds(sp(s,0)),i.duration=r?this.toSeconds(r):void 0);let a=this.context.transport.schedule(i=>{this._start(i,s,r)},o);this._scheduled.push(a),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>o&&this._syncedStart(this.now(),this.context.transport.seconds)}else si(this.context),this._start(o,s,r)}else se(sg(o,this._state.get(o).time),"Start time must be strictly greater than previous start time"),this._state.cancel(o),this._state.setStateAtTime("started",o),this.log("restart",o),this.restart(o,s,r);return this}stop(i){let s=i4(i)&&this._synced?this.context.transport.seconds:this.toSeconds(i);if(s=this._clampToCurrentTime(s),"started"===this._state.getValueAtTime(s)||i8(this._state.getNextState("started",s))){if(this.log("stop",s),this._synced){let i=this.context.transport.schedule(this._stop.bind(this),s);this._scheduled.push(i)}else this._stop(s);this._state.cancel(s),this._state.setStateAtTime("stopped",s)}return this}restart(i,s,r){return i=this.toSeconds(i),"started"===this._state.getValueAtTime(i)&&(this._state.cancel(i),this._restart(i,s,r)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(i,s)=>{if(sg(s,0)){let r=this._state.get(s);if(r&&"started"===r.state&&r.time!==s){let o;let a=s-this.toSeconds(r.time);r.duration&&(o=this.toSeconds(r.duration)-a),this._start(i,this.toSeconds(r.offset)+a,o)}}},this._syncedStop=i=>{let s=this.context.transport.getSecondsAtTime(Math.max(i-this.sampleTime,0));"started"===this._state.getValueAtTime(s)&&this._stop(i)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(i=>this.context.transport.clear(i)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=sM,this.unsync(),this._volume.dispose(),this._state.dispose(),this}constructor(i){super(i),this.input=void 0,this._state=new sJ("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=sM,this._syncedStop=sM,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new re({context:this.context,mute:i.mute,volume:i.volume}),this.volume=this._volume.volume,sE(this,"volume"),this.onstop=i.onstop}}function rf(i,s){return K(this,void 0,void 0,function*(){let r=s/i.context.sampleRate,o=new sD(1,r,i.context.sampleRate);return new i.constructor(Object.assign(i.get(),{frequency:2/r,detune:0,context:o})).toDestination().start(0),(yield o.render()).getChannelData(0)})}class rm extends s2{static getDefaults(){return Object.assign(s2.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(i){let s=this.toSeconds(i);return this.log("start",s),this._startGain(s),this._oscillator.start(s),this}_stopSource(i){this._oscillator.stop(i)}setPeriodicWave(i){return this._oscillator.setPeriodicWave(i),this}get type(){return this._oscillator.type}set type(i){this._oscillator.type=i}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}constructor(){super(sd(rm.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];let i=sd(rm.getDefaults(),arguments,["frequency","type"]);s0(this._oscillator,this._gainNode),this.type=i.type,this.frequency=new sQ({context:this.context,param:this._oscillator.frequency,units:"frequency",value:i.frequency}),this.detune=new sQ({context:this.context,param:this._oscillator.detune,units:"cents",value:i.detune}),sE(this,["frequency","detune"])}}class rg extends rp{static getDefaults(){return Object.assign(rp.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(i){let s=this.toSeconds(i),r=new rm({context:this.context,onended:()=>this.onstop(this)});this._oscillator=r,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(s)}_stop(i){let s=this.toSeconds(i);this._oscillator&&this._oscillator.stop(s)}_restart(i){let s=this.toSeconds(i);return this.log("restart",s),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(s),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type)return rg._periodicWaveCache.find(i=>{var s,r;return i.phase===this._phase&&(s=i.partials,r=this._partials,s.length===r.length&&s.every((i,s)=>r[s]===i))});{let i=rg._periodicWaveCache.find(i=>i.type===this._type&&i.phase===this._phase);return this._partialCount=i?i.partialCount:this._partialCount,i}}get type(){return this._type}set type(i){this._type=i;let s=-1!==["sine","square","sawtooth","triangle"].indexOf(i);if(0===this._phase&&s)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=i);else{let s=this._getCachedPeriodicWave();if(i8(s)){let{partials:i,wave:r}=s;this._wave=r,this._partials=i,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{let[s,r]=this._getRealImaginary(i,this._phase),o=this.context.createPeriodicWave(s,r);this._wave=o,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),rg._periodicWaveCache.push({imag:r,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:s,type:this._type,wave:this._wave}),rg._periodicWaveCache.length>100&&rg._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(i){this.partialCount&&"custom"!==this._type&&"custom"!==i?this.type=i+this.partialCount:this.type=i}get partialCount(){return this._partialCount}set partialCount(i){sn(i,0);let s=this._type,r=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(r&&(s=r[1]),"custom"!==this._type)this.type=0===i?s:s+i.toString();else{let s=new Float32Array(i);this._partials.forEach((i,r)=>s[r]=i),this._partials=Array.from(s),this.type=this._type}}_getRealImaginary(i,s){let r=2048,o=new Float32Array(r),a=new Float32Array(r),l=1;if("custom"===i){if(l=this._partials.length+1,this._partialCount=this._partials.length,r=l,0===this._partials.length)return[o,a]}else{let s=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(i);s?(l=parseInt(s[2],10)+1,this._partialCount=parseInt(s[2],10),i=s[1],r=l=Math.max(l,2)):this._partialCount=0,this._partials=[]}for(let u=1;u<r;++u){let r;let h=2/(u*Math.PI);switch(i){case"sine":r=u<=l?1:0,this._partials[u-1]=r;break;case"square":r=1&u?2*h:0,this._partials[u-1]=r;break;case"sawtooth":r=h*(1&u?1:-1),this._partials[u-1]=r;break;case"triangle":r=1&u?h*h*2*(u-1>>1&1?-1:1):0,this._partials[u-1]=r;break;case"custom":r=this._partials[u-1];break;default:throw TypeError("Oscillator: invalid type: "+i)}0!==r?(o[u]=-r*Math.sin(s*u),a[u]=r*Math.cos(s*u)):(o[u]=0,a[u]=0)}return[o,a]}_inverseFFT(i,s,r){let o=0,a=i.length;for(let l=0;l<a;l++)o+=i[l]*Math.cos(l*r)+s[l]*Math.sin(l*r);return o}getInitialValue(){let[i,s]=this._getRealImaginary(this._type,0),r=0,o=2*Math.PI;for(let a=0;a<32;a++)r=Math.max(this._inverseFFT(i,s,a/32*o),r);return Math.max(Math.min(-this._inverseFFT(i,s,this._phase)/r,1),-1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(i){this._partials=i,this._partialCount=this._partials.length,i.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(i){this._phase=i*Math.PI/180,this.type=this._type}asArray(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return K(this,void 0,void 0,function*(){return rf(this,i)})}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}constructor(){super(sd(rg.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;let i=sd(rg.getDefaults(),arguments,["frequency","type"]);this.frequency=new s4({context:this.context,units:"frequency",value:i.frequency}),sE(this,"frequency"),this.detune=new s4({context:this.context,units:"cents",value:i.detune}),sE(this,"detune"),this._partials=i.partials,this._partialCount=i.partialCount,this._type=i.type,i.partialCount&&"custom"!==i.type&&(this._type=this.baseType+i.partialCount.toString()),this.phase=i.phase}}rg._periodicWaveCache=[];class r_ extends s2{static getDefaults(){return Object.assign(s2.getDefaults(),{url:new sI,loop:!1,loopEnd:0,loopStart:0,onload:sM,onerror:sM,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(i){this._fadeIn=i}get fadeOut(){return this._fadeOut}set fadeOut(i){this._fadeOut=i}get curve(){return this._curve}set curve(i){this._curve=i}start(i,s,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;se(this.buffer.loaded,"buffer is either not set or not loaded");let a=this.toSeconds(i);this._startGain(a,o),s=this.loop?sp(s,this.loopStart):sp(s,0);let l=Math.max(this.toSeconds(s),0);if(this.loop){let i=this.toSeconds(this.loopEnd)||this.buffer.duration,s=this.toSeconds(this.loopStart),r=i-s;s_(l,i)&&(l=(l-s)%r+s),sy(l,this.buffer.duration)&&(l=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,sv(l,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(a,l)),i8(r)){let i=this.toSeconds(r);i=Math.max(i,0),this.stop(a+i)}return this}_stopSource(i){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(i)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(i){this._source.loopStart=this.toSeconds(i)}get loopEnd(){return this._source.loopEnd}set loopEnd(i){this._source.loopEnd=this.toSeconds(i)}get buffer(){return this._buffer}set buffer(i){this._buffer.set(i)}get loop(){return this._source.loop}set loop(i){this._source.loop=i,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}constructor(){super(sd(r_.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;let i=sd(r_.getDefaults(),arguments,["url","onload"]);s0(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new sQ({context:this.context,param:this._source.playbackRate,units:"positive",value:i.playbackRate}),this.loop=i.loop,this.loopStart=i.loopStart,this.loopEnd=i.loopEnd,this._buffer=new sI(i.url,i.onload,i.onerror),this._internalChannels.push(this._source)}}function rv(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,r=new WeakMap;return function(o,a){Reflect.defineProperty(o,a,{configurable:!0,enumerable:!0,get:function(){return r.get(this)},set:function(o){sn(o,i,s),r.set(this,o)}})}}function ry(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,r=new WeakMap;return function(o,a){Reflect.defineProperty(o,a,{configurable:!0,enumerable:!0,get:function(){return r.get(this)},set:function(o){sn(this.toSeconds(o),i,s),r.set(this,o)}})}}class rb extends rp{static getDefaults(){return Object.assign(rp.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:sM,onerror:sM,playbackRate:1,reverse:!1})}load(i){return K(this,void 0,void 0,function*(){return yield this._buffer.load(i),this._onload(),this})}_onload(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:sM;i(),this.autostart&&this.start()}_onSourceEnd(i){this.onstop(this),this._activeSources.delete(i),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(i,s,r){return super.start(i,s,r),this}_start(i,s,r){s=this._loop?sp(s,this._loopStart):sp(s,0);let o=this.toSeconds(s),a=r;r=sp(r,Math.max(this._buffer.duration-o,0));let l=this.toSeconds(r);l/=this._playbackRate,i=this.toSeconds(i);let u=new r_({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(i+l),this._state.setStateAtTime("stopped",i+l,{implicitEnd:!0})),this._activeSources.add(u),this._loop&&i4(a)?u.start(i,o):u.start(i,o,l-this.toSeconds(this.fadeOut))}_stop(i){let s=this.toSeconds(i);this._activeSources.forEach(i=>i.stop(s))}restart(i,s,r){return super.restart(i,s,r),this}_restart(i,s,r){var o;null===(o=[...this._activeSources].pop())||void 0===o||o.stop(i),this._start(i,s,r)}seek(i,s){let r=this.toSeconds(s);if("started"===this._state.getValueAtTime(r)){let s=this.toSeconds(i);this._stop(r),this._start(r,s)}return this}setLoopPoints(i,s){return this.loopStart=i,this.loopEnd=s,this}get loopStart(){return this._loopStart}set loopStart(i){this._loopStart=i,this.buffer.loaded&&sn(this.toSeconds(i),0,this.buffer.duration),this._activeSources.forEach(s=>{s.loopStart=i})}get loopEnd(){return this._loopEnd}set loopEnd(i){this._loopEnd=i,this.buffer.loaded&&sn(this.toSeconds(i),0,this.buffer.duration),this._activeSources.forEach(s=>{s.loopEnd=i})}get buffer(){return this._buffer}set buffer(i){this._buffer.set(i)}get loop(){return this._loop}set loop(i){if(this._loop!==i&&(this._loop=i,this._activeSources.forEach(s=>{s.loop=i}),i)){let i=this._state.getNextState("stopped",this.now());i&&this._state.cancel(i.time)}}get playbackRate(){return this._playbackRate}set playbackRate(i){this._playbackRate=i;let s=this.now(),r=this._state.getNextState("stopped",s);r&&r.implicitEnd&&(this._state.cancel(r.time),this._activeSources.forEach(i=>i.cancelStop())),this._activeSources.forEach(r=>{r.playbackRate.setValueAtTime(i,s)})}get reverse(){return this._buffer.reverse}set reverse(i){this._buffer.reverse=i}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(i=>i.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}constructor(){super(sd(rb.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;let i=sd(rb.getDefaults(),arguments,["url","onload"]);this._buffer=new sI({onload:this._onload.bind(this,i.onload),onerror:i.onerror,reverse:i.reverse,url:i.url}),this.autostart=i.autostart,this._loop=i.loop,this._loopStart=i.loopStart,this._loopEnd=i.loopEnd,this._playbackRate=i.playbackRate,this.fadeIn=i.fadeIn,this.fadeOut=i.fadeOut}}$([ry(0)],rb.prototype,"fadeIn",void 0),$([ry(0)],rb.prototype,"fadeOut",void 0);class rx extends s${static getDefaults(){return Object.assign(s$.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(i,s){if(i9(i))return i;{let r;for(r in rw)if(rw[r][s]===i)return r;return i}}_setCurve(i,s,r){if(i9(r)&&Reflect.has(rw,r)){let o=rw[r];i5(o)?"_decayCurve"!==i&&(this[i]=o[s]):this[i]=o}else{if(!i7(r)||"_decayCurve"===i)throw Error("Envelope: invalid curve: "+r);this[i]=r}}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(i){this._setCurve("_attackCurve","In",i)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(i){this._setCurve("_releaseCurve","Out",i)}get decayCurve(){return this._getCurve(this._decayCurve,"Out")}set decayCurve(i){this._setCurve("_decayCurve","Out",i)}triggerAttack(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.log("triggerAttack",i,s),i=this.toSeconds(i);let r=this.toSeconds(this.attack),o=this.toSeconds(this.decay),a=this.getValueAtTime(i);if(a>0&&(r=(1-a)/(1/r)),r<this.sampleTime)this._sig.cancelScheduledValues(i),this._sig.setValueAtTime(s,i);else if("linear"===this._attackCurve)this._sig.linearRampTo(s,r,i);else if("exponential"===this._attackCurve)this._sig.targetRampTo(s,r,i);else{this._sig.cancelAndHoldAtTime(i);let o=this._attackCurve;for(let i=1;i<o.length;i++)if(o[i-1]<=a&&a<=o[i]){(o=this._attackCurve.slice(i))[0]=a;break}this._sig.setValueCurveAtTime(o,i,r,s)}if(o&&this.sustain<1){let a=s*this.sustain,l=i+r;this.log("decay",l),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(a,o+l):this._sig.exponentialApproachValueAtTime(a,l,o)}return this}triggerRelease(i){this.log("triggerRelease",i),i=this.toSeconds(i);let s=this.getValueAtTime(i);if(s>0){let r=this.toSeconds(this.release);r<this.sampleTime?this._sig.setValueAtTime(0,i):"linear"===this._releaseCurve?this._sig.linearRampTo(0,r,i):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,r,i):(se(i7(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(i),this._sig.setValueCurveAtTime(this._releaseCurve,i,r,s))}return this}getValueAtTime(i){return this._sig.getValueAtTime(i)}triggerAttackRelease(i,s){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return s=this.toSeconds(s),this.triggerAttack(s,r),this.triggerRelease(s+this.toSeconds(i)),this}cancel(i){return this._sig.cancelScheduledValues(this.toSeconds(i)),this}connect(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return s8(this,i,s,r),this}asArray(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return K(this,void 0,void 0,function*(){let s=i/this.context.sampleRate,r=new sD(1,s,this.context.sampleRate),o=this.toSeconds(this.attack)+this.toSeconds(this.decay),a=o+this.toSeconds(this.release),l=.1*a,u=a+l,h=new this.constructor(Object.assign(this.get(),{attack:s*this.toSeconds(this.attack)/u,decay:s*this.toSeconds(this.decay)/u,release:s*this.toSeconds(this.release)/u,context:r}));return h._sig.toDestination(),h.triggerAttackRelease(s*(o+l)/u,0),(yield r.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}constructor(){super(sd(rx.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new s4({context:this.context,value:0}),this.output=this._sig,this.input=void 0;let i=sd(rx.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=i.attack,this.decay=i.decay,this.sustain=i.sustain,this.release=i.release,this.attackCurve=i.attackCurve,this.releaseCurve=i.releaseCurve,this.decayCurve=i.decayCurve}}$([ry(0)],rx.prototype,"attack",void 0),$([ry(0)],rx.prototype,"decay",void 0),$([rv(0,1)],rx.prototype,"sustain",void 0),$([ry(0)],rx.prototype,"release",void 0);let rw=(()=>{let i,s;let r=[];for(i=0;i<128;i++)r[i]=Math.sin(i/127*(Math.PI/2));let o=[];for(i=0;i<127;i++){s=i/127;let r=Math.sin(s*(2*Math.PI)*6.4-Math.PI/2)+1;o[i]=r/10+.83*s}o[127]=1;let a=[];for(i=0;i<128;i++)a[i]=Math.ceil(i/127*5)/5;let l=[];for(i=0;i<128;i++)s=i/127,l[i]=.5*(1-Math.cos(Math.PI*s));let u=[];for(i=0;i<128;i++){s=i/127;let r=4*Math.pow(s,3)+.2,o=Math.cos(r*Math.PI*2*s);u[i]=Math.abs(o*(1-s))}function h(i){let s=Array(i.length);for(let r=0;r<i.length;r++)s[r]=1-i[r];return s}return{bounce:{In:h(u),Out:u},cosine:{In:r,Out:r.slice(0).reverse()},exponential:"exponential",linear:"linear",ripple:{In:o,Out:h(o)},sine:{In:l,Out:h(l)},step:{In:a,Out:h(a)}}})();class rT extends s${static getDefaults(){return Object.assign(s$.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}_syncState(){let i=!1;return this._synced||(this._synced=!0,i=!0),i}_syncMethod(i,s){var r=this;let o=this["_original_"+i]=this[i];this[i]=function(){for(var i=arguments.length,a=Array(i),l=0;l<i;l++)a[l]=arguments[l];let u=a[s],h=r.context.transport.schedule(i=>{a[s]=i,o.apply(r,a)},u);r._scheduledEvents.push(h)}}unsync(){return this._scheduledEvents.forEach(i=>this.context.transport.clear(i)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease,this.context.transport.off("stop",this._syncedRelease),this.context.transport.off("pause",this._syncedRelease),this.context.transport.off("loopEnd",this._syncedRelease)),this}triggerAttackRelease(i,s,r,o){let a=this.toSeconds(r),l=this.toSeconds(s);return this.triggerAttack(i,a,o),this.triggerRelease(a+l),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}constructor(){super(sd(rT.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease,this._syncedRelease=i=>this._original_triggerRelease(i);let i=sd(rT.getDefaults(),arguments);this._volume=this.output=new re({context:this.context,volume:i.volume}),this.volume=this._volume.volume,sE(this,"volume")}}class rC extends rT{static getDefaults(){return Object.assign(rT.getDefaults(),{detune:0,onsilence:sM,portamento:0})}triggerAttack(i,s){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.log("triggerAttack",i,s,r);let o=this.toSeconds(s);return this._triggerEnvelopeAttack(o,r),this.setNote(i,o),this}triggerRelease(i){this.log("triggerRelease",i);let s=this.toSeconds(i);return this._triggerEnvelopeRelease(s),this}setNote(i,s){let r=this.toSeconds(s),o=i instanceof sG?i.toFrequency():i;if(this.portamento>0&&this.getLevelAtTime(r)>.05){let i=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(o,i,r)}else this.frequency.setValueAtTime(o,r);return this}constructor(){super(sd(rC.getDefaults(),arguments));let i=sd(rC.getDefaults(),arguments);this.portamento=i.portamento,this.onsilence=i.onsilence}}$([ry(0)],rC.prototype,"portamento",void 0);class rS extends rx{dispose(){return super.dispose(),this._gainNode.dispose(),this}constructor(){super(sd(rS.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new s1({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}}class rA extends rs{dispose(){return super.dispose(),this._norm.dispose(),this}constructor(){super(...arguments),this.name="AudioToGain",this._norm=new rr({context:this.context,mapping:i=>(i+1)/2}),this.input=this._norm,this.output=this._norm}}class rk extends s4{static getDefaults(){return Object.assign(s4.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}constructor(){super(Object.assign(sd(rk.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;let i=sd(rk.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new s1({context:this.context,minValue:i.minValue,maxValue:i.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(i.value,0)}}class rO extends rp{static getDefaults(){return Object.assign(rg.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(i){this._modulator.start(i),this._carrier.start(i)}_stop(i){this._modulator.stop(i),this._carrier.stop(i)}_restart(i){this._modulator.restart(i),this._carrier.restart(i)}get type(){return this._carrier.type}set type(i){this._carrier.type=i}get baseType(){return this._carrier.baseType}set baseType(i){this._carrier.baseType=i}get partialCount(){return this._carrier.partialCount}set partialCount(i){this._carrier.partialCount=i}get modulationType(){return this._modulator.type}set modulationType(i){this._modulator.type=i}get phase(){return this._carrier.phase}set phase(i){this._carrier.phase=i,this._modulator.phase=i}get partials(){return this._carrier.partials}set partials(i){this._carrier.partials=i}asArray(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return K(this,void 0,void 0,function*(){return rf(this,i)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}constructor(){super(sd(rO.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new rA({context:this.context}),this._modulationNode=new s1({context:this.context});let i=sd(rO.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new rg({context:this.context,detune:i.detune,frequency:i.frequency,onstop:()=>this.onstop(this),phase:i.phase,type:i.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new rg({context:this.context,phase:i.phase,type:i.modulationType}),this.harmonicity=new rk({context:this.context,units:"positive",value:i.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),sE(this,["frequency","detune","harmonicity"])}}class rE extends rp{static getDefaults(){return Object.assign(rg.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(i){i=this.toSeconds(i),this._forEach(s=>s.start(i))}_stop(i){i=this.toSeconds(i),this._forEach(s=>s.stop(i))}_restart(i){this._forEach(s=>s.restart(i))}_forEach(i){for(let s=0;s<this._oscillators.length;s++)i(this._oscillators[s],s)}get type(){return this._type}set type(i){this._type=i,this._forEach(s=>s.type=i)}get spread(){return this._spread}set spread(i){if(this._spread=i,this._oscillators.length>1){let s=-i/2,r=i/(this._oscillators.length-1);this._forEach((i,o)=>i.detune.value=s+r*o)}}get count(){return this._oscillators.length}set count(i){if(sn(i,1),this._oscillators.length!==i){this._forEach(i=>i.dispose()),this._oscillators=[];for(let s=0;s<i;s++){let r=new rg({context:this.context,volume:-6-1.1*i,type:this._type,phase:this._phase+s/i*360,partialCount:this._partialCount,onstop:0===s?()=>this.onstop(this):sM});"custom"===this.type&&(r.partials=this._partials),this.frequency.connect(r.frequency),this.detune.connect(r.detune),r.detune.overridden=!1,r.connect(this.output),this._oscillators[s]=r}this.spread=this._spread,"started"===this.state&&this._forEach(i=>i.start())}}get phase(){return this._phase}set phase(i){this._phase=i,this._forEach((i,s)=>i.phase=this._phase+s/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(i){this._forEach(s=>s.baseType=i),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(i){this._partials=i,this._partialCount=this._partials.length,i.length&&(this._type="custom",this._forEach(s=>s.partials=i))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(i){this._partialCount=i,this._forEach(s=>s.partialCount=i),this._type=this._oscillators[0].type}asArray(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return K(this,void 0,void 0,function*(){return rf(this,i)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(i=>i.dispose()),this}constructor(){super(sd(rE.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];let i=sd(rE.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new s4({context:this.context,units:"frequency",value:i.frequency}),this.detune=new s4({context:this.context,units:"cents",value:i.detune}),this._spread=i.spread,this._type=i.type,this._phase=i.phase,this._partials=i.partials,this._partialCount=i.partialCount,this.count=i.count,sE(this,["frequency","detune"])}}class rM extends rp{static getDefaults(){return Object.assign(rg.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(i){this._modulator.start(i),this._carrier.start(i)}_stop(i){this._modulator.stop(i),this._carrier.stop(i)}_restart(i){return this._modulator.restart(i),this._carrier.restart(i),this}get type(){return this._carrier.type}set type(i){this._carrier.type=i}get baseType(){return this._carrier.baseType}set baseType(i){this._carrier.baseType=i}get partialCount(){return this._carrier.partialCount}set partialCount(i){this._carrier.partialCount=i}get modulationType(){return this._modulator.type}set modulationType(i){this._modulator.type=i}get phase(){return this._carrier.phase}set phase(i){this._carrier.phase=i,this._modulator.phase=i}get partials(){return this._carrier.partials}set partials(i){this._carrier.partials=i}asArray(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return K(this,void 0,void 0,function*(){return rf(this,i)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}constructor(){super(sd(rM.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new s1({context:this.context,gain:0});let i=sd(rM.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new rg({context:this.context,detune:i.detune,frequency:0,onstop:()=>this.onstop(this),phase:i.phase,type:i.type}),this.detune=this._carrier.detune,this.frequency=new s4({context:this.context,units:"frequency",value:i.frequency}),this._modulator=new rg({context:this.context,phase:i.phase,type:i.modulationType}),this.harmonicity=new rk({context:this.context,units:"positive",value:i.harmonicity}),this.modulationIndex=new rk({context:this.context,units:"positive",value:i.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),sE(this,["modulationIndex","frequency","detune","harmonicity"])}}class rI extends rp{static getDefaults(){return Object.assign(rp.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(i){i=this.toSeconds(i),this._triangle.start(i),this._widthGate.gain.setValueAtTime(1,i)}_stop(i){i=this.toSeconds(i),this._triangle.stop(i),this._widthGate.gain.cancelScheduledValues(i),this._widthGate.gain.setValueAtTime(0,i)}_restart(i){this._triangle.restart(i),this._widthGate.gain.cancelScheduledValues(i),this._widthGate.gain.setValueAtTime(1,i)}get phase(){return this._triangle.phase}set phase(i){this._triangle.phase=i}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(i){this._triangle.type=i}asArray(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return K(this,void 0,void 0,function*(){return rf(this,i)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}constructor(){super(sd(rI.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new s1({context:this.context,gain:0}),this._thresh=new rr({context:this.context,mapping:i=>i<=0?-1:1});let i=sd(rI.getDefaults(),arguments,["frequency","width"]);this.width=new s4({context:this.context,units:"audioRange",value:i.width}),this._triangle=new rg({context:this.context,detune:i.detune,frequency:i.frequency,onstop:()=>this.onstop(this),phase:i.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),sE(this,["width","frequency","detune"])}}class rD extends rp{static getDefaults(){return Object.assign(rp.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(i){i=this.toSeconds(i),this._modulator.start(i),this._pulse.start(i)}_stop(i){i=this.toSeconds(i),this._modulator.stop(i),this._pulse.stop(i)}_restart(i){this._modulator.restart(i),this._pulse.restart(i)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(i){this._modulator.phase=i}asArray(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return K(this,void 0,void 0,function*(){return rf(this,i)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}constructor(){super(sd(rD.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new rk({context:this.context,value:2});let i=sd(rD.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new rI({context:this.context,frequency:i.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new rg({context:this.context,detune:i.detune,frequency:i.frequency,onstop:()=>this.onstop(this),phase:i.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),sE(this,["modulationFrequency","frequency","detune"])}}let rR={am:rO,fat:rE,fm:rM,oscillator:rg,pulse:rI,pwm:rD};class rP extends rp{static getDefaults(){return Object.assign(rg.getDefaults(),rM.getDefaults(),rO.getDefaults(),rE.getDefaults(),rI.getDefaults(),rD.getDefaults())}_start(i){this._oscillator.start(i)}_stop(i){this._oscillator.stop(i)}_restart(i){return this._oscillator.restart(i),this}get type(){let i="";return["am","fm","fat"].some(i=>this._sourceType===i)&&(i=this._sourceType),i+this._oscillator.type}set type(i){"fm"===i.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=i.substr(2)):"am"===i.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=i.substr(2)):"fat"===i.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=i.substr(3)):"pwm"===i?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===i?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=i)}get partials(){return this._oscillator.partials}set partials(i){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=i)}get partialCount(){return this._oscillator.partialCount}set partialCount(i){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=i)}set(i){return Reflect.has(i,"type")&&i.type&&(this.type=i.type),super.set(i),this}_createNewOscillator(i){if(i!==this._sourceType){this._sourceType=i;let s=rR[i],r=this.now();if(this._oscillator){let i=this._oscillator;i.stop(r),this.context.setTimeout(()=>i.dispose(),this.blockTime)}this._oscillator=new s({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(r)}}get phase(){return this._oscillator.phase}set phase(i){this._oscillator.phase=i}get sourceType(){return this._sourceType}set sourceType(i){let s="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(s=this._oscillator.type),"fm"===i?this.type="fm"+s:"am"===i?this.type="am"+s:"fat"===i?this.type="fat"+s:"oscillator"===i?this.type=s:"pulse"===i?this.type="pulse":"pwm"===i&&(this.type="pwm")}_getOscType(i,s){return i instanceof rR[s]}get baseType(){return this._oscillator.baseType}set baseType(i){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===i||"pwm"===i||(this._oscillator.baseType=i)}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0}set count(i){this._getOscType(this._oscillator,"fat")&&i6(i)&&(this._oscillator.count=i)}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0}set spread(i){this._getOscType(this._oscillator,"fat")&&i6(i)&&(this._oscillator.spread=i)}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0}set modulationType(i){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&i9(i)&&(this._oscillator.modulationType=i)}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}asArray(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return K(this,void 0,void 0,function*(){return rf(this,i)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}constructor(){super(sd(rP.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";let i=sd(rP.getDefaults(),arguments,["frequency","type"]);this.frequency=new s4({context:this.context,units:"frequency",value:i.frequency}),this.detune=new s4({context:this.context,units:"cents",value:i.detune}),sE(this,["frequency","detune"]),this.set(i)}}class rN extends rC{static getDefaults(){return Object.assign(rC.getDefaults(),{envelope:Object.assign(sf(rx.getDefaults(),Object.keys(s$.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(sf(rP.getDefaults(),[...Object.keys(rp.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(i,s){if(this.envelope.triggerAttack(i,s),this.oscillator.start(i),0===this.envelope.sustain){let s=this.toSeconds(this.envelope.attack),r=this.toSeconds(this.envelope.decay);this.oscillator.stop(i+s+r)}}_triggerEnvelopeRelease(i){this.envelope.triggerRelease(i),this.oscillator.stop(i+this.toSeconds(this.envelope.release))}getLevelAtTime(i){return i=this.toSeconds(i),this.envelope.getValueAtTime(i)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}constructor(){super(sd(rN.getDefaults(),arguments)),this.name="Synth";let i=sd(rN.getDefaults(),arguments);this.oscillator=new rP(Object.assign({context:this.context,detune:i.detune,onstop:()=>this.onsilence(this)},i.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new rS(Object.assign({context:this.context},i.envelope)),this.oscillator.chain(this.envelope,this.output),sE(this,["oscillator","frequency","detune","envelope"])}}class rV extends rN{static getDefaults(){return sc(rC.getDefaults(),rN.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(i,s){let r=this.toSeconds(s),o=this.toFrequency(i instanceof sG?i.toFrequency():i),a=o*this.octaves;return this.oscillator.frequency.setValueAtTime(a,r),this.oscillator.frequency.exponentialRampToValueAtTime(o,r+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}constructor(){super(sd(rV.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;let i=sd(rV.getDefaults(),arguments);this.pitchDecay=i.pitchDecay,this.octaves=i.octaves,sE(this,["oscillator","envelope"])}}$([rv(0)],rV.prototype,"octaves",void 0),$([ry(0)],rV.prototype,"pitchDecay",void 0);let rj=new Set;function rq(i,s){let r='registerProcessor("'.concat(i,'", ').concat(s,")");rj.add(r)}rj.add('\n	/**\n	 * The base AudioWorkletProcessor for use in Tone.js. Works with the {@link ToneAudioWorklet}. \n	 */\n	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n		constructor(options) {\n			\n			super(options);\n			/**\n			 * If the processor was disposed or not. Keep alive until it\'s disposed.\n			 */\n			this.disposed = false;\n		   	/** \n			 * The number of samples in the processing block\n			 */\n			this.blockSize = 128;\n			/**\n			 * the sample rate\n			 */\n			this.sampleRate = sampleRate;\n\n			this.port.onmessage = (event) => {\n				// when it receives a dispose \n				if (event.data === "dispose") {\n					this.disposed = true;\n				}\n			};\n		}\n	}\n'),rj.add("\n	/**\n	 * Abstract class for a single input/output processor. \n	 * has a 'generate' function which processes one sample at a time\n	 */\n	class SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n		constructor(options) {\n			super(Object.assign(options, {\n				numberOfInputs: 1,\n				numberOfOutputs: 1\n			}));\n			/**\n			 * Holds the name of the parameter and a single value of that\n			 * parameter at the current sample\n			 * @type { [name: string]: number }\n			 */\n			this.params = {}\n		}\n\n		/**\n		 * Generate an output sample from the input sample and parameters\n		 * @abstract\n		 * @param input number\n		 * @param channel number\n		 * @param parameters { [name: string]: number }\n		 * @returns number\n		 */\n		generate(){}\n\n		/**\n		 * Update the private params object with the \n		 * values of the parameters at the given index\n		 * @param parameters { [name: string]: Float32Array },\n		 * @param index number\n		 */\n		updateParams(parameters, index) {\n			for (const paramName in parameters) {\n				const param = parameters[paramName];\n				if (param.length > 1) {\n					this.params[paramName] = parameters[paramName][index];\n				} else {\n					this.params[paramName] = parameters[paramName][0];\n				}\n			}\n		}\n\n		/**\n		 * Process a single frame of the audio\n		 * @param inputs Float32Array[][]\n		 * @param outputs Float32Array[][]\n		 */\n		process(inputs, outputs, parameters) {\n			const input = inputs[0];\n			const output = outputs[0];\n			// get the parameter values\n			const channelCount = Math.max(input && input.length || 0, output.length);\n			for (let sample = 0; sample < this.blockSize; sample++) {\n				this.updateParams(parameters, sample);\n				for (let channel = 0; channel < channelCount; channel++) {\n					const inputSample = input && input.length ? input[channel][sample] : 0;\n					output[channel][sample] = this.generate(inputSample, channel, this.params);\n				}\n			}\n			return !this.disposed;\n		}\n	};\n"),rj.add("\n	/**\n	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n	 */\n	class DelayLine {\n		\n		constructor(size, channels) {\n			this.buffer = [];\n			this.writeHead = []\n			this.size = size;\n\n			// create the empty channels\n			for (let i = 0; i < channels; i++) {\n				this.buffer[i] = new Float32Array(this.size);\n				this.writeHead[i] = 0;\n			}\n		}\n\n		/**\n		 * Push a value onto the end\n		 * @param channel number\n		 * @param value number\n		 */\n		push(channel, value) {\n			this.writeHead[channel] += 1;\n			if (this.writeHead[channel] > this.size) {\n				this.writeHead[channel] = 0;\n			}\n			this.buffer[channel][this.writeHead[channel]] = value;\n		}\n\n		/**\n		 * Get the recorded value of the channel given the delay\n		 * @param channel number\n		 * @param delay number delay samples\n		 */\n		get(channel, delay) {\n			let readHead = this.writeHead[channel] - Math.floor(delay);\n			if (readHead < 0) {\n				readHead += this.size;\n			}\n			return this.buffer[channel][readHead];\n		}\n	}\n"),rq("feedback-comb-filter",'\n	class FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n		constructor(options) {\n			super(options);\n			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n		}\n\n		static get parameterDescriptors() {\n			return [{\n				name: "delayTime",\n				defaultValue: 0.1,\n				minValue: 0,\n				maxValue: 1,\n				automationRate: "k-rate"\n			}, {\n				name: "feedback",\n				defaultValue: 0.5,\n				minValue: 0,\n				maxValue: 0.9999,\n				automationRate: "k-rate"\n			}];\n		}\n\n		generate(input, channel, parameters) {\n			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n			this.delayLine.push(channel, input + delayedSample * parameters.feedback);\n			return delayedSample;\n		}\n	}\n');class rL extends sm{static getDefaults(){return{baseUrl:"",onerror:sM,onload:sM,urls:{}}}has(i){return this._buffers.has(i.toString())}get(i){return se(this.has(i),"ToneAudioBuffers has no buffer named: ".concat(i)),this._buffers.get(i.toString())}_bufferLoaded(i){this._loadingCount--,0===this._loadingCount&&i&&i()}get loaded(){return Array.from(this._buffers).every(i=>{let[s,r]=i;return r.loaded})}add(i,s){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:sM,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:sM;return i9(s)?(this.baseUrl&&"data:audio/"===s.trim().substring(0,11).toLowerCase()&&(this.baseUrl=""),this._buffers.set(i.toString(),new sI(this.baseUrl+s,r,o))):this._buffers.set(i.toString(),new sI(s,r,o)),this}dispose(){return super.dispose(),this._buffers.forEach(i=>i.dispose()),this._buffers.clear(),this}constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;let i=sd(rL.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=i.baseUrl,Object.keys(i.urls).forEach(s=>{this._loadingCount++;let r=i.urls[s];this.add(s,r,this._bufferLoaded.bind(this,i.onload),i.onerror)})}}class rF extends rT{static getDefaults(){return Object.assign(rT.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:sM,onerror:sM,release:.1,urls:{}})}_findClosest(i){let s=0;for(;s<96;){if(this._buffers.has(i+s))return-s;if(this._buffers.has(i-s))return s;s++}throw Error("No available buffers for note: ".concat(i))}triggerAttack(i,s){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return this.log("triggerAttack",i,s,r),Array.isArray(i)||(i=[i]),i.forEach(i=>{let o=sB(new sG(this.context,i).toFrequency()),a=Math.round(o),l=o-a,u=this._findClosest(a),h=a-u,c=this._buffers.get(h),d=sq(u+l),p=new r_({url:c,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:d}).connect(this.output);p.start(s,0,c.duration/d,r),i7(this._activeSources.get(a))||this._activeSources.set(a,[]),this._activeSources.get(a).push(p),p.onended=()=>{if(this._activeSources&&this._activeSources.has(a)){let i=this._activeSources.get(a),s=i.indexOf(p);-1!==s&&i.splice(s,1)}}}),this}triggerRelease(i,s){return this.log("triggerRelease",i,s),Array.isArray(i)||(i=[i]),i.forEach(i=>{let r=new sG(this.context,i).toMidi();if(this._activeSources.has(r)&&this._activeSources.get(r).length){let i=this._activeSources.get(r);s=this.toSeconds(s),i.forEach(i=>{i.stop(s)}),this._activeSources.set(r,[])}}),this}releaseAll(i){let s=this.toSeconds(i);return this._activeSources.forEach(i=>{for(;i.length;)i.shift().stop(s)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(i,s,r){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=this.toSeconds(r);return this.triggerAttack(i,a,o),i7(s)?(se(i7(i),"notes must be an array when duration is array"),i.forEach((i,r)=>{let o=s[Math.min(r,s.length-1)];this.triggerRelease(i,a+this.toSeconds(o))})):this.triggerRelease(i,a+this.toSeconds(s)),this}add(i,s,r){if(se(st(i)||isFinite(i),"note must be a pitch or midi: ".concat(i)),st(i)){let o=new sG(this.context,i).toMidi();this._buffers.add(o,s,r)}else this._buffers.add(i,s,r);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(i=>{i.forEach(i=>i.dispose())}),this._activeSources.clear(),this}constructor(){super(sd(rF.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;let i=sd(rF.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),s={};Object.keys(i.urls).forEach(r=>{let o=parseInt(r,10);if(se(st(r)||i6(o)&&isFinite(o),"url key is neither a note or midi pitch: ".concat(r)),st(r)){let o=new sG(this.context,r).toMidi();s[o]=i.urls[r]}else i6(o)&&isFinite(o)&&(s[o]=i.urls[o])}),this._buffers=new rL({urls:s,onload:i.onload,baseUrl:i.baseUrl,onerror:i.onerror}),this.attack=i.attack,this.release=i.release,this.curve=i.curve,this._buffers.loaded&&Promise.resolve().then(i.onload)}}$([ry(0)],rF.prototype,"attack",void 0),$([ry(0)],rF.prototype,"release",void 0),rq("bit-crusher","\n	class BitCrusherWorklet extends SingleIOProcessor {\n\n		static get parameterDescriptors() {\n			return [{\n				name: \"bits\",\n				defaultValue: 12,\n				minValue: 1,\n				maxValue: 16,\n				automationRate: 'k-rate'\n			}];\n		}\n\n		generate(input, _channel, parameters) {\n			const step = Math.pow(0.5, parameters.bits - 1);\n			const val = step * Math.floor(input / step + 0.5);\n			return val;\n		}\n	}\n");class rB extends s${static getDefaults(){return Object.assign(s$.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(i){i?this._addSolo():this._removeSolo(),rB._allSolos.get(this.context).forEach(i=>i._updateSolo())}get muted(){return 0===this.input.gain.value}_addSolo(){rB._soloed.has(this.context)||rB._soloed.set(this.context,new Set),rB._soloed.get(this.context).add(this)}_removeSolo(){rB._soloed.has(this.context)&&rB._soloed.get(this.context).delete(this)}_isSoloed(){return rB._soloed.has(this.context)&&rB._soloed.get(this.context).has(this)}_noSolos(){return!rB._soloed.has(this.context)||rB._soloed.has(this.context)&&0===rB._soloed.get(this.context).size}_updateSolo(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),rB._allSolos.get(this.context).delete(this),this._removeSolo(),this}constructor(){super(sd(rB.getDefaults(),arguments,["solo"])),this.name="Solo";let i=sd(rB.getDefaults(),arguments,["solo"]);this.input=this.output=new s1({context:this.context}),rB._allSolos.has(this.context)||rB._allSolos.set(this.context,new Set),rB._allSolos.get(this.context).add(this),this.solo=i.solo}}rB._allSolos=new Map,rB._soloed=new Map;class rW extends s${static getDefaults(){return Object.assign(s$.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}constructor(){super(Object.assign(sd(rW.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;let i=sd(rW.getDefaults(),arguments,["pan"]);this.pan=new sQ({context:this.context,param:this._panner.pan,value:i.pan,minValue:-1,maxValue:1}),this._panner.channelCount=i.channelCount,this._panner.channelCountMode="explicit",sE(this,"pan")}}class rU extends s${static getDefaults(){return Object.assign(s$.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(i){this._volume.mute=i}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}constructor(){super(sd(rU.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";let i=sd(rU.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new rW({context:this.context,pan:i.pan,channelCount:i.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new re({context:this.context,volume:i.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=i.mute,sE(this,["pan","volume"])}}class rz extends s${static getDefaults(){return Object.assign(s$.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(i){this._solo.solo=i}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(i){this._panVol.mute=i}_getBus(i){return rz.buses.has(i)||rz.buses.set(i,new s1({context:this.context})),rz.buses.get(i)}send(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this._getBus(i),o=new s1({context:this.context,units:"decibels",gain:s});return this.connect(o),o.connect(r),o}receive(i){return this._getBus(i).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}constructor(){super(sd(rz.getDefaults(),arguments,["volume","pan"])),this.name="Channel";let i=sd(rz.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new rB({solo:i.solo,context:this.context}),this._panVol=this.output=new rU({context:this.context,pan:i.pan,volume:i.volume,mute:i.mute,channelCount:i.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),sE(this,["pan","volume"])}}rz.buses=new Map;class rG extends s${static getDefaults(){return Object.assign(s$.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}constructor(){super(...arguments),this.name="Listener",this.positionX=new sQ({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new sQ({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new sQ({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new sQ({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new sQ({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new sQ({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new sQ({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new sQ({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new sQ({context:this.context,param:this.context.rawContext.listener.upZ})}}function rX(){return sN().now()}function rZ(){return sN().transport}sw(i=>{i.listener=new rG({context:i})}),sC(i=>{i.listener.dispose()}),sN().transport,sN().destination,sN().destination,sN().listener,sN().draw,sN();class rH extends rp{static getDefaults(){return Object.assign(rp.getDefaults(),{onload:sM,onerror:sM,overlap:.1,grainSize:.2,playbackRate:1,detune:0,loop:!1,loopStart:0,loopEnd:0,reverse:!1})}_start(i,s,r){s=sp(s,0),s=this.toSeconds(s),i=this.toSeconds(i);let o=1/this._clock.frequency.getValueAtTime(i);this._clock.start(i,s/o),r&&this.stop(i+this.toSeconds(r))}restart(i,s,r){return super.restart(i,s,r),this}_restart(i,s,r){this._stop(i),this._start(i,s,r)}_stop(i){this._clock.stop(i)}_onstop(i){this._activeSources.forEach(s=>{s.fadeOut=0,s.stop(i)}),this.onstop(this)}_tick(i){let s=this._clock.getTicksAtTime(i),r=s*this._grainSize;if(this.log("offset",r),!this.loop&&r>this.buffer.duration)return void this.stop(i);let o=r<this._overlap?0:this._overlap,a=new r_({context:this.context,url:this.buffer,fadeIn:o,fadeOut:this._overlap,loop:this.loop,loopStart:this._loopStart,loopEnd:this._loopEnd,playbackRate:sq(this.detune/100)}).connect(this.output);a.start(i,this._grainSize*s),a.stop(i+this._grainSize/this.playbackRate),this._activeSources.push(a),a.onended=()=>{let i=this._activeSources.indexOf(a);-1!==i&&this._activeSources.splice(i,1)}}get playbackRate(){return this._playbackRate}set playbackRate(i){sn(i,.001),this._playbackRate=i,this.grainSize=this._grainSize}get loopStart(){return this._loopStart}set loopStart(i){this.buffer.loaded&&sn(this.toSeconds(i),0,this.buffer.duration),this._loopStart=this.toSeconds(i)}get loopEnd(){return this._loopEnd}set loopEnd(i){this.buffer.loaded&&sn(this.toSeconds(i),0,this.buffer.duration),this._loopEnd=this.toSeconds(i)}get reverse(){return this.buffer.reverse}set reverse(i){this.buffer.reverse=i}get grainSize(){return this._grainSize}set grainSize(i){this._grainSize=this.toSeconds(i),this._clock.frequency.setValueAtTime(this._playbackRate/this._grainSize,this.now())}get overlap(){return this._overlap}set overlap(i){let s=this.toSeconds(i);sn(s,0),this._overlap=s}get loaded(){return this.buffer.loaded}dispose(){return super.dispose(),this.buffer.dispose(),this._clock.dispose(),this._activeSources.forEach(i=>i.dispose()),this}constructor(){super(sd(rH.getDefaults(),arguments,["url","onload"])),this.name="GrainPlayer",this._loopStart=0,this._loopEnd=0,this._activeSources=[];let i=sd(rH.getDefaults(),arguments,["url","onload"]);this.buffer=new sI({onload:i.onload,onerror:i.onerror,reverse:i.reverse,url:i.url}),this._clock=new s9({context:this.context,callback:this._tick.bind(this),frequency:1/i.grainSize}),this._playbackRate=i.playbackRate,this._grainSize=i.grainSize,this._overlap=i.overlap,this.detune=i.detune,this.overlap=i.overlap,this.loop=i.loop,this.playbackRate=i.playbackRate,this.grainSize=i.grainSize,this.loopStart=i.loopStart,this.loopEnd=i.loopEnd,this.reverse=i.reverse,this._clock.on("stop",this._onstop.bind(this))}}class rY extends EventTarget{get trackList(){return this._tracksList}get trackVolumeControls(){return this._trackPlayers.reduce((i,s)=>(i[s.name]=s.volumeControl,i),{})}get trackVolumeOutput(){return this._trackPlayers.reduce((i,s)=>(i[s.name]=s.output,i),{})}get sections(){return this._sections}getSectionFromIndex(i){return tn(this._sections,i)}get current(){return this._current}get next(){return[this._next,this._increments]}get beginning(){return this._beginning}set state(i){this.dispatchEvent(new tm({now:i,prev:this._state})),this._state=i}get state(){return this._state}get timingInfo(){return Object.assign({},this._timingInfo)}_setMeterBeat(i){this._meterBeat=i,rZ().position}updateSectionLen(){this.current&&(this._sectionLen=(this.current.region[1]-this.current.region[0])*this._timingInfo.meter[0])}updateSectionBeat(i){this.current&&(this.updateSectionLen(),this._sectionBeat=Math.round(this._getSectionProgress(this.current,i)*this._sectionLen)%this._sectionLen)}getPosition(){return{section:[this._sectionBeat,this._sectionLen],countdown:this._pending.actionRemainingBeats,transport:{beat:this._meterBeat,transport:rZ().position.toString()},lastLaunchTime:this._sectionLastLaunchTime,contextTime:rX()}}getProgression(){var i,s;if(!this._current||!this._sections)return{};let r=ts(this._sections,this._current.index);return{name:this._current.name,index:this._current.index,next:(null===(i=this._pending.section)||void 0===i?void 0:i.index)||(null===(s=this._next)||void 0===s?void 0:s.index),increments:this._pending.increments||this._increments,repeatCount:r.loopCurrent,repeatLimit:r.loopLimit}}getSectionProgress(){return this._sectionBeat/this._sectionLen}_getSectionProgress(i,s){if(null===this._sectionLastLaunchTime||"playing"!==this._state&&"continue"!==this._state&&"transition"!==this._state&&"queue"!==this._state)return 0;let r=s-this._playerStartToneTime-sz(this._sectionLastLaunchTime).toSeconds(),o=sz(i.region[1]-i.region[0]+"m").toSeconds();return r%o/o}addEventListener(i,s,r){super.addEventListener(i,s,r)}removeEventListener(i,s,r){super.removeEventListener(i,s,r)}_dispatchParsePhase(i){this.dispatchEvent(new tg({now:i,prev:this._parsePhaseOld})),this._parsePhaseOld=i}audioStart(){let i=new rN;i.envelope.attack=0,i.envelope.release=.05,i.volume.value=-6,i.connect(this.output),this._metronome=i}get audioContext(){return sN().rawContext}parseManifest(i){return K(this,void 0,void 0,function*(){var s,r,o;if("applying"===this._state||"loading"===this._state)return;let[a,l,u]=yield function(i){return K(this,void 0,void 0,function*(){let s,r="",o="";if("string"!=typeof i)return ta(i)?[Object.assign({},i),to("").toString(),o]:Promise.reject("Invalid manifest");try{var a;let[l,u]=(a=i).endsWith(".jsong")||a.endsWith("json")?[to(a),"file"]:(a.endsWith("/")||(a+="/"),[to(a),"folder"]),h=l.href;if("folder"===u)try{let[i,s]=yield function(i){return K(this,void 0,void 0,function*(){let s=i.endsWith("/")?i:i+"/";for(let i of["manifest.jsong","manifest.json","audio.jsong","audio.json","song.jsong","song.json"]){let r=new URL(i,s);try{let s=yield fetch(r);return[i,(yield s.json())]}catch(i){}}throw Error("No URLs successfully fetched")})}(h);return r=h,o=i,ta(s)?[s,r,o]:Promise.reject("Invalid manifest")}catch(i){return Promise.reject("No match in folder")}else try{let i;[r,o]=(i=to(h),h.length?i.pathname.length<=1?[h,""]:[i.origin+i.pathname.substring(0,i.pathname.lastIndexOf("/"))+"/",i.pathname.substring(i.pathname.lastIndexOf("/")+1)]:["",""]);let a=yield fetch(r+o);return s=yield a.json(),ta(s)?[s,r,o]:Promise.reject("Invalid manifest")}catch(i){return Promise.reject("JSON parse error ".concat(r+o))}}catch(i){return Promise.reject("Parsing error")}})}(i);if(this._dispatchParsePhase("meta"),"jsong"!==(null==a?void 0:a.type))throw Error("[JSONg] Invalid manifest");if(!this.VERSION_SUPPORT.includes(null==a?void 0:a.version))throw Error("[JSONg] Unsupported parser version: ".concat(null==a?void 0:a.version));if(!(null===(s=null==a?void 0:a.playback)||void 0===s?void 0:s.bpm))throw Error("[JSONg] Missing bpm");if(!(null===(r=null==a?void 0:a.playback)||void 0===r?void 0:r.meter))throw Error("[JSONg] Missing meter");let h=a.meta?Object.assign({},a.meta):{title:"",author:"",version:"",createdUsing:"",created:0,modified:0,meta:""};this._dispatchParsePhase("done-meta"),this._dispatchParsePhase("timing");let c=Object.assign({},{db:-6,high:"G6",low:"G5",enabled:!1});if(a.playback.metronome&&"object"==typeof a.playback.metronome){let i=a.playback.metronome;i.db&&(c.db=i.db),i.high&&(c.high=i.high),i.low&&(c.low=i.low)}else"boolean"==typeof a.playback.metronome&&a.playback.metronome&&(c.db=-6);let d={bpm:a.playback.bpm,meter:a.playback.meter||[4,4],grain:(null===(o=a.playback)||void 0===o?void 0:o.grain)||a.playback.meter[0]/(a.playback.meter[1]/4)||1,beatDuration:function(i,s){let[r,o]=s;return 60/i*(4/o)}(a.playback.bpm,a.playback.meter),metronomeSchedule:null,metronome:c};this._dispatchParsePhase("done-timing"),this._dispatchParsePhase("sections");let p=function(i,s,r){var o;let a=s[null===(o=Object.keys(s))||void 0===o?void 0:o[0]];if(!Array.isArray(a))throw Error("[build] invalid map definition");let l=[0],u=[],h=function(i){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=1/0,c=[];i.forEach(i=>{"number"==typeof i?a=i:c.push(i)});let d=function(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;return{sectionCount:i,loopCurrent:0,loopLimit:s}}(c.length,a);for(let i=0;i<c.length;i++){let a=c[i];if(l[l.length-1]=i,Array.isArray(a))l.push(0),d[i]=h(a,o+1),l.pop();else if("number"!=typeof a){let o,h;let c=r.tracks.map(i=>({name:i,type:"sync",duration:0}));function p(){o.transition=o.transition.map(i=>Object.assign(Object.assign({},i),{type:"fade",duration:0}))}function f(i){o.transition=o.transition.map(s=>Object.assign(Object.assign({},s),{type:"fade",duration:i||r.fadeDuration}))}function m(i,s){return Object.assign(Object.assign({},i),{type:"fade",duration:s||r.fadeDuration})}if(o={name:"",region:[0,0],index:[],next:[],grain:r.grain,once:!1,transition:c,transitionSync:!1},"object"==typeof a){let i=tr(a.name);o.name=i.name,o.grain=void 0!==(null==a?void 0:a.grain)?a.grain:r.grain,o.once=(null==a?void 0:a.once)||i.once||!1,o.transitionSync=(null==a?void 0:a.sync)||i.sync||!1,0===o.grain&&(o.grain=s[o.name][1]-s[o.name][0],o.grain*=r.beatsInMeasure),(null==a?void 0:a.fade)||i.fade?i.fade||"boolean"==typeof a.fade&&!0===a.fade?f():"number"==typeof a.fade?f(a.fade):Array.isArray(a.fade)&&a.fade.forEach(i=>{"object"==typeof i?o.transition=o.transition.map(s=>s.name===i.name?m(s,i.duration):s):"string"==typeof i&&(o.transition=o.transition.map(s=>s.name===i?m(s):s))}):((null==a?void 0:a.legato)||i.legato)&&p()}else h=tr(a),o.name=h.name,(null==h?void 0:h.legato)?p():h.fade&&f(),h.once&&(o.once=!0),h.sync&&(o.transitionSync=!0);o.region=s[o.name],o.index=[...l],o.grain>(o.region[1]-o.region[0])*r.beatsInMeasure&&(o.grain=(o.region[1]-o.region[0])*r.beatsInMeasure),d[i]=o,u.push(o)}}return o?d:Object.assign({},d)},c=h(i,0);for(let i=0;i<u.length;i++){let s=(i+1)%u.length;u[i].next=u[s].index}return c.loopLimit=1/0,c}(a.playback.flow,a.playback.map,{grain:d.grain,fadeDuration:d.beatDuration*d.grain/2,tracks:a.tracks.map(i=>"object"==typeof i?i.name:i),beatsInMeasure:d.meter[0]}),f=[...function(i){let s=i,r=[-1];for(;s&&s[0];)s[0].hasOwnProperty("index")&&(r=s[0].index),s=s[0];return r}(p)],m=JSON.parse(JSON.stringify(a.playback.flow));this._dispatchParsePhase("done-sections"),this._dispatchParsePhase("tracks");let g=[...a.tracks],_="string"==typeof a.sources?a.sources:".mp3";_=_.startsWith(".")?_:"."+_;let v=g.reduce((i,s)=>{try{a.sources}catch(r){i[s]="./"+s+_}return i},{}),y=(a.sources,"object"==typeof a.sources?Object.assign({},a.sources):v);return this._dispatchParsePhase("done-tracks"),this.verbose&&console.log("[JSONg] end parsing manifest"),Promise.resolve({version:a.version,meta:h,timingInfo:d,sections:p,flow:m,beginning:f,tracksList:g,paths:y,origin:l,manifest:a})})}useManifest(i,s){return K(this,void 0,void 0,function*(){if(!this.VERSION_SUPPORT.includes(null==i?void 0:i.version))throw Error("[JSONg] Unsupported parser version: ".concat(null==i?void 0:i.version));this.audioStart(),this.state="applying",rZ().position="0:0:0",rZ().bpm.value=i.timingInfo.bpm,rZ().timeSignature=i.timingInfo.meter,this._setMeterBeat(-1),this._stop(rX());try{for(let i of this._trackPlayers)i.a.disconnect(),i.b.disconnect(),i.output.disconnect(),i.output.dispose(),i.a.dispose(),i.b.dispose()}catch(i){}this._metronome.volume.value=i.timingInfo.metronome.db||-6,this._timingInfo=i.timingInfo,this._sections=i.sections,this._beginning=i.beginning,this._tracksList=i.tracksList.map(i=>"object"==typeof i?{name:i.name,source:i.source||i.name,db:i.db||0,audioOffsetSeconds:i.audioOffsetSeconds||0}:{name:i,source:i,db:0,audioOffsetSeconds:0}),!0===(null==s?void 0:s.click)&&(this._timingInfo.metronome.enabled=!0);let r=(null==s?void 0:s.origin)?s.origin:i.origin;try{yield this.useAudio("object"==typeof(null==s?void 0:s.loadSound)?s.loadSound:i.paths,r),this.state="stopped",this.manifest=i,this.verbose&&console.log("[JSONg] loaded",i)}catch(i){throw this.state=null,i}})}useAudio(i){return K(this,arguments,void 0,function*(i){var s;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",o=arguments.length>2?arguments[2]:void 0;this._dispatchParsePhase("audio");let a=this._state;this.state="loading";let l=()=>{this._stop(rX());try{for(let i of this._trackPlayers)i.a.disconnect(),i.b.disconnect(),i.output.disconnect(),i.output.dispose(),i.a.dispose(),i.b.dispose()}catch(i){}let s=[];for(let i of this._tracksList){let r=new rH,a=new rH,l=new re,u=new re;r.overlap=0,a.overlap=0,r.volume.value=i.db,a.volume.value=i.db,r.connect(l),a.connect(l),l.connect(u),u.connect(this.output);let h=o||i.audioOffsetSeconds||0;s.push(Object.assign(Object.assign({},i),{volumeLimit:i.db,a:r,b:a,output:u,volumeControl:l,current:r,lastLoopPlayerStartTime:0,offset:h}))}this._trackPlayers=s,Object.keys(i).forEach(i=>{this._trackPlayers.forEach(s=>{s.name===i&&(s.a.buffer=this._sourceBuffers[i],s.b.buffer=s.a.buffer,this.verbose&&console.log("[JSONg] buffer loaded",i))})}),this._dispatchParsePhase("done-audio"),this.verbose&&console.log("[JSONg] end loading audio "),this._abort(),this._clear(),this._stop(rX())};if(!i||!Object.keys(i).length)return this.verbose&&console.log("[JSONg] end - no sources",i),void(this.state=a);let u=!1;Object.keys(i).forEach(s=>{i[s]instanceof sI&&(u=!0)});let h=!1;if(Object.keys(i).forEach(s=>{i[s]instanceof AudioBuffer&&(h=!0)}),u)return this._sourceBuffers=i,void l();if(h){let s={};return Object.keys(i).forEach(r=>{let o=new sI;o.set(i[r]),s[r]=o}),this._sourceBuffers=s,void l()}let c=yield function(i,s){return K(this,void 0,void 0,function*(){let r={},o=s.endsWith("/")?s:s+"/";if(!i)return null;let a=Object.keys(i);for(let s of a){let a;let l=i[s];a=l.startsWith("data:")?l:l.startsWith("./")?o+l.substring(2):to(l).toString(),r[s]=a}return r})}(i,r);if(!c)return this.verbose&&console.log("[JSONg] no sources listed in manifest",c),Promise.reject("no sources");if(null===(s=Object.keys(c))||void 0===s?void 0:s.length){this.state="loading";try{this._sourceBuffers=yield function(i){return K(this,void 0,void 0,function*(){return new Promise((s,r)=>K(this,void 0,void 0,function*(){let o=Object.keys(i);if(!o.length)return Error("nothing to load");sI.baseUrl="";let a=[];for(let s of o){let r=new sI;a.push(r.load(i[s]))}if(!a||!a.length)throw Error("no source buffers");try{let i=yield Promise.all(a),r={};i.forEach((i,s)=>{r[o[s]]=i}),s(r)}catch(i){r("buffer source load failure")}}))})}(c),l()}catch(i){throw this.state=null,console.error("[JSONg]",c),console.error(Error("[JSONg] error fetching data")),i}}})}play(i){return K(this,void 0,void 0,function*(){if(sj(),"stopped"!==this.state)return;let s=i||this._beginning,r=tn(this._sections,s);if(i&&void 0===r)throw Error("[JSONg] index error for specified start point: "+i);rZ().cancel(0),rZ().position="0:0:0",this._setMeterBeat(-1),this._metronomeSchedule&&rZ().clear(this._metronomeSchedule),this._metronomeSchedule=rZ().scheduleRepeat(i=>{this._setMeterBeat((this._meterBeat+1)%this._timingInfo.meter[0]),this.updateSectionBeat(i),this.dispatchEvent(new tl([this._meterBeat+1,this._timingInfo.meter[0]])),this.dispatchEvent(new tu([this._sectionBeat+1,this._sectionLen],this._meterBeat+1,this._pending.actionRemainingBeats>0?this._pending.actionRemainingBeats:void 0)),this._pending.actionRemainingBeats&&(this._pending.actionRemainingBeats-=1);let s=this._timingInfo.metronome[0===this._meterBeat?"high":"low"];if(this._timingInfo.metronome&&this._timingInfo.metronome.enabled)try{this._metronome.triggerAttackRelease(s,"64n",i)}catch(i){console.error(i)}},this._timingInfo.meter[1]+"n"),rZ().scheduleOnce(i=>{this._playerStartToneTime=i},"0:0:0"),rZ().start("+0.5"),this._clear(),this._current=r,yield this._schedule(r,"0:0:0"),this._sectionLastLaunchTime="0:0:0",this.dispatchEvent(new td(r,void 0,!1,!1)),this._current=r,this.state="playing",this._current=r,this.verbose&&console.log("[JSONg] started from index",s),r.once&&(this.verbose&&console.log("[JSONg] starting section once, continue"),this.state="continue",yield this._continue())})}continue(){return K(this,arguments,void 0,function*(){let i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];"playing"===this.state&&(yield this._continue(i))})}_continue(){return K(this,arguments,void 0,function*(){var i;let s=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this._current)throw Error("[JSONg] current section non-existent");let r=rZ().position.toString(),o=this._current,{next:a,increments:l}=ti(this._sections,this._current.index),u=(null==s?void 0:s.hasOwnProperty("region"))?s:tn(this._sections,Array.isArray(s)?s:s?this._current.next:a);if(!u)throw Error("[JSONg] no next section available");s?(this._pending.section=tn(this._sections,this._current.next),this._pending.increments=null):(this._pending.section=u,this._pending.increments=l);let h=tt(r,this._current.grain,null===(i=this._timingInfo)||void 0===i?void 0:i.meter,this._sectionLastLaunchTime);this.verbose&&console.log("[JSONg] advancing to next:",this._current.index,">",u.index),"playing"===this.state&&(this.state="queue");let c=te(rZ().position.toString(),h,this._timingInfo.meter);this.dispatchEvent(new th(u,o,!1!==s,this._pending.actionRemainingBeats,this.beatsCountToSeconds(c))),this.dispatchEvent(new tu([this._sectionBeat+1,this._sectionLen],this._meterBeat,this._pending.actionRemainingBeats>0?this._pending.actionRemainingBeats:void 0));try{yield this._schedule(u,h)}catch(i){throw this.dispatchEvent(new tc(u,o)),i}if(this.dispatchEvent(new td(u,o,!1!==s,u.once)),this._current=u,l.length&&!s&&l.forEach(i=>{var s,r;let o=0===i.length?this._sections:ts(this._sections,i);o.loopCurrent+=1,this.dispatchEvent(new tp([o.loopCurrent,o.loopLimit],o)),o.loopCurrent>=o.loopLimit&&(o.loopCurrent=0,this.dispatchEvent(new tf(o))),s=o.loopCurrent,function i(o,a,l){let u=r[a];l[a]=u,l+""==r+""?o[u]=s:i(o[u],a+1,l)}(this._sections,0,[...Array((r=[...i,"loopCurrent"]).length)]),this.verbose&&console.log("[JSONg] group repeat counter increment","".concat(o.loopCurrent,"/").concat(o.loopLimit),i)}),this._clear(),this._current.once)this.state="continue",yield this._continue();else{let{next:i,increments:s}=ti(this._sections,this._current.index),r=tn(this._sections,i);r&&(this._next=r,this._increments=s)}this.state="playing",this.verbose&&console.log("[JSONg] continue resolved")})}overrideCurrent(i){return K(this,arguments,void 0,function*(i){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if("playing"!==this.state)throw Error("state is not playing");let o=Array.isArray(i)?tn(this.sections,i):i;if(void 0===o)throw Error("invalid section index");let a=JSON.parse(JSON.stringify(this.current));a.transition=a.transition.map(i=>Object.assign(Object.assign({},i),{type:"fade",duration:s})),r&&r>0?(a.transitionSync=!0,a.grain=r):a.transitionSync=!1,this._current=a,console.log("override",i),yield this._continue(o)})}stop(){return K(this,arguments,void 0,function*(){let i=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(null!==this.state&&!("stopped"===this.state||i&&"stopping"===this.state))return new Promise((s,r)=>{var o;if(!this._current)return void r();this._clear(),this._abort();let{signal:a}=this._pending.scheduleAborter,l=()=>{r(),this.state="playing",this.verbose&&console.log("[JSONg] stop cancelled"),this._pending.actionRemainingBeats=0,this._pending.scheduledEvents.forEach(i=>{rZ().clear(i)}),this.dispatchEvent(new tc(this._current,void 0))},u=i=>{this.dispatchEvent(new td(this._current,void 0,!1,!1)),a.removeEventListener("abort",l),this._stop(i),s()};if(i){let i=tt(rZ().position.toString(),this._current.grain,null===(o=this._timingInfo)||void 0===o?void 0:o.meter,this._sectionLastLaunchTime);sz(i).toSeconds(),a.addEventListener("abort",l),this.verbose&&console.log("[JSONg] stopping at",i),this._pending.scheduledEvents.push(rZ().scheduleOnce(u,i)),this.state="stopping",this._pending.actionRemainingBeats=te(rZ().position.toString(),i,this._timingInfo.meter),this.dispatchEvent(new th(this._current,void 0,!1,this._pending.actionRemainingBeats,this.beatsCountToSeconds(this._pending.actionRemainingBeats))),this.dispatchEvent(new tu([this._sectionBeat+1,this._sectionLen],this._meterBeat,this._pending.actionRemainingBeats>0?this._pending.actionRemainingBeats:void 0))}else a.addEventListener("abort",l),u(rX()),s()})})}_stop(i){try{this._trackPlayers.forEach((s,r)=>{s.a.stop(i),s.b.stop(i),s.current=s.a})}catch(i){}rZ().stop(i),rZ().cancel(),this.state="stopped",this._sectionLastLaunchTime=null,this._sectionBeat=0,this._pending.actionRemainingBeats=0,this._pending.scheduledEvents=[];try{this.dispatchEvent(new tl([0,this._timingInfo.meter[0]])),this.dispatchEvent(new tu([0,this._sectionLen],0))}catch(i){}this.verbose&&console.log("[JSONg] stopped")}cancel(){this._abort(),this._clear(),this.state="playing"}_abort(){this._pending.actionRemainingBeats=0,this._pending.scheduleAborter&&this._pending.scheduleAborter.abort(),this._pending.scheduleAborter=new AbortController}_clear(){var i;(null===(i=this._pending)||void 0===i?void 0:i.transportSchedule)&&rZ().clear(this._pending.transportSchedule),this._pending.scheduledEvents.forEach(i=>{rZ().clear(i)}),this._pending.scheduledEvents=[],this._pending.transportSchedule=null,this._pending.increments=null,this._pending.section=null}_schedule(i,s){let r=sz("1m").toSeconds(),o=this.current.region[1]-this.current.region[0],a=i.region[1]-i.region[0];if(i.transition.find(i=>"sync"===i.type)&&!s)throw Error("Cannot use sync type transition and not specify forWhen");return new Promise((l,u)=>{let h=this._pending.scheduleAborter.signal,c="0:0:0",d=0;this.current.region[1],this.current.region[0],i.region[1],i.region[0],this.timingInfo.meter[0],Promise.all(this._trackPlayers.map(l=>new Promise((u,p)=>{let f=l.current===l.a?l.b:l.a;f.loopStart=sz(i.region[0]+"m").toSeconds()+l.offset,f.loopEnd=sz(i.region[1]+"m").toSeconds()+l.offset,f.loop=!0;let m=i=>{l.current.stop(i),l.current=f,this.verbose&&console.log("[schedule] resolved",l),u()},g=-1,_=-1,v=()=>{if(rZ().clear(g),rZ().clear(_),"transition"===this.state){let i=this._current.transition.find(i=>i.name===l.name),s=(null==i?void 0:i.duration)||1;f.stop(rX()+s),f.volume.cancelScheduledValues(rX()),l.current.volume.cancelScheduledValues(rX()),f.volume.linearRampToValueAtTime(-72,rX()+s),l.current.volume.linearRampToValueAtTime(l.volumeLimit,rX()+s)}p()},y=()=>{this._pending.actionRemainingBeats=te(rZ().position.toString(),s,this._timingInfo.meter),g=rZ().scheduleOnce(i=>{l.a.volume.setValueAtTime(l.volumeLimit,i),l.b.volume.setValueAtTime(l.volumeLimit,i);try{f.start(i,f.loopStart),l.lastLoopPlayerStartTime=i}catch(i){console.error(i)}c=s,d=0,m(i),h.removeEventListener("abort",v)},s),h.addEventListener("abort",v)};if(null===this._sectionLastLaunchTime)return void y();let b=this._current.transition.find(i=>i.name===l.name);if("fade"===b.type){let i=b.duration;this._pending.actionRemainingBeats=Math.floor(i/this._timingInfo.beatDuration);let u=this.current.transitionSync?sz(s).toSeconds():sz(rZ().position).toSeconds()+.1;g=rZ().scheduleOnce(s=>{let u=this._getSectionProgress(this.current,s);d=Math.floor(a*u)+(o*u-Math.floor(o*u));let p=d*r+f.loopStart;f.stop(s),f.start(s,p),f.volume.setValueAtTime(-72,s),f.volume.linearRampToValueAtTime(l.volumeLimit,s+i),l.current.volume.setValueAtTime(l.volumeLimit,s),l.current.volume.linearRampToValueAtTime(-72,s+i);let g=sz(s-this._playerStartToneTime).toSeconds()-d*r;c=sz(g).toBarsBeatsSixteenths().split(":")[0]+":0:0",i?this.state="transition":(m(s),h.removeEventListener("abort",v))},u),i&&(_=rZ().scheduleOnce(i=>{m(i),h.removeEventListener("abort",v)},u+i)),h.addEventListener("abort",v)}else y()}))).then(()=>{l(),this._sectionLastLaunchTime=c}).catch(()=>{u()})})}toggleMetronome(i){this._timingInfo.metronome.enabled=void 0!==i?i:!this._timingInfo.metronome.enabled}isMute(){return this.output.volume.value>=-200}mute(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5;this.output.volume.linearRampToValueAtTime(-120,"+"+i+"s")}unmute(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5;this.output.volume.linearRampToValueAtTime(0,"+"+i+"s")}audioSafeCallback(i){sN().draw.schedule(i,rX())}beatsCountToSeconds(i){return this.timingInfo.beatDuration*i}secondsToBeatCount(i){return i/this.timingInfo.beatDuration}afterBeats(i){let s=sz(rZ().position).toSeconds()+i*this.timingInfo.beatDuration;return new Promise(i=>{rZ().schedule(()=>this.audioSafeCallback(i),s)})}afterSectionPercentage(i){let s=i*(this.current.region[1]-this.current.region[0])*this.timingInfo.beatDuration*this.timingInfo.meter[0],r=sz(rZ().position).toSeconds()+s;return new Promise(i=>{rZ().schedule(()=>this.audioSafeCallback(i),r)})}constructor(i,s){super(),this.VERSION_SUPPORT=["J/1"],this.verbose=!1,this._state=null,this._meterBeat=0,this._sectionBeat=0,this._sectionLen=0,this._sectionLastLaunchTime=null,this._playerStartToneTime=0,this._parsePhaseOld=null,this._pending={scheduleAborter:new AbortController,transportSchedule:null,scheduledEvents:[],actionRemainingBeats:0,section:null,increments:null},this.state=null,this.verbose=!0===(null==s?void 0:s.verbose),(null==s?void 0:s.context)&&sV(null==s?void 0:s.context),this.output=new re,(null==s?void 0:s.disconnected)||this.output.toDestination();try{sj().then(()=>{this.audioStart(),i&&this.parseManifest(i).then(i=>{var r;if(!i)throw Error("[JSONg] Invalid manifest preload");this.useManifest(i),null===(r=null==s?void 0:s.onload)||void 0===r||r.call(s)}),this.verbose&&console.log("[JSONg] new jsong player created")})}catch(i){}}}var rJ=r(9332);let rQ=(0,Z.createContext)(null);function r$(i){let{Component:s,pageProps:r}=i,[o,a]=(0,Z.useState)(null),[l,u]=(0,Z.useState)(!1);(0,Z.useEffect)(()=>{if(o)return;let i=new rY;i.output.volume.value=-6,a(i);let s=()=>{u(!0)},r=()=>{u(!1)},l=()=>{u(!1)};return i.addEventListener("queue",s),i.addEventListener("change",r),i.addEventListener("cancel",l),i.addEventListener("state",i=>{console.info("[jsong-state]",i.stateOld,"->",i.stateNow)}),()=>{i.removeEventListener("queue",s),i.removeEventListener("change",r),i.removeEventListener("cancel",l),i.stop(!1),a(null)}},[]);let h=(0,rJ.usePathname)();return o&&(0,X.jsx)(X.Fragment,{children:(0,X.jsxs)(rQ.Provider,{value:o,children:[(0,X.jsx)(Q,{show:"/"!==h,pending:l}),(0,X.jsx)(s,{...r})]})})}},3483:function(){},2352:function(){},333:function(i){i.exports={nav:"nav_nav__BEpVH",full:"nav_full__dBZ_N",show:"nav_show__CP1Xw",progress:"nav_progress__AULy_",pending:"nav_pending__LOVvp",vol:"nav_vol__L6Aki"}},9332:function(i,s,r){i.exports=r(636)},512:function(i,s,r){"use strict";s.Z=function(){for(var i,s,r=0,o="",a=arguments.length;r<a;r++)(i=arguments[r])&&(s=function i(s){var r,o,a="";if("string"==typeof s||"number"==typeof s)a+=s;else if("object"==typeof s){if(Array.isArray(s)){var l=s.length;for(r=0;r<l;r++)s[r]&&(o=i(s[r]))&&(a&&(a+=" "),a+=o)}else for(o in s)s[o]&&(a&&(a+=" "),a+=o)}return a}(i))&&(o&&(o+=" "),o+=s);return o}}},function(i){var s=function(s){return i(i.s=s)};i.O(0,[774,179],function(){return s(6840),s(9974)}),_N_E=i.O()}]);